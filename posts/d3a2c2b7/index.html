<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="m0re"><meta name="copyright" content="m0re"><meta name="generator" content="Hexo 5.1.0"><meta name="theme" content="hexo-theme-yun"><title>PHP代码审计————弱类型 | m0re的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/m0re.ico"><link rel="mask-icon" href="/m0re.ico" color="#6200ee"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"m0re.top","root":"/","title":"人生路漫漫","version":"1.3.0","mode":"time","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta name="description" content="前言现在开始接触代码审计类型的题了，学长给我们讲过了bugku的一些题，然后我看了一些其他的社区的文章和博客，学习了简单的php代码审计，并在学习过后做几道相关的题来熟悉套路。 extract变量覆盖知识了解首先关于变量覆盖有这么一段简单代码可以说明（简单明了） &lt;?php $a&#x3D;&#39;lalala&#39;; $lalala&#x3D;&#39;xixixi&#39;; echo $$a; ?&gt; 输出结果是xixixi再看看一">
<meta property="og:type" content="article">
<meta property="og:title" content="PHP代码审计————弱类型">
<meta property="og:url" content="https://m0re.top/posts/d3a2c2b7/index.html">
<meta property="og:site_name" content="m0re的小站">
<meta property="og:description" content="前言现在开始接触代码审计类型的题了，学长给我们讲过了bugku的一些题，然后我看了一些其他的社区的文章和博客，学习了简单的php代码审计，并在学习过后做几道相关的题来熟悉套路。 extract变量覆盖知识了解首先关于变量覆盖有这么一段简单代码可以说明（简单明了） &lt;?php $a&#x3D;&#39;lalala&#39;; $lalala&#x3D;&#39;xixixi&#39;; echo $$a; ?&gt; 输出结果是xixixi再看看一">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2020042110023254.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421101503634.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2020042110193812.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421104922776.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421105047738.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421105610834.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421111427534.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421113859755.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421114336649.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421123558244.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421124401977.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421130953694.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421131309820.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421132115166.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421142732601.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2020042113335981.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421151507191.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421155133939.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421160437410.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421162350344.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200425222005483.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200425222239924.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200425223245324.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200425224347421.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70">
<meta property="article:published_time" content="2020-08-23T08:31:57.602Z">
<meta property="article:modified_time" content="2020-09-01T07:51:18.737Z">
<meta property="article:author" content="m0re">
<meta property="article:tag" content="PHP">
<meta property="article:tag" content="代码审计">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/2020042110023254.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="m0re"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="m0re"><span class="site-author-status" title="穷鬼啊啊啊啊">😭</span></a><div class="site-author-name"><a href="/about/">m0re</a></div><a class="site-name" href="/about/site.html">m0re的小站</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">90</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">8</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">37</span></a></div><a class="site-state-item hty-icon-button" href="/Tools/" title="Tools"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/zxcv0221" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="哔哩哔哩动画" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/ISm0r3" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:m0re.lxj@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#extract%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-number">2.</span> <span class="toc-text">extract变量覆盖</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E4%BA%86%E8%A7%A3"><span class="toc-number">2.1.</span> <span class="toc-text">知识了解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98%E5%AE%9E%E6%88%98"><span class="toc-number">2.2.</span> <span class="toc-text">例题实战</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#strcmp%E6%AF%94%E8%BE%83%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">3.</span> <span class="toc-text">strcmp比较字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E4%BA%86%E8%A7%A3-1"><span class="toc-number">3.1.</span> <span class="toc-text">知识了解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98%E5%AE%9E%E6%88%98-1"><span class="toc-number">3.2.</span> <span class="toc-text">例题实战</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#urldecode%E4%BA%8C%E6%AC%A1%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-number">4.</span> <span class="toc-text">urldecode二次编码绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E4%BA%86%E8%A7%A3-2"><span class="toc-number">4.1.</span> <span class="toc-text">知识了解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98%E5%AE%9E%E6%88%98-2"><span class="toc-number">4.2.</span> <span class="toc-text">例题实战</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#md5-%E5%87%BD%E6%95%B0"><span class="toc-number">5.</span> <span class="toc-text">md5()函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E4%BA%86%E8%A7%A3-3"><span class="toc-number">5.1.</span> <span class="toc-text">知识了解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98%E5%AE%9E%E6%88%98-3"><span class="toc-number">5.2.</span> <span class="toc-text">例题实战</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E8%BF%94%E5%9B%9ENULL%E7%BB%95%E8%BF%87"><span class="toc-number">6.</span> <span class="toc-text">数组返回NULL绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E4%BA%86%E8%A7%A3-4"><span class="toc-number">6.1.</span> <span class="toc-text">知识了解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98%E5%AE%9E%E6%88%98-4"><span class="toc-number">6.2.</span> <span class="toc-text">例题实战</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%95%B4%E6%95%B0%E5%A4%A7%E5%B0%8F%E6%AF%94%E8%BE%83%E7%BB%95%E8%BF%87"><span class="toc-number">7.</span> <span class="toc-text">弱类型整数大小比较绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E4%B8%AD%E4%BA%86%E8%A7%A3%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86"><span class="toc-number">7.1.</span> <span class="toc-text">题中了解相关知识</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%B7%E9%A2%98%EF%BC%88%E9%9A%8F%E4%BE%BF%E8%AE%B0%E4%B8%80%E4%B8%8B%EF%BC%89"><span class="toc-number">8.</span> <span class="toc-text">刷题（随便记一下）</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://m0re.top/posts/d3a2c2b7/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="m0re"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="m0re的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">PHP代码审计————弱类型</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <span class="post-meta-icon-text">发表于</span> <time title="创建时间：2020-08-23 16:31:57" itemprop="dateCreated datePublished" datetime="2020-08-23T16:31:57+08:00">2020-08-23</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <span class="post-meta-icon-text">更新于</span> <time title="修改时间：2020-09-01 15:51:18" itemprop="dateModified" datetime="2020-09-01T15:51:18+08:00">2020-09-01</time></div><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span id="busuanzi_value_page_pv"></span></span></span><span class="leancloud_visitors" id="/posts/d3a2c2b7/" data-flag-title="PHP代码审计————弱类型"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"><span class="post-tag"><a class="tag" href="/tags/PHP/" style="--text-color:#8892BF"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">PHP</span></a><a class="tag" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">代码审计</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#6200ee;"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>现在开始接触代码审计类型的题了，学长给我们讲过了bugku的一些题，然后我看了一些其他的社区的文章和博客，学习了简单的php代码审计，并在学习过后做几道相关的题来熟悉套路。</p>
<h1 id="extract变量覆盖"><a href="#extract变量覆盖" class="headerlink" title="extract变量覆盖"></a>extract变量覆盖</h1><h2 id="知识了解"><a href="#知识了解" class="headerlink" title="知识了解"></a>知识了解</h2><p>首先关于变量覆盖有这么一段简单代码可以说明（简单明了）</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token single-quoted-string string">'lalala'</span><span class="token punctuation">;</span>
<span class="token variable">$lalala</span><span class="token operator">=</span><span class="token single-quoted-string string">'xixixi'</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$$a</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span></code></pre>
<p>输出结果是<code>xixixi</code><br>再看看一个有漏洞的代码，</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//让浏览器能读懂</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token single-quoted-string string">'aa'</span><span class="token punctuation">;</span>
<span class="token variable">$aa</span><span class="token operator">=</span><span class="token single-quoted-string string">'123'</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token single-quoted-string string">'第一次变量aa的值是'</span><span class="token punctuation">.</span><span class="token variable">$aa</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'&lt;br>'</span><span class="token punctuation">;</span>
<span class="token variable">$$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token single-quoted-string string">'第二次变量aa的值是'</span><span class="token punctuation">.</span><span class="token variable">$aa</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'&lt;br>'</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span></code></pre>
<p>结果：<br><img src="https://img-blog.csdnimg.cn/2020042110023254.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="Augenstern" loading="lazy"><br><code>extract()</code>函数的作用：<br><img src="https://img-blog.csdnimg.cn/20200421101503634.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="来自w3school" loading="lazy"><br>至于extract()变量覆盖就是两者综合。</p>
<h2 id="例题实战"><a href="#例题实战" class="headerlink" title="例题实战"></a>例题实战</h2><p><img src="https://img-blog.csdnimg.cn/2020042110193812.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="来自bugku" loading="lazy"><br>php代码：</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$flag</span><span class="token operator">=</span><span class="token single-quoted-string string">'xxx'</span><span class="token punctuation">;</span>
<span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$shiyan</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token variable">$content</span><span class="token operator">=</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$shiyan</span><span class="token operator">==</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span><span class="token single-quoted-string string">'flag&#123;xxx&#125;'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span><span class="token single-quoted-string string">'Oh.no'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>
<p>学习过程中参考其他师傅的博客，然后发现有师傅尝试构造了<code>?shiyan=1&amp;flag=1</code>，看起来是没错，但是flag没有显示出来。原因是变量覆盖的定义弄混淆了，覆盖的话，会覆盖<strong>数组中的同名元素会覆盖</strong>，那flag里，不只有数字吧，所以这样构造不行，也不能构造字母，那样也显示不出来，所以直接构造空，不用管flag里面是什么类型。<br><img src="https://img-blog.csdnimg.cn/20200421104922776.png" alt="Augenstern" loading="lazy"><br>看出flag是有字母，有数字，还有杠。<br>还有一个大佬写的博客呢是这样的，先看题目代码。<br><img src="https://img-blog.csdnimg.cn/20200421105047738.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="Augenstern" loading="lazy"><br>这道题的话，那位师傅直接构造<code>?gift=a&amp;flag=a</code>可以直接显示出来，为什么呢，就是因为这道题的flag全是字母。<br>因为我不知道这道题，所以就拿那个师傅的图记录一下，下面有这个师傅的博客的链接。<br><img src="https://img-blog.csdnimg.cn/20200421105610834.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="Augenstern" loading="lazy"><br>因为flag里都是字母，所以可以那样构造。这里放上那个师傅的博客<a target="_blank" rel="noopener" href="https://blog.51cto.com/12332766/2120865">51cto师傅博客</a></p>
<h1 id="strcmp比较字符串"><a href="#strcmp比较字符串" class="headerlink" title="strcmp比较字符串"></a>strcmp比较字符串</h1><h2 id="知识了解-1"><a href="#知识了解-1" class="headerlink" title="知识了解"></a>知识了解</h2><p>strcmp(string $str1,string $str2);<br>如果str1&gt;str2返回&gt;0，如果str1&lt;str2,返回&lt;0，如果str1=str2，返回0。<br><img src="https://img-blog.csdnimg.cn/20200421111427534.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="来自w3school" loading="lazy"></p>
<h2 id="例题实战-1"><a href="#例题实战-1" class="headerlink" title="例题实战"></a>例题实战</h2><p><img src="https://img-blog.csdnimg.cn/20200421113859755.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="来自bugku" loading="lazy"><br>比较两个字符串大小，可以传入非字符串，直接传一个数组就行了。<br><code>strcmp()</code>漏洞理解：<br>strcmp()要求传入字符串，如果传入的不是字符串，那么函数就会报错，返回return 0；这里虽然报错了，但是却让其函数值相等了。让flag显示出来了。<br><img src="https://img-blog.csdnimg.cn/20200421114336649.png" alt="Augenstern" loading="lazy"></p>
<h1 id="urldecode二次编码绕过"><a href="#urldecode二次编码绕过" class="headerlink" title="urldecode二次编码绕过"></a>urldecode二次编码绕过</h1><h2 id="知识了解-2"><a href="#知识了解-2" class="headerlink" title="知识了解"></a>知识了解</h2><p><code>urldecode()</code>函数是对一个字符串(一般是URL字符串)进行解码。<br><img src="https://img-blog.csdnimg.cn/20200421123558244.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="Augenstern" loading="lazy"></p>
<h2 id="例题实战-2"><a href="#例题实战-2" class="headerlink" title="例题实战"></a>例题实战</h2><p><img src="https://img-blog.csdnimg.cn/20200421124401977.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="来自bugku" loading="lazy"><br>代码：</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">eregi</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"hackerDJ"</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"not allowed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token double-quoted-string string">"hackerDJ"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span> <span class="token double-quoted-string string">"Access granted!"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token double-quoted-string string">"flag"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>
<p>使用<code>$_GET</code>时，浏览器就已经把<code>hakerDJ</code>进行了一次解码了，然后又用了urldecode函数又再次进行了一次解码。<br>再看代码逻辑是如果id=hackerDJ会返回not allowed。但是，要想得到flag，还是要让id=hackerDJ。绕过要进行二次编码。<br>字符串中随便一个字母，我选的是第一个h<br>所以找到它的URL编码格式<br><img src="https://img-blog.csdnimg.cn/20200421130953694.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="Augenstern" loading="lazy"><br>然后再次对<code>%68</code>进行编码<br>是<code>%2568</code>，然后构造</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token operator">%</span><span class="token number">2568</span>ackerDJ</code></pre>
<p><img src="https://img-blog.csdnimg.cn/20200421131309820.png" alt="Augenstern" loading="lazy"></p>
<h1 id="md5-函数"><a href="#md5-函数" class="headerlink" title="md5()函数"></a>md5()函数</h1><h2 id="知识了解-3"><a href="#知识了解-3" class="headerlink" title="知识了解"></a>知识了解</h2><p><img src="https://img-blog.csdnimg.cn/20200421132115166.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="来自w3school" loading="lazy"><br>php中MD5函数漏洞：<br>第一种：数组绕过</p>
<blockquote>
<p>在PHP中，MD5是不能处理数组的，md5(数组)会返回null</p>
</blockquote>
<p>第二种：</p>
<blockquote>
<p>PHP在处理哈希字符串时，会利用”!=”或”==”来对哈希值进行比较，它把每一个以”0E”开头的哈希值都解释为0，所以如果两个不同的密码经过哈希以后，其哈希值都是以”0E”开头的，那么PHP将会认为他们相同，都是0。</p>
</blockquote>
<p>常见的被MD5认成是0的几个字符串<br>纯数字类</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token number">240610708</span> 0e462097431906509019562988736854
<span class="token number">314282422</span> 0e990995504821699494520356953734
<span class="token number">571579406</span> 0e972379832854295224118025748221
<span class="token number">903251147</span> 0e174510503823932942361353209384
<span class="token number">1110242161</span> 0e435874558488625891324861198103
<span class="token number">1320830526</span> 0e912095958985483346995414060832
<span class="token number">1586264293</span> 0e622743671155995737639662718498
<span class="token number">2302756269</span> 0e250566888497473798724426794462
<span class="token number">2427435592</span> 0e067696952328669732475498472343
<span class="token number">2653531602</span> 0e877487522341544758028810610885
<span class="token number">3293867441</span> 0e471001201303602543921144570260
<span class="token number">3295421201</span> 0e703870333002232681239618856220
<span class="token number">3465814713</span> 0e258631645650999664521705537122
<span class="token number">3524854780</span> 0e507419062489887827087815735195
<span class="token number">3908336290</span> 0e807624498959190415881248245271
<span class="token number">4011627063</span> 0e485805687034439905938362701775
<span class="token number">4775635065</span> 0e998212089946640967599450361168
<span class="token number">4790555361</span> 0e643442214660994430134492464512
<span class="token number">5432453531</span> 0e512318699085881630861890526097
<span class="token number">5579679820</span> 0e877622011730221803461740184915
<span class="token number">5585393579</span> 0e664357355382305805992765337023
<span class="token number">6376552501</span> 0e165886706997482187870215578015
<span class="token number">7124129977</span> 0e500007361044747804682122060876
<span class="token number">7197546197</span> 0e915188576072469101457315675502
<span class="token number">7656486157</span> 0e451569119711843337267091732412</code></pre>
<p>大写字母类：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">QLTHNDT 0e405967825401955372549139051580
QNKCDZO 0e830400451993494058024219903391
EEIZDOI 0e782601363539291779881938479162
TUFEPMC 0e839407194569345277863905212547
UTIPEZQ 0e382098788231234954670291303879
UYXFLOI 0e552539585246568817348686838809
IHKFRNS 0e256160682445802696926137988570
PJNPDWY 0e291529052894702774557631701704
ABJIHVY 0e755264355178451322893275696586
DQWRASX 0e742373665639232907775599582643
DYAXWCA 0e424759758842488633464374063001
GEGHBXL 0e248776895502908863709684713578
GGHMVOE 0e362766013028313274586933780773
GZECLQZ 0e537612333747236407713628225676
NWWKITQ 0e763082070976038347657360817689
NOOPCJF 0e818888003657176127862245791911
MAUXXQC 0e478478466848439040434801845361
MMHUWUV 0e701732711630150438129209816536</code></pre>
<p>第三种：“0E”绕过<br>一些哈希后0E开头的字符</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">s878926199a
0e545993274517709034328855841020
s155964671a
0e342768416822451524974117254469
s214587387a
0e848240448830537924465865611904
s214587387a
0e848240448830537924465865611904
s878926199a
0e545993274517709034328855841020
s1091221200a
0e940624217856561557816327384675
s1885207154a
0e509367213418206700842008763514
s1502113478a
0e861580163291561247404381396064
s1885207154a
0e509367213418206700842008763514
s1836677006a
0e481036490867661113260034900752
s155964671a
0e342768416822451524974117254469
s1184209335a
0e072485820392773389523109082030
s1665632922a
0e731198061491163073197128363787
s1502113478a
0e861580163291561247404381396064
s1836677006a
0e481036490867661113260034900752
s1091221200a
0e940624217856561557816327384675
s155964671a
0e342768416822451524974117254469
s1502113478a
0e861580163291561247404381396064
s155964671a
0e342768416822451524974117254469
s1665632922a
0e731198061491163073197128363787
s155964671a
0e342768416822451524974117254469
s1091221200a
0e940624217856561557816327384675
s1836677006a
0e481036490867661113260034900752
s1885207154a
0e509367213418206700842008763514
s532378020a
0e220463095855511507588041205815
s878926199a
0e545993274517709034328855841020
s1091221200a
0e940624217856561557816327384675
s214587387a
0e848240448830537924465865611904
s1502113478a
0e861580163291561247404381396064
s1091221200a
0e940624217856561557816327384675
s1665632922a
0e731198061491163073197128363787
s1885207154a
0e509367213418206700842008763514
s1836677006a
0e481036490867661113260034900752
s1665632922a
0e731198061491163073197128363787
s878926199a
0e545993274517709034328855841020
<span class="token number">240610708</span> 
0e462097431906509019562988736854
<span class="token number">314282422</span> 
0e990995504821699494520356953734
<span class="token number">571579406</span> 
0e972379832854295224118025748221
<span class="token number">903251147</span> 
0e174510503823932942361353209384
<span class="token number">1110242161</span> 
0e435874558488625891324861198103
<span class="token number">1320830526</span> 
0e912095958985483346995414060832
<span class="token number">1586264293</span> 
0e622743671155995737639662718498
<span class="token number">2302756269</span> 
0e250566888497473798724426794462
<span class="token number">2427435592</span> 
0e067696952328669732475498472343
<span class="token number">2653531602</span> 
0e877487522341544758028810610885
<span class="token number">3293867441</span> 
0e471001201303602543921144570260
<span class="token number">3295421201</span> 
0e703870333002232681239618856220
<span class="token number">3465814713</span> 
0e258631645650999664521705537122
<span class="token number">3524854780</span> 
0e507419062489887827087815735195
<span class="token number">3908336290</span> 
0e807624498959190415881248245271
<span class="token number">4011627063</span> 
0e485805687034439905938362701775
<span class="token number">4775635065</span> 
0e998212089946640967599450361168
<span class="token number">4790555361</span> 
0e643442214660994430134492464512
<span class="token number">5432453531</span> 
0e512318699085881630861890526097
<span class="token number">5579679820</span> 
0e877622011730221803461740184915
<span class="token number">5585393579</span> 
0e664357355382305805992765337023
<span class="token number">6376552501</span> 
0e165886706997482187870215578015
<span class="token number">7124129977</span> 
0e500007361044747804682122060876
<span class="token number">7197546197</span> 
0e915188576072469101457315675502
<span class="token number">7656486157</span> 
0e451569119711843337267091732412
QLTHNDT 
0e405967825401955372549139051580
QNKCDZO 
0e830400451993494058024219903391
EEIZDOI 
0e782601363539291779881938479162
TUFEPMC 
0e839407194569345277863905212547
UTIPEZQ 
0e382098788231234954670291303879
UYXFLOI 
0e552539585246568817348686838809
IHKFRNS 
0e256160682445802696926137988570
PJNPDWY 
0e291529052894702774557631701704
ABJIHVY 
0e755264355178451322893275696586
DQWRASX 
0e742373665639232907775599582643
DYAXWCA 
0e424759758842488633464374063001
GEGHBXL 
0e248776895502908863709684713578
GGHMVOE 
0e362766013028313274586933780773
GZECLQZ 
0e537612333747236407713628225676
NWWKITQ 
0e763082070976038347657360817689
NOOPCJF 
0e818888003657176127862245791911
MAUXXQC 
0e478478466848439040434801845361
MMHUWUV 
0e701732711630150438129209816536</code></pre>
<h2 id="例题实战-3"><a href="#例题实战-3" class="headerlink" title="例题实战"></a>例题实战</h2><p><img src="https://img-blog.csdnimg.cn/20200421142732601.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="来自bugku" loading="lazy"><br>代码：</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'flag&#123;test&#125;'</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'username'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token single-quoted-string string">'Your password can not be your username.'</span><span class="token punctuation">;</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Flag: '</span><span class="token punctuation">.</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">else</span>
<span class="token keyword">print</span> <span class="token single-quoted-string string">'Invalid password'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>
<p><code>==</code>等于，只需要等号两边的值是否相等。比如‘1’==1就成立，返回true。<br><code>===</code>全等，需要全等号两边的值和类型全都相等才成立。<br>这道题需要username和password全等但是username又不能等于password。比较矛盾，多看几遍理解还是比较容易理解的。<br>数组绕过：构造<code>?username[]=1&amp;password[]=2</code><br><img src="https://img-blog.csdnimg.cn/2020042113335981.png" alt="Augenstern" loading="lazy"></p>
<h1 id="数组返回NULL绕过"><a href="#数组返回NULL绕过" class="headerlink" title="数组返回NULL绕过"></a>数组返回NULL绕过</h1><h2 id="知识了解-4"><a href="#知识了解-4" class="headerlink" title="知识了解"></a>知识了解</h2><ul>
<li>ereg — 正则表达式匹配<br>ereg函数的漏洞：<br>①%00截断及遇到%00则默认为字符串的结束<br>②当传入的不是字符串而为一个数组时它的返回值不是FALSE，而是NULL</li>
<li>strpos的参数同样不能够是数组，所以返回的依旧是null，null不等于false也是正确。<h2 id="例题实战-4"><a href="#例题实战-4" class="headerlink" title="例题实战"></a>例题实战</h2><img src="https://img-blog.csdnimg.cn/20200421151507191.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="Augenstern" loading="lazy"><br>[a-zA-Z0-9]<br>方括号表示字符集，[A-Za-z0-9]匹配大小写字母和数字其中一个字符<br>其他的是正则表达式。<br>看代码：<br>这个password必须以数字或者字母开头<br>并且还要在password中检测到<code>--</code>的存在<br>第一种：<br>可以考虑<code>%00</code>截断<br>构造<code>?password=a%00--</code><br>得到flag<br>第二种：<br>考虑数组<br>构造<code>?password[]=--</code><br>得到flag<br>第三种：<br>这个得到flag有点不明白，同样是数组，但是构造<code>?password[]=1</code><br>同样得到flag。看了大佬的博客知道可以这样得到flag，但是具体原因，不晓得。<br>结果：<br><img src="https://img-blog.csdnimg.cn/20200421155133939.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="Augenstern" loading="lazy"><h1 id="弱类型整数大小比较绕过"><a href="#弱类型整数大小比较绕过" class="headerlink" title="弱类型整数大小比较绕过"></a>弱类型整数大小比较绕过</h1><h2 id="题中了解相关知识"><a href="#题中了解相关知识" class="headerlink" title="题中了解相关知识"></a>题中了解相关知识</h2><img src="https://img-blog.csdnimg.cn/20200421160437410.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="来自bugku" loading="lazy"><br>代码：<br>三元运算符判断传入的是不是一个数字，是返回no mumeric(不是数字)，否返回NULL。<br>再判断传入的是否大于1336.，大于就打印flag。<br>我想的是构造<code>?password=2587abc</code><br>这样它既不是一个数字又大于1336.应该是可以打印出flag的。<br>第二种，<br>代码本来自身矛盾，但是PHP数组有一个缺陷就是大多数的函数都没有办法去判断数组。可以通过数组绕过。<br>构造<code>?password[]=a</code>两种方法都可以得到flag<br><img src="https://img-blog.csdnimg.cn/20200421162350344.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="Augenstern" loading="lazy"><h1 id="刷题（随便记一下）"><a href="#刷题（随便记一下）" class="headerlink" title="刷题（随便记一下）"></a>刷题（随便记一下）</h1>一、十六进制与数字比较</li>
</ul>
<p>十六进制与数字比较，参考bugku的一道题，代码还是比较简单的，代码还是有矛盾，要想办法绕过，有一点记住就行了<strong>php在转码时会把16进制转化为十进制</strong>，所以在构造payload的时候将数字转换为十六进制的就行了。<br>这个还有就是可以数组绕过，直接构造数组就可以绕过。也没什么需要注意的。</p>
<p>二、数字验证正则绕过</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'flag&#123;test&#125;'</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token double-quoted-string string">"POST"</span> <span class="token operator">==</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REQUEST_METHOD'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">>=</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/^[[:graph:]]&#123;12,&#125;$/'</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//preg_match — 执行一个正则表达式匹配</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span> <span class="token single-quoted-string string">'flag'</span><span class="token punctuation">;</span>
<span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean constant">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token variable">$reg</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/'</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">6</span> <span class="token operator">></span> <span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token variable">$reg</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">,</span> <span class="token variable">$arr</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token variable">$c</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token variable">$ps</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'punct'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'digit'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'upper'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'lower'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[[:punct:]] 任何标点符号 [[:digit:]] 任何数字 [[:upper:]] 任何大写字母 [[:lower:]] 任何小写字母</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$ps</span> <span class="token keyword">as</span> <span class="token variable">$pt</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/[[:<span class="token interpolation"><span class="token variable">$pt</span></span>:]]+/"</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token variable">$c</span> <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$c</span> <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//>=3，必须包含四种类型三种与三种以上</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token double-quoted-string string">"42"</span> <span class="token operator">==</span> <span class="token variable">$password</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token keyword">else</span> <span class="token keyword">echo</span> <span class="token single-quoted-string string">'Wrong password'</span><span class="token punctuation">;</span>
<span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>
<p>源码给出，一点一点看，先看打印flag的地方，<br><img src="https://img-blog.csdnimg.cn/20200425222005483.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="Augenstern" loading="lazy"><br><code>[:graph:]</code>是代表printable and visible的字符,是除空格符(空格键与[TAB]键)之外的所有按键,<br>控制字符不算[:graph:]<br>然后这个意思是匹配的password的长度要大于12，这里我用<code>lalalalalalala</code>，<br>然后继续看<br><img src="https://img-blog.csdnimg.cn/20200425222239924.png" alt="Augenstern" loading="lazy"><br><code>[:punct:]</code>是匹配这些特殊字符</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span><span class="token operator">!</span>"#$%<span class="token operator">&amp;</span>'<span class="token punctuation">(</span><span class="token punctuation">)</span>*+, <span class="token punctuation">\</span>-./:<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">></span>?@ <span class="token punctuation">[</span><span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token punctuation">]</span>^_`<span class="token punctuation">&#123;</span><span class="token operator">|</span><span class="token punctuation">&#125;</span>~<span class="token punctuation">]</span></code></pre>
<p><code>[:digit:]</code>是匹配<code>0-9</code>的数字<br><code>[:upper:]</code>是匹配大写字母<code>A-Z</code><br><code>[:lower:]</code>是匹配小写字母<code>a-z</code><br>关于正则匹配的一些知识参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Jordandan/p/11211729.html">大佬博客</a></p>
<p>所以这一句的意思是password里还要匹配到数字、字符、大写和小写字母。<br>我这里将上面的payload改一下<code>lalaLal4_ala</code><br>继续<br><img src="https://img-blog.csdnimg.cn/20200425223245324.png" alt="Augenstern" loading="lazy"><br>这里提示已经有了 ，必须包含四种类型三种与三种以上<br>上面的payload已经符合要求。<br><code>&quot;42&quot;==$password</code>这个是个弱类型比较数字大小，只要前两位是数字，后面的字母在进行比较时会被强行转换成数字来比较，这里相等，所以我再把payload改一下，<code>42laLal4_ala</code>就可以绕过了吧，试一下。<br>还有一点就是，题目上的请求方式是post方式，所以这里抓一下包进行修改<br><img src="https://img-blog.csdnimg.cn/20200425224347421.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM2NDc0,size_16,color_FFFFFF,t_70" alt="Augenstern" loading="lazy"><br>得到flag<br>最后这两题原本也是要详细的写一下知识了解的，后来想想还是不写了，过于啰嗦了。 继续学习加油。</p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me a candy.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://gitee.com/m0re/picture/raw/master/img/wechatpay.jpg"><img loading="lazy" src="https://gitee.com/m0re/picture/raw/master/img/wechatpay.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>m0re</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://m0re.top/posts/d3a2c2b7/" title="PHP代码审计————弱类型">https://m0re.top/posts/d3a2c2b7/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/posts/1c4a3d56/" rel="prev" title="PHP序列化与反序列化、PHP伪协议"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">PHP序列化与反序列化、PHP伪协议</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/993a14cd/" rel="next" title="PHP从零开始——学习笔记(1)"><span class="post-nav-text">PHP从零开始——学习笔记(1)</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>尝试使用 utterances （基于 GitHub Issues）评论系统。</span><br><span>您可以点击下方按钮切换对应评论系统，</span><br><span><script>function showUtterances(){ document.querySelector(".utterances").style.display='block'; document.querySelector('#valine-container').style.display='none'; }function showValine(){ document.querySelector('#valine-container').style.display='block'; document.querySelector(".utterances").style.display='none'; }</script></span><br><span><a class="hty-button hty-button--raised" onclick="showValine()">Valine</a><a class="hty-button hty-button--raised" onclick="showUtterances()">utterances</a></span><br><span><style>.utterances{display:none;}</style></span><br></div><div id="valine-container"></div><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>function initValine() {
  const valineConfig = {"enable":true,"appId":"gUEA9zKLhCnMFxQI5kI20WiD-gzGzoHsz","appKey":"GQKAp04LNloy3MrDMv86MI3i","placeholder":"评论一下~&nbsp_(:з」∠)_ （填写邮箱可以收到回复通知～）","avatar":null,"pageSize":10,"visitor":true,"highlight":true,"recordIP":true,"enableQQ":true,"requiredFields":["nick","mail"],"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = window.location.pathname
  new Valine(valineConfig)
}
setTimeout(initValine, 800)</script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">豫ICP备2020025591号-1</a></div><div class="copyright"><span>&copy; 2020 – 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> m0re</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.1.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.3.0</span></div><div class="live_time"><span>本博客已苟延残喘了</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  window.setTimeout(blog_live_time, 1000);
  const start = new Date('2020-02-21T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div><div id="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv" title="总访客量"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-user-line"></use></svg></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="总访问量"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg></span><span id="busuanzi_value_site_pv"></span></span></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div id="local-search-result"></div></div></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"https://cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>